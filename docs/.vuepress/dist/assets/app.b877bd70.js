const Hi={},Zo="modulepreload",$i={},qo="/",lr=function(t,a){return!a||a.length===0?t():Promise.all(a.map(x=>{if(x=`${qo}${x}`,x in $i)return;$i[x]=!0;const M=x.endsWith(".css"),K=M?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${K}`))return;const N=document.createElement("link");if(N.rel=M?"stylesheet":Zo,M||(N.as="script",N.crossOrigin=""),N.href=x,document.head.appendChild(N),M)return new Promise((O,v)=>{N.addEventListener("load",O),N.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${x}`)))})})).then(()=>t())},el={"v-8daa1a0e":()=>lr(()=>import("./index.html.b2e41e25.js"),[]).then(({data:e})=>e),"v-3706649a":()=>lr(()=>import("./404.html.7d858b3d.js"),[]).then(({data:e})=>e)};function vi(e,t){const a=Object.create(null),x=e.split(",");for(let M=0;M<x.length;M++)a[x[M]]=!0;return t?M=>!!a[M.toLowerCase()]:M=>!!a[M]}function En(e){if(ce(e)){const t={};for(let a=0;a<e.length;a++){const x=e[a],M=Te(x)?il(x):En(x);if(M)for(const K in M)t[K]=M[K]}return t}else{if(Te(e))return e;if(xe(e))return e}}const tl=/;(?![^(]*\))/g,rl=/:([^]+)/,nl=/\/\*.*?\*\//gs;function il(e){const t={};return e.replace(nl,"").split(tl).forEach(a=>{if(a){const x=a.split(rl);x.length>1&&(t[x[0].trim()]=x[1].trim())}}),t}function gr(e){let t="";if(Te(e))t=e;else if(ce(e))for(let a=0;a<e.length;a++){const x=gr(e[a]);x&&(t+=x+" ")}else if(xe(e))for(const a in e)e[a]&&(t+=a+" ");return t.trim()}const sl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",al=vi(sl);function ia(e){return!!e||e===""}const sa=e=>Te(e)?e:e==null?"":ce(e)||xe(e)&&(e.toString===ua||!he(e.toString))?JSON.stringify(e,aa,2):String(e),aa=(e,t)=>t&&t.__v_isRef?aa(e,t.value):ir(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((a,[x,M])=>(a[`${x} =>`]=M,a),{})}:oa(t)?{[`Set(${t.size})`]:[...t.values()]}:xe(t)&&!ce(t)&&!fa(t)?String(t):t,_e={},nr=[],lt=()=>{},ol=()=>!1,ll=/^on[^a-z]/,Br=e=>ll.test(e),gi=e=>e.startsWith("onUpdate:"),Be=Object.assign,mi=(e,t)=>{const a=e.indexOf(t);a>-1&&e.splice(a,1)},ul=Object.prototype.hasOwnProperty,me=(e,t)=>ul.call(e,t),ce=Array.isArray,ir=e=>yn(e)==="[object Map]",oa=e=>yn(e)==="[object Set]",he=e=>typeof e=="function",Te=e=>typeof e=="string",pi=e=>typeof e=="symbol",xe=e=>e!==null&&typeof e=="object",la=e=>xe(e)&&he(e.then)&&he(e.catch),ua=Object.prototype.toString,yn=e=>ua.call(e),fl=e=>yn(e).slice(8,-1),fa=e=>yn(e)==="[object Object]",Ei=e=>Te(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dr=vi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Tn=e=>{const t=Object.create(null);return a=>t[a]||(t[a]=e(a))},cl=/-(\w)/g,gt=Tn(e=>e.replace(cl,(t,a)=>a?a.toUpperCase():"")),dl=/\B([A-Z])/g,Jt=Tn(e=>e.replace(dl,"-$1").toLowerCase()),_n=Tn(e=>e.charAt(0).toUpperCase()+e.slice(1)),wn=Tn(e=>e?`on${_n(e)}`:""),Or=(e,t)=>!Object.is(e,t),rn=(e,t)=>{for(let a=0;a<e.length;a++)e[a](t)},an=(e,t,a)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:a})},Jn=e=>{const t=parseFloat(e);return isNaN(t)?e:t},hl=e=>{const t=Te(e)?Number(e):NaN;return isNaN(t)?e:t};let Xi;const vl=()=>Xi||(Xi=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let ze;class gl{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ze,!t&&ze&&(this.index=(ze.scopes||(ze.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const a=ze;try{return ze=this,t()}finally{ze=a}}}on(){ze=this}off(){ze=this.parent}stop(t){if(this._active){let a,x;for(a=0,x=this.effects.length;a<x;a++)this.effects[a].stop();for(a=0,x=this.cleanups.length;a<x;a++)this.cleanups[a]();if(this.scopes)for(a=0,x=this.scopes.length;a<x;a++)this.scopes[a].stop(!0);if(!this.detached&&this.parent&&!t){const M=this.parent.scopes.pop();M&&M!==this&&(this.parent.scopes[this.index]=M,M.index=this.index)}this.parent=void 0,this._active=!1}}}function ml(e,t=ze){t&&t.active&&t.effects.push(e)}function ca(){return ze}function pl(e){ze&&ze.cleanups.push(e)}const yi=e=>{const t=new Set(e);return t.w=0,t.n=0,t},da=e=>(e.w&Mt)>0,ha=e=>(e.n&Mt)>0,El=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Mt},yl=e=>{const{deps:t}=e;if(t.length){let a=0;for(let x=0;x<t.length;x++){const M=t[x];da(M)&&!ha(M)?M.delete(e):t[a++]=M,M.w&=~Mt,M.n&=~Mt}t.length=a}},on=new WeakMap;let Ar=0,Mt=1;const Zn=30;let at;const $t=Symbol(""),qn=Symbol("");class Ti{constructor(t,a=null,x){this.fn=t,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,ml(this,x)}run(){if(!this.active)return this.fn();let t=at,a=bt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=at,at=this,bt=!0,Mt=1<<++Ar,Ar<=Zn?El(this):Qi(this),this.fn()}finally{Ar<=Zn&&yl(this),Mt=1<<--Ar,at=this.parent,bt=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){at===this?this.deferStop=!0:this.active&&(Qi(this),this.onStop&&this.onStop(),this.active=!1)}}function Qi(e){const{deps:t}=e;if(t.length){for(let a=0;a<t.length;a++)t[a].delete(e);t.length=0}}let bt=!0;const va=[];function mr(){va.push(bt),bt=!1}function pr(){const e=va.pop();bt=e===void 0?!0:e}function Ve(e,t,a){if(bt&&at){let x=on.get(e);x||on.set(e,x=new Map);let M=x.get(a);M||x.set(a,M=yi()),ga(M)}}function ga(e,t){let a=!1;Ar<=Zn?ha(e)||(e.n|=Mt,a=!da(e)):a=!e.has(at),a&&(e.add(at),at.deps.push(e))}function _t(e,t,a,x,M,K){const N=on.get(e);if(!N)return;let O=[];if(t==="clear")O=[...N.values()];else if(a==="length"&&ce(e)){const v=Number(x);N.forEach((w,S)=>{(S==="length"||S>=v)&&O.push(w)})}else switch(a!==void 0&&O.push(N.get(a)),t){case"add":ce(e)?Ei(a)&&O.push(N.get("length")):(O.push(N.get($t)),ir(e)&&O.push(N.get(qn)));break;case"delete":ce(e)||(O.push(N.get($t)),ir(e)&&O.push(N.get(qn)));break;case"set":ir(e)&&O.push(N.get($t));break}if(O.length===1)O[0]&&ei(O[0]);else{const v=[];for(const w of O)w&&v.push(...w);ei(yi(v))}}function ei(e,t){const a=ce(e)?e:[...e];for(const x of a)x.computed&&Ji(x);for(const x of a)x.computed||Ji(x)}function Ji(e,t){(e!==at||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function Tl(e,t){var a;return(a=on.get(e))===null||a===void 0?void 0:a.get(t)}const _l=vi("__proto__,__v_isRef,__isVue"),ma=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(pi)),Sl=_i(),xl=_i(!1,!0),Ll=_i(!0),Zi=Al();function Al(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...a){const x=pe(this);for(let K=0,N=this.length;K<N;K++)Ve(x,"get",K+"");const M=x[t](...a);return M===-1||M===!1?x[t](...a.map(pe)):M}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...a){mr();const x=pe(this)[t].apply(this,a);return pr(),x}}),e}function Dl(e){const t=pe(this);return Ve(t,"has",e),t.hasOwnProperty(e)}function _i(e=!1,t=!1){return function(x,M,K){if(M==="__v_isReactive")return!e;if(M==="__v_isReadonly")return e;if(M==="__v_isShallow")return t;if(M==="__v_raw"&&K===(e?t?Hl:_a:t?Ta:ya).get(x))return x;const N=ce(x);if(!e){if(N&&me(Zi,M))return Reflect.get(Zi,M,K);if(M==="hasOwnProperty")return Dl}const O=Reflect.get(x,M,K);return(pi(M)?ma.has(M):_l(M))||(e||Ve(x,"get",M),t)?O:Me(O)?N&&Ei(M)?O:O.value:xe(O)?e?Li(O):Er(O):O}}const Pl=pa(),Rl=pa(!0);function pa(e=!1){return function(a,x,M,K){let N=a[x];if(ur(N)&&Me(N)&&!Me(M))return!1;if(!e&&(!ln(M)&&!ur(M)&&(N=pe(N),M=pe(M)),!ce(a)&&Me(N)&&!Me(M)))return N.value=M,!0;const O=ce(a)&&Ei(x)?Number(x)<a.length:me(a,x),v=Reflect.set(a,x,M,K);return a===pe(K)&&(O?Or(M,N)&&_t(a,"set",x,M):_t(a,"add",x,M)),v}}function Il(e,t){const a=me(e,t);e[t];const x=Reflect.deleteProperty(e,t);return x&&a&&_t(e,"delete",t,void 0),x}function bl(e,t){const a=Reflect.has(e,t);return(!pi(t)||!ma.has(t))&&Ve(e,"has",t),a}function Cl(e){return Ve(e,"iterate",ce(e)?"length":$t),Reflect.ownKeys(e)}const Ea={get:Sl,set:Pl,deleteProperty:Il,has:bl,ownKeys:Cl},Ol={get:Ll,set(e,t){return!0},deleteProperty(e,t){return!0}},Ml=Be({},Ea,{get:xl,set:Rl}),Si=e=>e,Sn=e=>Reflect.getPrototypeOf(e);function Vr(e,t,a=!1,x=!1){e=e.__v_raw;const M=pe(e),K=pe(t);a||(t!==K&&Ve(M,"get",t),Ve(M,"get",K));const{has:N}=Sn(M),O=x?Si:a?Di:Mr;if(N.call(M,t))return O(e.get(t));if(N.call(M,K))return O(e.get(K));e!==M&&e.get(t)}function Yr(e,t=!1){const a=this.__v_raw,x=pe(a),M=pe(e);return t||(e!==M&&Ve(x,"has",e),Ve(x,"has",M)),e===M?a.has(e):a.has(e)||a.has(M)}function zr(e,t=!1){return e=e.__v_raw,!t&&Ve(pe(e),"iterate",$t),Reflect.get(e,"size",e)}function qi(e){e=pe(e);const t=pe(this);return Sn(t).has.call(t,e)||(t.add(e),_t(t,"add",e,e)),this}function es(e,t){t=pe(t);const a=pe(this),{has:x,get:M}=Sn(a);let K=x.call(a,e);K||(e=pe(e),K=x.call(a,e));const N=M.call(a,e);return a.set(e,t),K?Or(t,N)&&_t(a,"set",e,t):_t(a,"add",e,t),this}function ts(e){const t=pe(this),{has:a,get:x}=Sn(t);let M=a.call(t,e);M||(e=pe(e),M=a.call(t,e)),x&&x.call(t,e);const K=t.delete(e);return M&&_t(t,"delete",e,void 0),K}function rs(){const e=pe(this),t=e.size!==0,a=e.clear();return t&&_t(e,"clear",void 0,void 0),a}function $r(e,t){return function(x,M){const K=this,N=K.__v_raw,O=pe(N),v=t?Si:e?Di:Mr;return!e&&Ve(O,"iterate",$t),N.forEach((w,S)=>x.call(M,v(w),v(S),K))}}function Xr(e,t,a){return function(...x){const M=this.__v_raw,K=pe(M),N=ir(K),O=e==="entries"||e===Symbol.iterator&&N,v=e==="keys"&&N,w=M[e](...x),S=a?Si:t?Di:Mr;return!t&&Ve(K,"iterate",v?qn:$t),{next(){const{value:k,done:R}=w.next();return R?{value:k,done:R}:{value:O?[S(k[0]),S(k[1])]:S(k),done:R}},[Symbol.iterator](){return this}}}}function xt(e){return function(...t){return e==="delete"?!1:this}}function wl(){const e={get(K){return Vr(this,K)},get size(){return zr(this)},has:Yr,add:qi,set:es,delete:ts,clear:rs,forEach:$r(!1,!1)},t={get(K){return Vr(this,K,!1,!0)},get size(){return zr(this)},has:Yr,add:qi,set:es,delete:ts,clear:rs,forEach:$r(!1,!0)},a={get(K){return Vr(this,K,!0)},get size(){return zr(this,!0)},has(K){return Yr.call(this,K,!0)},add:xt("add"),set:xt("set"),delete:xt("delete"),clear:xt("clear"),forEach:$r(!0,!1)},x={get(K){return Vr(this,K,!0,!0)},get size(){return zr(this,!0)},has(K){return Yr.call(this,K,!0)},add:xt("add"),set:xt("set"),delete:xt("delete"),clear:xt("clear"),forEach:$r(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(K=>{e[K]=Xr(K,!1,!1),a[K]=Xr(K,!0,!1),t[K]=Xr(K,!1,!0),x[K]=Xr(K,!0,!0)}),[e,a,t,x]}const[Fl,kl,Ul,Bl]=wl();function xi(e,t){const a=t?e?Bl:Ul:e?kl:Fl;return(x,M,K)=>M==="__v_isReactive"?!e:M==="__v_isReadonly"?e:M==="__v_raw"?x:Reflect.get(me(a,M)&&M in x?a:x,M,K)}const Nl={get:xi(!1,!1)},Kl={get:xi(!1,!0)},Wl={get:xi(!0,!1)},ya=new WeakMap,Ta=new WeakMap,_a=new WeakMap,Hl=new WeakMap;function Gl(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jl(e){return e.__v_skip||!Object.isExtensible(e)?0:Gl(fl(e))}function Er(e){return ur(e)?e:Ai(e,!1,Ea,Nl,ya)}function Vl(e){return Ai(e,!1,Ml,Kl,Ta)}function Li(e){return Ai(e,!0,Ol,Wl,_a)}function Ai(e,t,a,x,M){if(!xe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const K=M.get(e);if(K)return K;const N=jl(e);if(N===0)return e;const O=new Proxy(e,N===2?x:a);return M.set(e,O),O}function sr(e){return ur(e)?sr(e.__v_raw):!!(e&&e.__v_isReactive)}function ur(e){return!!(e&&e.__v_isReadonly)}function ln(e){return!!(e&&e.__v_isShallow)}function Sa(e){return sr(e)||ur(e)}function pe(e){const t=e&&e.__v_raw;return t?pe(t):e}function xa(e){return an(e,"__v_skip",!0),e}const Mr=e=>xe(e)?Er(e):e,Di=e=>xe(e)?Li(e):e;function La(e){bt&&at&&(e=pe(e),ga(e.dep||(e.dep=yi())))}function Aa(e,t){e=pe(e);const a=e.dep;a&&ei(a)}function Me(e){return!!(e&&e.__v_isRef===!0)}function Ue(e){return Pa(e,!1)}function Da(e){return Pa(e,!0)}function Pa(e,t){return Me(e)?e:new Yl(e,t)}class Yl{constructor(t,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?t:pe(t),this._value=a?t:Mr(t)}get value(){return La(this),this._value}set value(t){const a=this.__v_isShallow||ln(t)||ur(t);t=a?t:pe(t),Or(t,this._rawValue)&&(this._rawValue=t,this._value=a?t:Mr(t),Aa(this))}}function ut(e){return Me(e)?e.value:e}const zl={get:(e,t,a)=>ut(Reflect.get(e,t,a)),set:(e,t,a,x)=>{const M=e[t];return Me(M)&&!Me(a)?(M.value=a,!0):Reflect.set(e,t,a,x)}};function Ra(e){return sr(e)?e:new Proxy(e,zl)}function mv(e){const t=ce(e)?new Array(e.length):{};for(const a in e)t[a]=Xl(e,a);return t}class $l{constructor(t,a,x){this._object=t,this._key=a,this._defaultValue=x,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Tl(pe(this._object),this._key)}}function Xl(e,t,a){const x=e[t];return Me(x)?x:new $l(e,t,a)}var Ia;class Ql{constructor(t,a,x,M){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this[Ia]=!1,this._dirty=!0,this.effect=new Ti(t,()=>{this._dirty||(this._dirty=!0,Aa(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!M,this.__v_isReadonly=x}get value(){const t=pe(this);return La(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Ia="__v_isReadonly";function Jl(e,t,a=!1){let x,M;const K=he(e);return K?(x=e,M=lt):(x=e.get,M=e.set),new Ql(x,M,K||!M,a)}function Ct(e,t,a,x){let M;try{M=x?e(...x):e()}catch(K){Nr(K,t,a)}return M}function et(e,t,a,x){if(he(e)){const K=Ct(e,t,a,x);return K&&la(K)&&K.catch(N=>{Nr(N,t,a)}),K}const M=[];for(let K=0;K<e.length;K++)M.push(et(e[K],t,a,x));return M}function Nr(e,t,a,x=!0){const M=t?t.vnode:null;if(t){let K=t.parent;const N=t.proxy,O=a;for(;K;){const w=K.ec;if(w){for(let S=0;S<w.length;S++)if(w[S](e,N,O)===!1)return}K=K.parent}const v=t.appContext.config.errorHandler;if(v){Ct(v,null,10,[e,N,O]);return}}Zl(e,a,M,x)}function Zl(e,t,a,x=!0){console.error(e)}let wr=!1,ti=!1;const Ke=[];let ht=0;const ar=[];let Et=null,jt=0;const ba=Promise.resolve();let Pi=null;function Ri(e){const t=Pi||ba;return e?t.then(this?e.bind(this):e):t}function ql(e){let t=ht+1,a=Ke.length;for(;t<a;){const x=t+a>>>1;Fr(Ke[x])<e?t=x+1:a=x}return t}function xn(e){(!Ke.length||!Ke.includes(e,wr&&e.allowRecurse?ht+1:ht))&&(e.id==null?Ke.push(e):Ke.splice(ql(e.id),0,e),Ca())}function Ca(){!wr&&!ti&&(ti=!0,Pi=ba.then(Oa))}function eu(e){const t=Ke.indexOf(e);t>ht&&Ke.splice(t,1)}function tu(e){ce(e)?ar.push(...e):(!Et||!Et.includes(e,e.allowRecurse?jt+1:jt))&&ar.push(e),Ca()}function ns(e,t=wr?ht+1:0){for(;t<Ke.length;t++){const a=Ke[t];a&&a.pre&&(Ke.splice(t,1),t--,a())}}function un(e){if(ar.length){const t=[...new Set(ar)];if(ar.length=0,Et){Et.push(...t);return}for(Et=t,Et.sort((a,x)=>Fr(a)-Fr(x)),jt=0;jt<Et.length;jt++)Et[jt]();Et=null,jt=0}}const Fr=e=>e.id==null?1/0:e.id,ru=(e,t)=>{const a=Fr(e)-Fr(t);if(a===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return a};function Oa(e){ti=!1,wr=!0,Ke.sort(ru);const t=lt;try{for(ht=0;ht<Ke.length;ht++){const a=Ke[ht];a&&a.active!==!1&&Ct(a,null,14)}}finally{ht=0,Ke.length=0,un(),wr=!1,Pi=null,(Ke.length||ar.length)&&Oa()}}function nu(e,t,...a){if(e.isUnmounted)return;const x=e.vnode.props||_e;let M=a;const K=t.startsWith("update:"),N=K&&t.slice(7);if(N&&N in x){const S=`${N==="modelValue"?"model":N}Modifiers`,{number:k,trim:R}=x[S]||_e;R&&(M=a.map(W=>Te(W)?W.trim():W)),k&&(M=a.map(Jn))}let O,v=x[O=wn(t)]||x[O=wn(gt(t))];!v&&K&&(v=x[O=wn(Jt(t))]),v&&et(v,e,6,M);const w=x[O+"Once"];if(w){if(!e.emitted)e.emitted={};else if(e.emitted[O])return;e.emitted[O]=!0,et(w,e,6,M)}}function Ma(e,t,a=!1){const x=t.emitsCache,M=x.get(e);if(M!==void 0)return M;const K=e.emits;let N={},O=!1;if(!he(e)){const v=w=>{const S=Ma(w,t,!0);S&&(O=!0,Be(N,S))};!a&&t.mixins.length&&t.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}return!K&&!O?(xe(e)&&x.set(e,null),null):(ce(K)?K.forEach(v=>N[v]=null):Be(N,K),xe(e)&&x.set(e,N),N)}function Ln(e,t){return!e||!Br(t)?!1:(t=t.slice(2).replace(/Once$/,""),me(e,t[0].toLowerCase()+t.slice(1))||me(e,Jt(t))||me(e,t))}let ke=null,wa=null;function fn(e){const t=ke;return ke=e,wa=e&&e.type.__scopeId||null,t}function iu(e,t=ke,a){if(!t||e._n)return e;const x=(...M)=>{x._d&&hs(-1);const K=fn(t);let N;try{N=e(...M)}finally{fn(K),x._d&&hs(1)}return N};return x._n=!0,x._c=!0,x._d=!0,x}function Fn(e){const{type:t,vnode:a,proxy:x,withProxy:M,props:K,propsOptions:[N],slots:O,attrs:v,emit:w,render:S,renderCache:k,data:R,setupState:W,ctx:C,inheritAttrs:I}=e;let b,L;const A=fn(e);try{if(a.shapeFlag&4){const D=M||x;b=st(S.call(D,D,k,K,W,R,C)),L=v}else{const D=t;b=st(D.length>1?D(K,{attrs:v,slots:O,emit:w}):D(K,null)),L=t.props?v:su(v)}}catch(D){Ir.length=0,Nr(D,e,1),b=Ie($e)}let h=b;if(L&&I!==!1){const D=Object.keys(L),{shapeFlag:T}=h;D.length&&T&7&&(N&&D.some(gi)&&(L=au(L,N)),h=wt(h,L))}return a.dirs&&(h=wt(h),h.dirs=h.dirs?h.dirs.concat(a.dirs):a.dirs),a.transition&&(h.transition=a.transition),b=h,fn(A),b}const su=e=>{let t;for(const a in e)(a==="class"||a==="style"||Br(a))&&((t||(t={}))[a]=e[a]);return t},au=(e,t)=>{const a={};for(const x in e)(!gi(x)||!(x.slice(9)in t))&&(a[x]=e[x]);return a};function ou(e,t,a){const{props:x,children:M,component:K}=e,{props:N,children:O,patchFlag:v}=t,w=K.emitsOptions;if(t.dirs||t.transition)return!0;if(a&&v>=0){if(v&1024)return!0;if(v&16)return x?is(x,N,w):!!N;if(v&8){const S=t.dynamicProps;for(let k=0;k<S.length;k++){const R=S[k];if(N[R]!==x[R]&&!Ln(w,R))return!0}}}else return(M||O)&&(!O||!O.$stable)?!0:x===N?!1:x?N?is(x,N,w):!0:!!N;return!1}function is(e,t,a){const x=Object.keys(t);if(x.length!==Object.keys(e).length)return!0;for(let M=0;M<x.length;M++){const K=x[M];if(t[K]!==e[K]&&!Ln(a,K))return!0}return!1}function lu({vnode:e,parent:t},a){for(;t&&t.subTree===e;)(e=t.vnode).el=a,t=t.parent}const uu=e=>e.__isSuspense;function Fa(e,t){t&&t.pendingBranch?ce(e)?t.effects.push(...e):t.effects.push(e):tu(e)}function Xt(e,t){if(Re){let a=Re.provides;const x=Re.parent&&Re.parent.provides;x===a&&(a=Re.provides=Object.create(x)),a[e]=t}}function Oe(e,t,a=!1){const x=Re||ke;if(x){const M=x.parent==null?x.vnode.appContext&&x.vnode.appContext.provides:x.parent.provides;if(M&&e in M)return M[e];if(arguments.length>1)return a&&he(t)?t.call(x.proxy):t}}const Qr={};function Tt(e,t,a){return ka(e,t,a)}function ka(e,t,{immediate:a,deep:x,flush:M,onTrack:K,onTrigger:N}=_e){const O=ca()===(Re==null?void 0:Re.scope)?Re:null;let v,w=!1,S=!1;if(Me(e)?(v=()=>e.value,w=ln(e)):sr(e)?(v=()=>e,x=!0):ce(e)?(S=!0,w=e.some(h=>sr(h)||ln(h)),v=()=>e.map(h=>{if(Me(h))return h.value;if(sr(h))return zt(h);if(he(h))return Ct(h,O,2)})):he(e)?t?v=()=>Ct(e,O,2):v=()=>{if(!(O&&O.isUnmounted))return k&&k(),et(e,O,3,[R])}:v=lt,t&&x){const h=v;v=()=>zt(h())}let k,R=h=>{k=L.onStop=()=>{Ct(h,O,4)}},W;if(dr)if(R=lt,t?a&&et(t,O,3,[v(),S?[]:void 0,R]):v(),M==="sync"){const h=sf();W=h.__watcherHandles||(h.__watcherHandles=[])}else return lt;let C=S?new Array(e.length).fill(Qr):Qr;const I=()=>{if(!!L.active)if(t){const h=L.run();(x||w||(S?h.some((D,T)=>Or(D,C[T])):Or(h,C)))&&(k&&k(),et(t,O,3,[h,C===Qr?void 0:S&&C[0]===Qr?[]:C,R]),C=h)}else L.run()};I.allowRecurse=!!t;let b;M==="sync"?b=I:M==="post"?b=()=>Ge(I,O&&O.suspense):(I.pre=!0,O&&(I.id=O.uid),b=()=>xn(I));const L=new Ti(v,b);t?a?I():C=L.run():M==="post"?Ge(L.run.bind(L),O&&O.suspense):L.run();const A=()=>{L.stop(),O&&O.scope&&mi(O.scope.effects,L)};return W&&W.push(A),A}function fu(e,t,a){const x=this.proxy,M=Te(e)?e.includes(".")?Ua(x,e):()=>x[e]:e.bind(x,x);let K;he(t)?K=t:(K=t.handler,a=t);const N=Re;cr(this);const O=ka(M,K.bind(x),a);return N?cr(N):Qt(),O}function Ua(e,t){const a=t.split(".");return()=>{let x=e;for(let M=0;M<a.length&&x;M++)x=x[a[M]];return x}}function zt(e,t){if(!xe(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Me(e))zt(e.value,t);else if(ce(e))for(let a=0;a<e.length;a++)zt(e[a],t);else if(oa(e)||ir(e))e.forEach(a=>{zt(a,t)});else if(fa(e))for(const a in e)zt(e[a],t);return e}function cu(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ft(()=>{e.isMounted=!0}),Ii(()=>{e.isUnmounting=!0}),e}const Ze=[Function,Array],du={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ze,onEnter:Ze,onAfterEnter:Ze,onEnterCancelled:Ze,onBeforeLeave:Ze,onLeave:Ze,onAfterLeave:Ze,onLeaveCancelled:Ze,onBeforeAppear:Ze,onAppear:Ze,onAfterAppear:Ze,onAppearCancelled:Ze},setup(e,{slots:t}){const a=no(),x=cu();let M;return()=>{const K=t.default&&Ka(t.default(),!0);if(!K||!K.length)return;let N=K[0];if(K.length>1){for(const I of K)if(I.type!==$e){N=I;break}}const O=pe(e),{mode:v}=O;if(x.isLeaving)return kn(N);const w=ss(N);if(!w)return kn(N);const S=ri(w,O,x,a);ni(w,S);const k=a.subTree,R=k&&ss(k);let W=!1;const{getTransitionKey:C}=w.type;if(C){const I=C();M===void 0?M=I:I!==M&&(M=I,W=!0)}if(R&&R.type!==$e&&(!Vt(w,R)||W)){const I=ri(R,O,x,a);if(ni(R,I),v==="out-in")return x.isLeaving=!0,I.afterLeave=()=>{x.isLeaving=!1,a.update.active!==!1&&a.update()},kn(N);v==="in-out"&&w.type!==$e&&(I.delayLeave=(b,L,A)=>{const h=Na(x,R);h[String(R.key)]=R,b._leaveCb=()=>{L(),b._leaveCb=void 0,delete S.delayedLeave},S.delayedLeave=A})}return N}}},Ba=du;function Na(e,t){const{leavingVNodes:a}=e;let x=a.get(t.type);return x||(x=Object.create(null),a.set(t.type,x)),x}function ri(e,t,a,x){const{appear:M,mode:K,persisted:N=!1,onBeforeEnter:O,onEnter:v,onAfterEnter:w,onEnterCancelled:S,onBeforeLeave:k,onLeave:R,onAfterLeave:W,onLeaveCancelled:C,onBeforeAppear:I,onAppear:b,onAfterAppear:L,onAppearCancelled:A}=t,h=String(e.key),D=Na(a,e),T=(i,l)=>{i&&et(i,x,9,l)},d=(i,l)=>{const p=l[1];T(i,l),ce(i)?i.every(m=>m.length<=1)&&p():i.length<=1&&p()},f={mode:K,persisted:N,beforeEnter(i){let l=O;if(!a.isMounted)if(M)l=I||O;else return;i._leaveCb&&i._leaveCb(!0);const p=D[h];p&&Vt(e,p)&&p.el._leaveCb&&p.el._leaveCb(),T(l,[i])},enter(i){let l=v,p=w,m=S;if(!a.isMounted)if(M)l=b||v,p=L||w,m=A||S;else return;let s=!1;const c=i._enterCb=_=>{s||(s=!0,_?T(m,[i]):T(p,[i]),f.delayedLeave&&f.delayedLeave(),i._enterCb=void 0)};l?d(l,[i,c]):c()},leave(i,l){const p=String(e.key);if(i._enterCb&&i._enterCb(!0),a.isUnmounting)return l();T(k,[i]);let m=!1;const s=i._leaveCb=c=>{m||(m=!0,l(),c?T(C,[i]):T(W,[i]),i._leaveCb=void 0,D[p]===e&&delete D[p])};D[p]=e,R?d(R,[i,s]):s()},clone(i){return ri(i,t,a,x)}};return f}function kn(e){if(Kr(e))return e=wt(e),e.children=null,e}function ss(e){return Kr(e)?e.children?e.children[0]:void 0:e}function ni(e,t){e.shapeFlag&6&&e.component?ni(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ka(e,t=!1,a){let x=[],M=0;for(let K=0;K<e.length;K++){let N=e[K];const O=a==null?N.key:String(a)+String(N.key!=null?N.key:K);N.type===je?(N.patchFlag&128&&M++,x=x.concat(Ka(N.children,t,O))):(t||N.type!==$e)&&x.push(O!=null?wt(N,{key:O}):N)}if(M>1)for(let K=0;K<x.length;K++)x[K].patchFlag=-2;return x}function tt(e){return he(e)?{setup:e,name:e.name}:e}const or=e=>!!e.type.__asyncLoader;function cn(e){he(e)&&(e={loader:e});const{loader:t,loadingComponent:a,errorComponent:x,delay:M=200,timeout:K,suspensible:N=!0,onError:O}=e;let v=null,w,S=0;const k=()=>(S++,v=null,R()),R=()=>{let W;return v||(W=v=t().catch(C=>{if(C=C instanceof Error?C:new Error(String(C)),O)return new Promise((I,b)=>{O(C,()=>I(k()),()=>b(C),S+1)});throw C}).then(C=>W!==v&&v?v:(C&&(C.__esModule||C[Symbol.toStringTag]==="Module")&&(C=C.default),w=C,C)))};return tt({name:"AsyncComponentWrapper",__asyncLoader:R,get __asyncResolved(){return w},setup(){const W=Re;if(w)return()=>Un(w,W);const C=A=>{v=null,Nr(A,W,13,!x)};if(N&&W.suspense||dr)return R().then(A=>()=>Un(A,W)).catch(A=>(C(A),()=>x?Ie(x,{error:A}):null));const I=Ue(!1),b=Ue(),L=Ue(!!M);return M&&setTimeout(()=>{L.value=!1},M),K!=null&&setTimeout(()=>{if(!I.value&&!b.value){const A=new Error(`Async component timed out after ${K}ms.`);C(A),b.value=A}},K),R().then(()=>{I.value=!0,W.parent&&Kr(W.parent.vnode)&&xn(W.parent.update)}).catch(A=>{C(A),b.value=A}),()=>{if(I.value&&w)return Un(w,W);if(b.value&&x)return Ie(x,{error:b.value});if(a&&!L.value)return Ie(a)}}})}function Un(e,t){const{ref:a,props:x,children:M,ce:K}=t.vnode,N=Ie(e,x,M);return N.ref=a,N.ce=K,delete t.vnode.ce,N}const Kr=e=>e.type.__isKeepAlive;function hu(e,t){Wa(e,"a",t)}function vu(e,t){Wa(e,"da",t)}function Wa(e,t,a=Re){const x=e.__wdc||(e.__wdc=()=>{let M=a;for(;M;){if(M.isDeactivated)return;M=M.parent}return e()});if(An(t,x,a),a){let M=a.parent;for(;M&&M.parent;)Kr(M.parent.vnode)&&gu(x,t,a,M),M=M.parent}}function gu(e,t,a,x){const M=An(t,e,x,!0);bi(()=>{mi(x[t],M)},a)}function An(e,t,a=Re,x=!1){if(a){const M=a[e]||(a[e]=[]),K=t.__weh||(t.__weh=(...N)=>{if(a.isUnmounted)return;mr(),cr(a);const O=et(t,a,e,N);return Qt(),pr(),O});return x?M.unshift(K):M.push(K),K}}const St=e=>(t,a=Re)=>(!dr||e==="sp")&&An(e,(...x)=>t(...x),a),Ha=St("bm"),Ft=St("m"),mu=St("bu"),pu=St("u"),Ii=St("bum"),bi=St("um"),Eu=St("sp"),yu=St("rtg"),Tu=St("rtc");function _u(e,t=Re){An("ec",e,t)}function Tr(e,t){const a=ke;if(a===null)return e;const x=Rn(a)||a.proxy,M=e.dirs||(e.dirs=[]);for(let K=0;K<t.length;K++){let[N,O,v,w=_e]=t[K];N&&(he(N)&&(N={mounted:N,updated:N}),N.deep&&zt(O),M.push({dir:N,instance:x,value:O,oldValue:void 0,arg:v,modifiers:w}))}return e}function dt(e,t,a,x){const M=e.dirs,K=t&&t.dirs;for(let N=0;N<M.length;N++){const O=M[N];K&&(O.oldValue=K[N].value);let v=O.dir[x];v&&(mr(),et(v,a,8,[e.el,O,e,t]),pr())}}const Ga="components";function Su(e,t){return Lu(Ga,e,!0,t)||e}const xu=Symbol();function Lu(e,t,a=!0,x=!1){const M=ke||Re;if(M){const K=M.type;if(e===Ga){const O=tf(K,!1);if(O&&(O===t||O===gt(t)||O===_n(gt(t))))return K}const N=as(M[e]||K[e],t)||as(M.appContext[e],t);return!N&&x?K:N}}function as(e,t){return e&&(e[t]||e[gt(t)]||e[_n(gt(t))])}function pv(e,t,a,x){let M;const K=a&&a[x];if(ce(e)||Te(e)){M=new Array(e.length);for(let N=0,O=e.length;N<O;N++)M[N]=t(e[N],N,void 0,K&&K[N])}else if(typeof e=="number"){M=new Array(e);for(let N=0;N<e;N++)M[N]=t(N+1,N,void 0,K&&K[N])}else if(xe(e))if(e[Symbol.iterator])M=Array.from(e,(N,O)=>t(N,O,void 0,K&&K[O]));else{const N=Object.keys(e);M=new Array(N.length);for(let O=0,v=N.length;O<v;O++){const w=N[O];M[O]=t(e[w],w,O,K&&K[O])}}else M=[];return a&&(a[x]=M),M}function ja(e,t,a={},x,M){if(ke.isCE||ke.parent&&or(ke.parent)&&ke.parent.isCE)return t!=="default"&&(a.name=t),Ie("slot",a,x&&x());let K=e[t];K&&K._c&&(K._d=!1),vt();const N=K&&Va(K(a)),O=to(je,{key:a.key||N&&N.key||`_${t}`},N||(x?x():[]),N&&e._===1?64:-2);return!M&&O.scopeId&&(O.slotScopeIds=[O.scopeId+"-s"]),K&&K._c&&(K._d=!0),O}function Va(e){return e.some(t=>vn(t)?!(t.type===$e||t.type===je&&!Va(t.children)):!0)?e:null}const ii=e=>e?io(e)?Rn(e)||e.proxy:ii(e.parent):null,Pr=Be(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ii(e.parent),$root:e=>ii(e.root),$emit:e=>e.emit,$options:e=>Ci(e),$forceUpdate:e=>e.f||(e.f=()=>xn(e.update)),$nextTick:e=>e.n||(e.n=Ri.bind(e.proxy)),$watch:e=>fu.bind(e)}),Bn=(e,t)=>e!==_e&&!e.__isScriptSetup&&me(e,t),Au={get({_:e},t){const{ctx:a,setupState:x,data:M,props:K,accessCache:N,type:O,appContext:v}=e;let w;if(t[0]!=="$"){const W=N[t];if(W!==void 0)switch(W){case 1:return x[t];case 2:return M[t];case 4:return a[t];case 3:return K[t]}else{if(Bn(x,t))return N[t]=1,x[t];if(M!==_e&&me(M,t))return N[t]=2,M[t];if((w=e.propsOptions[0])&&me(w,t))return N[t]=3,K[t];if(a!==_e&&me(a,t))return N[t]=4,a[t];si&&(N[t]=0)}}const S=Pr[t];let k,R;if(S)return t==="$attrs"&&Ve(e,"get",t),S(e);if((k=O.__cssModules)&&(k=k[t]))return k;if(a!==_e&&me(a,t))return N[t]=4,a[t];if(R=v.config.globalProperties,me(R,t))return R[t]},set({_:e},t,a){const{data:x,setupState:M,ctx:K}=e;return Bn(M,t)?(M[t]=a,!0):x!==_e&&me(x,t)?(x[t]=a,!0):me(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(K[t]=a,!0)},has({_:{data:e,setupState:t,accessCache:a,ctx:x,appContext:M,propsOptions:K}},N){let O;return!!a[N]||e!==_e&&me(e,N)||Bn(t,N)||(O=K[0])&&me(O,N)||me(x,N)||me(Pr,N)||me(M.config.globalProperties,N)},defineProperty(e,t,a){return a.get!=null?e._.accessCache[t]=0:me(a,"value")&&this.set(e,t,a.value,null),Reflect.defineProperty(e,t,a)}};let si=!0;function Du(e){const t=Ci(e),a=e.proxy,x=e.ctx;si=!1,t.beforeCreate&&os(t.beforeCreate,e,"bc");const{data:M,computed:K,methods:N,watch:O,provide:v,inject:w,created:S,beforeMount:k,mounted:R,beforeUpdate:W,updated:C,activated:I,deactivated:b,beforeDestroy:L,beforeUnmount:A,destroyed:h,unmounted:D,render:T,renderTracked:d,renderTriggered:f,errorCaptured:i,serverPrefetch:l,expose:p,inheritAttrs:m,components:s,directives:c,filters:_}=t;if(w&&Pu(w,x,null,e.appContext.config.unwrapInjectedRef),N)for(const n in N){const g=N[n];he(g)&&(x[n]=g.bind(a))}if(M){const n=M.call(a,a);xe(n)&&(e.data=Er(n))}if(si=!0,K)for(const n in K){const g=K[n],r=he(g)?g.bind(a,a):he(g.get)?g.get.bind(a,a):lt,E=!he(g)&&he(g.set)?g.set.bind(a):lt,P=Se({get:r,set:E});Object.defineProperty(x,n,{enumerable:!0,configurable:!0,get:()=>P.value,set:y=>P.value=y})}if(O)for(const n in O)Ya(O[n],x,a,n);if(v){const n=he(v)?v.call(a):v;Reflect.ownKeys(n).forEach(g=>{Xt(g,n[g])})}S&&os(S,e,"c");function o(n,g){ce(g)?g.forEach(r=>n(r.bind(a))):g&&n(g.bind(a))}if(o(Ha,k),o(Ft,R),o(mu,W),o(pu,C),o(hu,I),o(vu,b),o(_u,i),o(Tu,d),o(yu,f),o(Ii,A),o(bi,D),o(Eu,l),ce(p))if(p.length){const n=e.exposed||(e.exposed={});p.forEach(g=>{Object.defineProperty(n,g,{get:()=>a[g],set:r=>a[g]=r})})}else e.exposed||(e.exposed={});T&&e.render===lt&&(e.render=T),m!=null&&(e.inheritAttrs=m),s&&(e.components=s),c&&(e.directives=c)}function Pu(e,t,a=lt,x=!1){ce(e)&&(e=ai(e));for(const M in e){const K=e[M];let N;xe(K)?"default"in K?N=Oe(K.from||M,K.default,!0):N=Oe(K.from||M):N=Oe(K),Me(N)&&x?Object.defineProperty(t,M,{enumerable:!0,configurable:!0,get:()=>N.value,set:O=>N.value=O}):t[M]=N}}function os(e,t,a){et(ce(e)?e.map(x=>x.bind(t.proxy)):e.bind(t.proxy),t,a)}function Ya(e,t,a,x){const M=x.includes(".")?Ua(a,x):()=>a[x];if(Te(e)){const K=t[e];he(K)&&Tt(M,K)}else if(he(e))Tt(M,e.bind(a));else if(xe(e))if(ce(e))e.forEach(K=>Ya(K,t,a,x));else{const K=he(e.handler)?e.handler.bind(a):t[e.handler];he(K)&&Tt(M,K,e)}}function Ci(e){const t=e.type,{mixins:a,extends:x}=t,{mixins:M,optionsCache:K,config:{optionMergeStrategies:N}}=e.appContext,O=K.get(t);let v;return O?v=O:!M.length&&!a&&!x?v=t:(v={},M.length&&M.forEach(w=>dn(v,w,N,!0)),dn(v,t,N)),xe(t)&&K.set(t,v),v}function dn(e,t,a,x=!1){const{mixins:M,extends:K}=t;K&&dn(e,K,a,!0),M&&M.forEach(N=>dn(e,N,a,!0));for(const N in t)if(!(x&&N==="expose")){const O=Ru[N]||a&&a[N];e[N]=O?O(e[N],t[N]):t[N]}return e}const Ru={data:ls,props:Wt,emits:Wt,methods:Wt,computed:Wt,beforeCreate:We,created:We,beforeMount:We,mounted:We,beforeUpdate:We,updated:We,beforeDestroy:We,beforeUnmount:We,destroyed:We,unmounted:We,activated:We,deactivated:We,errorCaptured:We,serverPrefetch:We,components:Wt,directives:Wt,watch:bu,provide:ls,inject:Iu};function ls(e,t){return t?e?function(){return Be(he(e)?e.call(this,this):e,he(t)?t.call(this,this):t)}:t:e}function Iu(e,t){return Wt(ai(e),ai(t))}function ai(e){if(ce(e)){const t={};for(let a=0;a<e.length;a++)t[e[a]]=e[a];return t}return e}function We(e,t){return e?[...new Set([].concat(e,t))]:t}function Wt(e,t){return e?Be(Be(Object.create(null),e),t):t}function bu(e,t){if(!e)return t;if(!t)return e;const a=Be(Object.create(null),e);for(const x in t)a[x]=We(e[x],t[x]);return a}function Cu(e,t,a,x=!1){const M={},K={};an(K,Dn,1),e.propsDefaults=Object.create(null),za(e,t,M,K);for(const N in e.propsOptions[0])N in M||(M[N]=void 0);a?e.props=x?M:Vl(M):e.type.props?e.props=M:e.props=K,e.attrs=K}function Ou(e,t,a,x){const{props:M,attrs:K,vnode:{patchFlag:N}}=e,O=pe(M),[v]=e.propsOptions;let w=!1;if((x||N>0)&&!(N&16)){if(N&8){const S=e.vnode.dynamicProps;for(let k=0;k<S.length;k++){let R=S[k];if(Ln(e.emitsOptions,R))continue;const W=t[R];if(v)if(me(K,R))W!==K[R]&&(K[R]=W,w=!0);else{const C=gt(R);M[C]=oi(v,O,C,W,e,!1)}else W!==K[R]&&(K[R]=W,w=!0)}}}else{za(e,t,M,K)&&(w=!0);let S;for(const k in O)(!t||!me(t,k)&&((S=Jt(k))===k||!me(t,S)))&&(v?a&&(a[k]!==void 0||a[S]!==void 0)&&(M[k]=oi(v,O,k,void 0,e,!0)):delete M[k]);if(K!==O)for(const k in K)(!t||!me(t,k)&&!0)&&(delete K[k],w=!0)}w&&_t(e,"set","$attrs")}function za(e,t,a,x){const[M,K]=e.propsOptions;let N=!1,O;if(t)for(let v in t){if(Dr(v))continue;const w=t[v];let S;M&&me(M,S=gt(v))?!K||!K.includes(S)?a[S]=w:(O||(O={}))[S]=w:Ln(e.emitsOptions,v)||(!(v in x)||w!==x[v])&&(x[v]=w,N=!0)}if(K){const v=pe(a),w=O||_e;for(let S=0;S<K.length;S++){const k=K[S];a[k]=oi(M,v,k,w[k],e,!me(w,k))}}return N}function oi(e,t,a,x,M,K){const N=e[a];if(N!=null){const O=me(N,"default");if(O&&x===void 0){const v=N.default;if(N.type!==Function&&he(v)){const{propsDefaults:w}=M;a in w?x=w[a]:(cr(M),x=w[a]=v.call(null,t),Qt())}else x=v}N[0]&&(K&&!O?x=!1:N[1]&&(x===""||x===Jt(a))&&(x=!0))}return x}function $a(e,t,a=!1){const x=t.propsCache,M=x.get(e);if(M)return M;const K=e.props,N={},O=[];let v=!1;if(!he(e)){const S=k=>{v=!0;const[R,W]=$a(k,t,!0);Be(N,R),W&&O.push(...W)};!a&&t.mixins.length&&t.mixins.forEach(S),e.extends&&S(e.extends),e.mixins&&e.mixins.forEach(S)}if(!K&&!v)return xe(e)&&x.set(e,nr),nr;if(ce(K))for(let S=0;S<K.length;S++){const k=gt(K[S]);us(k)&&(N[k]=_e)}else if(K)for(const S in K){const k=gt(S);if(us(k)){const R=K[S],W=N[k]=ce(R)||he(R)?{type:R}:Object.assign({},R);if(W){const C=ds(Boolean,W.type),I=ds(String,W.type);W[0]=C>-1,W[1]=I<0||C<I,(C>-1||me(W,"default"))&&O.push(k)}}}const w=[N,O];return xe(e)&&x.set(e,w),w}function us(e){return e[0]!=="$"}function fs(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function cs(e,t){return fs(e)===fs(t)}function ds(e,t){return ce(t)?t.findIndex(a=>cs(a,e)):he(t)&&cs(t,e)?0:-1}const Xa=e=>e[0]==="_"||e==="$stable",Oi=e=>ce(e)?e.map(st):[st(e)],Mu=(e,t,a)=>{if(t._n)return t;const x=iu((...M)=>Oi(t(...M)),a);return x._c=!1,x},Qa=(e,t,a)=>{const x=e._ctx;for(const M in e){if(Xa(M))continue;const K=e[M];if(he(K))t[M]=Mu(M,K,x);else if(K!=null){const N=Oi(K);t[M]=()=>N}}},Ja=(e,t)=>{const a=Oi(t);e.slots.default=()=>a},wu=(e,t)=>{if(e.vnode.shapeFlag&32){const a=t._;a?(e.slots=pe(t),an(t,"_",a)):Qa(t,e.slots={})}else e.slots={},t&&Ja(e,t);an(e.slots,Dn,1)},Fu=(e,t,a)=>{const{vnode:x,slots:M}=e;let K=!0,N=_e;if(x.shapeFlag&32){const O=t._;O?a&&O===1?K=!1:(Be(M,t),!a&&O===1&&delete M._):(K=!t.$stable,Qa(t,M)),N=t}else t&&(Ja(e,t),N={default:1});if(K)for(const O in M)!Xa(O)&&!(O in N)&&delete M[O]};function Za(){return{app:null,config:{isNativeTag:ol,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ku=0;function Uu(e,t){return function(x,M=null){he(x)||(x=Object.assign({},x)),M!=null&&!xe(M)&&(M=null);const K=Za(),N=new Set;let O=!1;const v=K.app={_uid:ku++,_component:x,_props:M,_container:null,_context:K,_instance:null,version:af,get config(){return K.config},set config(w){},use(w,...S){return N.has(w)||(w&&he(w.install)?(N.add(w),w.install(v,...S)):he(w)&&(N.add(w),w(v,...S))),v},mixin(w){return K.mixins.includes(w)||K.mixins.push(w),v},component(w,S){return S?(K.components[w]=S,v):K.components[w]},directive(w,S){return S?(K.directives[w]=S,v):K.directives[w]},mount(w,S,k){if(!O){const R=Ie(x,M);return R.appContext=K,S&&t?t(R,w):e(R,w,k),O=!0,v._container=w,w.__vue_app__=v,Rn(R.component)||R.component.proxy}},unmount(){O&&(e(null,v._container),delete v._container.__vue_app__)},provide(w,S){return K.provides[w]=S,v}};return v}}function hn(e,t,a,x,M=!1){if(ce(e)){e.forEach((R,W)=>hn(R,t&&(ce(t)?t[W]:t),a,x,M));return}if(or(x)&&!M)return;const K=x.shapeFlag&4?Rn(x.component)||x.component.proxy:x.el,N=M?null:K,{i:O,r:v}=e,w=t&&t.r,S=O.refs===_e?O.refs={}:O.refs,k=O.setupState;if(w!=null&&w!==v&&(Te(w)?(S[w]=null,me(k,w)&&(k[w]=null)):Me(w)&&(w.value=null)),he(v))Ct(v,O,12,[N,S]);else{const R=Te(v),W=Me(v);if(R||W){const C=()=>{if(e.f){const I=R?me(k,v)?k[v]:S[v]:v.value;M?ce(I)&&mi(I,K):ce(I)?I.includes(K)||I.push(K):R?(S[v]=[K],me(k,v)&&(k[v]=S[v])):(v.value=[K],e.k&&(S[e.k]=v.value))}else R?(S[v]=N,me(k,v)&&(k[v]=N)):W&&(v.value=N,e.k&&(S[e.k]=N))};N?(C.id=-1,Ge(C,a)):C()}}}let Lt=!1;const Jr=e=>/svg/.test(e.namespaceURI)&&e.tagName!=="foreignObject",Zr=e=>e.nodeType===8;function Bu(e){const{mt:t,p:a,o:{patchProp:x,createText:M,nextSibling:K,parentNode:N,remove:O,insert:v,createComment:w}}=e,S=(L,A)=>{if(!A.hasChildNodes()){a(null,L,A),un(),A._vnode=L;return}Lt=!1,k(A.firstChild,L,null,null,null),un(),A._vnode=L,Lt&&console.error("Hydration completed but contains mismatches.")},k=(L,A,h,D,T,d=!1)=>{const f=Zr(L)&&L.data==="[",i=()=>I(L,A,h,D,T,f),{type:l,ref:p,shapeFlag:m,patchFlag:s}=A;let c=L.nodeType;A.el=L,s===-2&&(d=!1,A.dynamicChildren=null);let _=null;switch(l){case fr:c!==3?A.children===""?(v(A.el=M(""),N(L),L),_=L):_=i():(L.data!==A.children&&(Lt=!0,L.data=A.children),_=K(L));break;case $e:c!==8||f?_=i():_=K(L);break;case Rr:if(f&&(L=K(L),c=L.nodeType),c===1||c===3){_=L;const u=!A.children.length;for(let o=0;o<A.staticCount;o++)u&&(A.children+=_.nodeType===1?_.outerHTML:_.data),o===A.staticCount-1&&(A.anchor=_),_=K(_);return f?K(_):_}else i();break;case je:f?_=C(L,A,h,D,T,d):_=i();break;default:if(m&1)c!==1||A.type.toLowerCase()!==L.tagName.toLowerCase()?_=i():_=R(L,A,h,D,T,d);else if(m&6){A.slotScopeIds=T;const u=N(L);if(t(A,u,null,h,D,Jr(u),d),_=f?b(L):K(L),_&&Zr(_)&&_.data==="teleport end"&&(_=K(_)),or(A)){let o;f?(o=Ie(je),o.anchor=_?_.previousSibling:u.lastChild):o=L.nodeType===3?Pn(""):Ie("div"),o.el=L,A.component.subTree=o}}else m&64?c!==8?_=i():_=A.type.hydrate(L,A,h,D,T,d,e,W):m&128&&(_=A.type.hydrate(L,A,h,D,Jr(N(L)),T,d,e,k))}return p!=null&&hn(p,null,D,A),_},R=(L,A,h,D,T,d)=>{d=d||!!A.dynamicChildren;const{type:f,props:i,patchFlag:l,shapeFlag:p,dirs:m}=A,s=f==="input"&&m||f==="option";if(s||l!==-1){if(m&&dt(A,null,h,"created"),i)if(s||!d||l&48)for(const _ in i)(s&&_.endsWith("value")||Br(_)&&!Dr(_))&&x(L,_,null,i[_],!1,void 0,h);else i.onClick&&x(L,"onClick",null,i.onClick,!1,void 0,h);let c;if((c=i&&i.onVnodeBeforeMount)&&qe(c,h,A),m&&dt(A,null,h,"beforeMount"),((c=i&&i.onVnodeMounted)||m)&&Fa(()=>{c&&qe(c,h,A),m&&dt(A,null,h,"mounted")},D),p&16&&!(i&&(i.innerHTML||i.textContent))){let _=W(L.firstChild,A,L,h,D,T,d);for(;_;){Lt=!0;const u=_;_=_.nextSibling,O(u)}}else p&8&&L.textContent!==A.children&&(Lt=!0,L.textContent=A.children)}return L.nextSibling},W=(L,A,h,D,T,d,f)=>{f=f||!!A.dynamicChildren;const i=A.children,l=i.length;for(let p=0;p<l;p++){const m=f?i[p]:i[p]=st(i[p]);if(L)L=k(L,m,D,T,d,f);else{if(m.type===fr&&!m.children)continue;Lt=!0,a(null,m,h,null,D,T,Jr(h),d)}}return L},C=(L,A,h,D,T,d)=>{const{slotScopeIds:f}=A;f&&(T=T?T.concat(f):f);const i=N(L),l=W(K(L),A,i,h,D,T,d);return l&&Zr(l)&&l.data==="]"?K(A.anchor=l):(Lt=!0,v(A.anchor=w("]"),i,l),l)},I=(L,A,h,D,T,d)=>{if(Lt=!0,A.el=null,d){const l=b(L);for(;;){const p=K(L);if(p&&p!==l)O(p);else break}}const f=K(L),i=N(L);return O(L),a(null,A,i,f,h,D,Jr(i),T),f},b=L=>{let A=0;for(;L;)if(L=K(L),L&&Zr(L)&&(L.data==="["&&A++,L.data==="]")){if(A===0)return K(L);A--}return L};return[S,k]}const Ge=Fa;function Nu(e){return Ku(e,Bu)}function Ku(e,t){const a=vl();a.__VUE__=!0;const{insert:x,remove:M,patchProp:K,createElement:N,createText:O,createComment:v,setText:w,setElementText:S,parentNode:k,nextSibling:R,setScopeId:W=lt,insertStaticContent:C}=e,I=(j,Y,Q,J=null,Z=null,ee=null,ne=!1,te=null,q=!!Y.dynamicChildren)=>{if(j===Y)return;j&&!Vt(j,Y)&&(J=G(j),y(j,Z,ee,!0),j=null),Y.patchFlag===-2&&(q=!1,Y.dynamicChildren=null);const{type:re,ref:se,shapeFlag:ie}=Y;switch(re){case fr:b(j,Y,Q,J);break;case $e:L(j,Y,Q,J);break;case Rr:j==null&&A(Y,Q,J,ne);break;case je:s(j,Y,Q,J,Z,ee,ne,te,q);break;default:ie&1?T(j,Y,Q,J,Z,ee,ne,te,q):ie&6?c(j,Y,Q,J,Z,ee,ne,te,q):(ie&64||ie&128)&&re.process(j,Y,Q,J,Z,ee,ne,te,q,z)}se!=null&&Z&&hn(se,j&&j.ref,ee,Y||j,!Y)},b=(j,Y,Q,J)=>{if(j==null)x(Y.el=O(Y.children),Q,J);else{const Z=Y.el=j.el;Y.children!==j.children&&w(Z,Y.children)}},L=(j,Y,Q,J)=>{j==null?x(Y.el=v(Y.children||""),Q,J):Y.el=j.el},A=(j,Y,Q,J)=>{[j.el,j.anchor]=C(j.children,Y,Q,J,j.el,j.anchor)},h=({el:j,anchor:Y},Q,J)=>{let Z;for(;j&&j!==Y;)Z=R(j),x(j,Q,J),j=Z;x(Y,Q,J)},D=({el:j,anchor:Y})=>{let Q;for(;j&&j!==Y;)Q=R(j),M(j),j=Q;M(Y)},T=(j,Y,Q,J,Z,ee,ne,te,q)=>{ne=ne||Y.type==="svg",j==null?d(Y,Q,J,Z,ee,ne,te,q):l(j,Y,Z,ee,ne,te,q)},d=(j,Y,Q,J,Z,ee,ne,te)=>{let q,re;const{type:se,props:ie,shapeFlag:ae,transition:oe,dirs:le}=j;if(q=j.el=N(j.type,ee,ie&&ie.is,ie),ae&8?S(q,j.children):ae&16&&i(j.children,q,null,J,Z,ee&&se!=="foreignObject",ne,te),le&&dt(j,null,J,"created"),f(q,j,j.scopeId,ne,J),ie){for(const fe in ie)fe!=="value"&&!Dr(fe)&&K(q,fe,null,ie[fe],ee,j.children,J,Z,H);"value"in ie&&K(q,"value",null,ie.value),(re=ie.onVnodeBeforeMount)&&qe(re,J,j)}le&&dt(j,null,J,"beforeMount");const ue=(!Z||Z&&!Z.pendingBranch)&&oe&&!oe.persisted;ue&&oe.beforeEnter(q),x(q,Y,Q),((re=ie&&ie.onVnodeMounted)||ue||le)&&Ge(()=>{re&&qe(re,J,j),ue&&oe.enter(q),le&&dt(j,null,J,"mounted")},Z)},f=(j,Y,Q,J,Z)=>{if(Q&&W(j,Q),J)for(let ee=0;ee<J.length;ee++)W(j,J[ee]);if(Z){let ee=Z.subTree;if(Y===ee){const ne=Z.vnode;f(j,ne,ne.scopeId,ne.slotScopeIds,Z.parent)}}},i=(j,Y,Q,J,Z,ee,ne,te,q=0)=>{for(let re=q;re<j.length;re++){const se=j[re]=te?Pt(j[re]):st(j[re]);I(null,se,Y,Q,J,Z,ee,ne,te)}},l=(j,Y,Q,J,Z,ee,ne)=>{const te=Y.el=j.el;let{patchFlag:q,dynamicChildren:re,dirs:se}=Y;q|=j.patchFlag&16;const ie=j.props||_e,ae=Y.props||_e;let oe;Q&&Bt(Q,!1),(oe=ae.onVnodeBeforeUpdate)&&qe(oe,Q,Y,j),se&&dt(Y,j,Q,"beforeUpdate"),Q&&Bt(Q,!0);const le=Z&&Y.type!=="foreignObject";if(re?p(j.dynamicChildren,re,te,Q,J,le,ee):ne||g(j,Y,te,null,Q,J,le,ee,!1),q>0){if(q&16)m(te,Y,ie,ae,Q,J,Z);else if(q&2&&ie.class!==ae.class&&K(te,"class",null,ae.class,Z),q&4&&K(te,"style",ie.style,ae.style,Z),q&8){const ue=Y.dynamicProps;for(let fe=0;fe<ue.length;fe++){const de=ue[fe],ve=ie[de],Le=ae[de];(Le!==ve||de==="value")&&K(te,de,ve,Le,Z,j.children,Q,J,H)}}q&1&&j.children!==Y.children&&S(te,Y.children)}else!ne&&re==null&&m(te,Y,ie,ae,Q,J,Z);((oe=ae.onVnodeUpdated)||se)&&Ge(()=>{oe&&qe(oe,Q,Y,j),se&&dt(Y,j,Q,"updated")},J)},p=(j,Y,Q,J,Z,ee,ne)=>{for(let te=0;te<Y.length;te++){const q=j[te],re=Y[te],se=q.el&&(q.type===je||!Vt(q,re)||q.shapeFlag&70)?k(q.el):Q;I(q,re,se,null,J,Z,ee,ne,!0)}},m=(j,Y,Q,J,Z,ee,ne)=>{if(Q!==J){if(Q!==_e)for(const te in Q)!Dr(te)&&!(te in J)&&K(j,te,Q[te],null,ne,Y.children,Z,ee,H);for(const te in J){if(Dr(te))continue;const q=J[te],re=Q[te];q!==re&&te!=="value"&&K(j,te,re,q,ne,Y.children,Z,ee,H)}"value"in J&&K(j,"value",Q.value,J.value)}},s=(j,Y,Q,J,Z,ee,ne,te,q)=>{const re=Y.el=j?j.el:O(""),se=Y.anchor=j?j.anchor:O("");let{patchFlag:ie,dynamicChildren:ae,slotScopeIds:oe}=Y;oe&&(te=te?te.concat(oe):oe),j==null?(x(re,Q,J),x(se,Q,J),i(Y.children,Q,se,Z,ee,ne,te,q)):ie>0&&ie&64&&ae&&j.dynamicChildren?(p(j.dynamicChildren,ae,Q,Z,ee,ne,te),(Y.key!=null||Z&&Y===Z.subTree)&&qa(j,Y,!0)):g(j,Y,Q,se,Z,ee,ne,te,q)},c=(j,Y,Q,J,Z,ee,ne,te,q)=>{Y.slotScopeIds=te,j==null?Y.shapeFlag&512?Z.ctx.activate(Y,Q,J,ne,q):_(Y,Q,J,Z,ee,ne,q):u(j,Y,q)},_=(j,Y,Q,J,Z,ee,ne)=>{const te=j.component=Qu(j,J,Z);if(Kr(j)&&(te.ctx.renderer=z),Ju(te),te.asyncDep){if(Z&&Z.registerDep(te,o),!j.el){const q=te.subTree=Ie($e);L(null,q,Y,Q)}return}o(te,j,Y,Q,Z,ee,ne)},u=(j,Y,Q)=>{const J=Y.component=j.component;if(ou(j,Y,Q))if(J.asyncDep&&!J.asyncResolved){n(J,Y,Q);return}else J.next=Y,eu(J.update),J.update();else Y.el=j.el,J.vnode=Y},o=(j,Y,Q,J,Z,ee,ne)=>{const te=()=>{if(j.isMounted){let{next:se,bu:ie,u:ae,parent:oe,vnode:le}=j,ue=se,fe;Bt(j,!1),se?(se.el=le.el,n(j,se,ne)):se=le,ie&&rn(ie),(fe=se.props&&se.props.onVnodeBeforeUpdate)&&qe(fe,oe,se,le),Bt(j,!0);const de=Fn(j),ve=j.subTree;j.subTree=de,I(ve,de,k(ve.el),G(ve),j,Z,ee),se.el=de.el,ue===null&&lu(j,de.el),ae&&Ge(ae,Z),(fe=se.props&&se.props.onVnodeUpdated)&&Ge(()=>qe(fe,oe,se,le),Z)}else{let se;const{el:ie,props:ae}=Y,{bm:oe,m:le,parent:ue}=j,fe=or(Y);if(Bt(j,!1),oe&&rn(oe),!fe&&(se=ae&&ae.onVnodeBeforeMount)&&qe(se,ue,Y),Bt(j,!0),ie&&X){const de=()=>{j.subTree=Fn(j),X(ie,j.subTree,j,Z,null)};fe?Y.type.__asyncLoader().then(()=>!j.isUnmounted&&de()):de()}else{const de=j.subTree=Fn(j);I(null,de,Q,J,j,Z,ee),Y.el=de.el}if(le&&Ge(le,Z),!fe&&(se=ae&&ae.onVnodeMounted)){const de=Y;Ge(()=>qe(se,ue,de),Z)}(Y.shapeFlag&256||ue&&or(ue.vnode)&&ue.vnode.shapeFlag&256)&&j.a&&Ge(j.a,Z),j.isMounted=!0,Y=Q=J=null}},q=j.effect=new Ti(te,()=>xn(re),j.scope),re=j.update=()=>q.run();re.id=j.uid,Bt(j,!0),re()},n=(j,Y,Q)=>{Y.component=j;const J=j.vnode.props;j.vnode=Y,j.next=null,Ou(j,Y.props,J,Q),Fu(j,Y.children,Q),mr(),ns(),pr()},g=(j,Y,Q,J,Z,ee,ne,te,q=!1)=>{const re=j&&j.children,se=j?j.shapeFlag:0,ie=Y.children,{patchFlag:ae,shapeFlag:oe}=Y;if(ae>0){if(ae&128){E(re,ie,Q,J,Z,ee,ne,te,q);return}else if(ae&256){r(re,ie,Q,J,Z,ee,ne,te,q);return}}oe&8?(se&16&&H(re,Z,ee),ie!==re&&S(Q,ie)):se&16?oe&16?E(re,ie,Q,J,Z,ee,ne,te,q):H(re,Z,ee,!0):(se&8&&S(Q,""),oe&16&&i(ie,Q,J,Z,ee,ne,te,q))},r=(j,Y,Q,J,Z,ee,ne,te,q)=>{j=j||nr,Y=Y||nr;const re=j.length,se=Y.length,ie=Math.min(re,se);let ae;for(ae=0;ae<ie;ae++){const oe=Y[ae]=q?Pt(Y[ae]):st(Y[ae]);I(j[ae],oe,Q,null,Z,ee,ne,te,q)}re>se?H(j,Z,ee,!0,!1,ie):i(Y,Q,J,Z,ee,ne,te,q,ie)},E=(j,Y,Q,J,Z,ee,ne,te,q)=>{let re=0;const se=Y.length;let ie=j.length-1,ae=se-1;for(;re<=ie&&re<=ae;){const oe=j[re],le=Y[re]=q?Pt(Y[re]):st(Y[re]);if(Vt(oe,le))I(oe,le,Q,null,Z,ee,ne,te,q);else break;re++}for(;re<=ie&&re<=ae;){const oe=j[ie],le=Y[ae]=q?Pt(Y[ae]):st(Y[ae]);if(Vt(oe,le))I(oe,le,Q,null,Z,ee,ne,te,q);else break;ie--,ae--}if(re>ie){if(re<=ae){const oe=ae+1,le=oe<se?Y[oe].el:J;for(;re<=ae;)I(null,Y[re]=q?Pt(Y[re]):st(Y[re]),Q,le,Z,ee,ne,te,q),re++}}else if(re>ae)for(;re<=ie;)y(j[re],Z,ee,!0),re++;else{const oe=re,le=re,ue=new Map;for(re=le;re<=ae;re++){const Ee=Y[re]=q?Pt(Y[re]):st(Y[re]);Ee.key!=null&&ue.set(Ee.key,re)}let fe,de=0;const ve=ae-le+1;let Le=!1,Ae=0;const De=new Array(ve);for(re=0;re<ve;re++)De[re]=0;for(re=oe;re<=ie;re++){const Ee=j[re];if(de>=ve){y(Ee,Z,ee,!0);continue}let be;if(Ee.key!=null)be=ue.get(Ee.key);else for(fe=le;fe<=ae;fe++)if(De[fe-le]===0&&Vt(Ee,Y[fe])){be=fe;break}be===void 0?y(Ee,Z,ee,!0):(De[be-le]=re+1,be>=Ae?Ae=be:Le=!0,I(Ee,Y[be],Q,null,Z,ee,ne,te,q),de++)}const Ye=Le?Wu(De):nr;for(fe=Ye.length-1,re=ve-1;re>=0;re--){const Ee=le+re,be=Y[Ee],He=Ee+1<se?Y[Ee+1].el:J;De[re]===0?I(null,be,Q,He,Z,ee,ne,te,q):Le&&(fe<0||re!==Ye[fe]?P(be,Q,He,2):fe--)}}},P=(j,Y,Q,J,Z=null)=>{const{el:ee,type:ne,transition:te,children:q,shapeFlag:re}=j;if(re&6){P(j.component.subTree,Y,Q,J);return}if(re&128){j.suspense.move(Y,Q,J);return}if(re&64){ne.move(j,Y,Q,z);return}if(ne===je){x(ee,Y,Q);for(let ie=0;ie<q.length;ie++)P(q[ie],Y,Q,J);x(j.anchor,Y,Q);return}if(ne===Rr){h(j,Y,Q);return}if(J!==2&&re&1&&te)if(J===0)te.beforeEnter(ee),x(ee,Y,Q),Ge(()=>te.enter(ee),Z);else{const{leave:ie,delayLeave:ae,afterLeave:oe}=te,le=()=>x(ee,Y,Q),ue=()=>{ie(ee,()=>{le(),oe&&oe()})};ae?ae(ee,le,ue):ue()}else x(ee,Y,Q)},y=(j,Y,Q,J=!1,Z=!1)=>{const{type:ee,props:ne,ref:te,children:q,dynamicChildren:re,shapeFlag:se,patchFlag:ie,dirs:ae}=j;if(te!=null&&hn(te,null,Q,j,!0),se&256){Y.ctx.deactivate(j);return}const oe=se&1&&ae,le=!or(j);let ue;if(le&&(ue=ne&&ne.onVnodeBeforeUnmount)&&qe(ue,Y,j),se&6)F(j.component,Q,J);else{if(se&128){j.suspense.unmount(Q,J);return}oe&&dt(j,null,Y,"beforeUnmount"),se&64?j.type.remove(j,Y,Q,Z,z,J):re&&(ee!==je||ie>0&&ie&64)?H(re,Y,Q,!1,!0):(ee===je&&ie&384||!Z&&se&16)&&H(q,Y,Q),J&&U(j)}(le&&(ue=ne&&ne.onVnodeUnmounted)||oe)&&Ge(()=>{ue&&qe(ue,Y,j),oe&&dt(j,null,Y,"unmounted")},Q)},U=j=>{const{type:Y,el:Q,anchor:J,transition:Z}=j;if(Y===je){B(Q,J);return}if(Y===Rr){D(j);return}const ee=()=>{M(Q),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(j.shapeFlag&1&&Z&&!Z.persisted){const{leave:ne,delayLeave:te}=Z,q=()=>ne(Q,ee);te?te(j.el,ee,q):q()}else ee()},B=(j,Y)=>{let Q;for(;j!==Y;)Q=R(j),M(j),j=Q;M(Y)},F=(j,Y,Q)=>{const{bum:J,scope:Z,update:ee,subTree:ne,um:te}=j;J&&rn(J),Z.stop(),ee&&(ee.active=!1,y(ne,j,Y,Q)),te&&Ge(te,Y),Ge(()=>{j.isUnmounted=!0},Y),Y&&Y.pendingBranch&&!Y.isUnmounted&&j.asyncDep&&!j.asyncResolved&&j.suspenseId===Y.pendingId&&(Y.deps--,Y.deps===0&&Y.resolve())},H=(j,Y,Q,J=!1,Z=!1,ee=0)=>{for(let ne=ee;ne<j.length;ne++)y(j[ne],Y,Q,J,Z)},G=j=>j.shapeFlag&6?G(j.component.subTree):j.shapeFlag&128?j.suspense.next():R(j.anchor||j.el),V=(j,Y,Q)=>{j==null?Y._vnode&&y(Y._vnode,null,null,!0):I(Y._vnode||null,j,Y,null,null,null,Q),ns(),un(),Y._vnode=j},z={p:I,um:y,m:P,r:U,mt:_,mc:i,pc:g,pbc:p,n:G,o:e};let $,X;return t&&([$,X]=t(z)),{render:V,hydrate:$,createApp:Uu(V,$)}}function Bt({effect:e,update:t},a){e.allowRecurse=t.allowRecurse=a}function qa(e,t,a=!1){const x=e.children,M=t.children;if(ce(x)&&ce(M))for(let K=0;K<x.length;K++){const N=x[K];let O=M[K];O.shapeFlag&1&&!O.dynamicChildren&&((O.patchFlag<=0||O.patchFlag===32)&&(O=M[K]=Pt(M[K]),O.el=N.el),a||qa(N,O)),O.type===fr&&(O.el=N.el)}}function Wu(e){const t=e.slice(),a=[0];let x,M,K,N,O;const v=e.length;for(x=0;x<v;x++){const w=e[x];if(w!==0){if(M=a[a.length-1],e[M]<w){t[x]=M,a.push(x);continue}for(K=0,N=a.length-1;K<N;)O=K+N>>1,e[a[O]]<w?K=O+1:N=O;w<e[a[K]]&&(K>0&&(t[x]=a[K-1]),a[K]=x)}}for(K=a.length,N=a[K-1];K-- >0;)a[K]=N,N=t[N];return a}const Hu=e=>e.__isTeleport,je=Symbol(void 0),fr=Symbol(void 0),$e=Symbol(void 0),Rr=Symbol(void 0),Ir=[];let ot=null;function vt(e=!1){Ir.push(ot=e?null:[])}function Gu(){Ir.pop(),ot=Ir[Ir.length-1]||null}let kr=1;function hs(e){kr+=e}function eo(e){return e.dynamicChildren=kr>0?ot||nr:null,Gu(),kr>0&&ot&&ot.push(e),e}function Ot(e,t,a,x,M,K){return eo(Fe(e,t,a,x,M,K,!0))}function to(e,t,a,x,M){return eo(Ie(e,t,a,x,M,!0))}function vn(e){return e?e.__v_isVNode===!0:!1}function Vt(e,t){return e.type===t.type&&e.key===t.key}const Dn="__vInternal",ro=({key:e})=>e!=null?e:null,nn=({ref:e,ref_key:t,ref_for:a})=>e!=null?Te(e)||Me(e)||he(e)?{i:ke,r:e,k:t,f:!!a}:e:null;function Fe(e,t=null,a=null,x=0,M=null,K=e===je?0:1,N=!1,O=!1){const v={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ro(t),ref:t&&nn(t),scopeId:wa,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:K,patchFlag:x,dynamicProps:M,dynamicChildren:null,appContext:null,ctx:ke};return O?(Mi(v,a),K&128&&e.normalize(v)):a&&(v.shapeFlag|=Te(a)?8:16),kr>0&&!N&&ot&&(v.patchFlag>0||K&6)&&v.patchFlag!==32&&ot.push(v),v}const Ie=ju;function ju(e,t=null,a=null,x=0,M=null,K=!1){if((!e||e===xu)&&(e=$e),vn(e)){const O=wt(e,t,!0);return a&&Mi(O,a),kr>0&&!K&&ot&&(O.shapeFlag&6?ot[ot.indexOf(e)]=O:ot.push(O)),O.patchFlag|=-2,O}if(rf(e)&&(e=e.__vccOpts),t){t=Vu(t);let{class:O,style:v}=t;O&&!Te(O)&&(t.class=gr(O)),xe(v)&&(Sa(v)&&!ce(v)&&(v=Be({},v)),t.style=En(v))}const N=Te(e)?1:uu(e)?128:Hu(e)?64:xe(e)?4:he(e)?2:0;return Fe(e,t,a,x,M,N,K,!0)}function Vu(e){return e?Sa(e)||Dn in e?Be({},e):e:null}function wt(e,t,a=!1){const{props:x,ref:M,patchFlag:K,children:N}=e,O=t?zu(x||{},t):x;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:O,key:O&&ro(O),ref:t&&t.ref?a&&M?ce(M)?M.concat(nn(t)):[M,nn(t)]:nn(t):M,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:N,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==je?K===-1?16:K|16:K,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&wt(e.ssContent),ssFallback:e.ssFallback&&wt(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Pn(e=" ",t=0){return Ie(fr,null,e,t)}function Yu(e,t){const a=Ie(Rr,null,e);return a.staticCount=t,a}function Ev(e="",t=!1){return t?(vt(),to($e,null,e)):Ie($e,null,e)}function st(e){return e==null||typeof e=="boolean"?Ie($e):ce(e)?Ie(je,null,e.slice()):typeof e=="object"?Pt(e):Ie(fr,null,String(e))}function Pt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:wt(e)}function Mi(e,t){let a=0;const{shapeFlag:x}=e;if(t==null)t=null;else if(ce(t))a=16;else if(typeof t=="object")if(x&65){const M=t.default;M&&(M._c&&(M._d=!1),Mi(e,M()),M._c&&(M._d=!0));return}else{a=32;const M=t._;!M&&!(Dn in t)?t._ctx=ke:M===3&&ke&&(ke.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else he(t)?(t={default:t,_ctx:ke},a=32):(t=String(t),x&64?(a=16,t=[Pn(t)]):a=8);e.children=t,e.shapeFlag|=a}function zu(...e){const t={};for(let a=0;a<e.length;a++){const x=e[a];for(const M in x)if(M==="class")t.class!==x.class&&(t.class=gr([t.class,x.class]));else if(M==="style")t.style=En([t.style,x.style]);else if(Br(M)){const K=t[M],N=x[M];N&&K!==N&&!(ce(K)&&K.includes(N))&&(t[M]=K?[].concat(K,N):N)}else M!==""&&(t[M]=x[M])}return t}function qe(e,t,a,x=null){et(e,t,7,[a,x])}const $u=Za();let Xu=0;function Qu(e,t,a){const x=e.type,M=(t?t.appContext:e.appContext)||$u,K={uid:Xu++,vnode:e,type:x,parent:t,appContext:M,root:null,next:null,subTree:null,effect:null,update:null,scope:new gl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(M.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:$a(x,M),emitsOptions:Ma(x,M),emit:null,emitted:null,propsDefaults:_e,inheritAttrs:x.inheritAttrs,ctx:_e,data:_e,props:_e,attrs:_e,slots:_e,refs:_e,setupState:_e,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return K.ctx={_:K},K.root=t?t.root:K,K.emit=nu.bind(null,K),e.ce&&e.ce(K),K}let Re=null;const no=()=>Re||ke,cr=e=>{Re=e,e.scope.on()},Qt=()=>{Re&&Re.scope.off(),Re=null};function io(e){return e.vnode.shapeFlag&4}let dr=!1;function Ju(e,t=!1){dr=t;const{props:a,children:x}=e.vnode,M=io(e);Cu(e,a,M,t),wu(e,x);const K=M?Zu(e,t):void 0;return dr=!1,K}function Zu(e,t){const a=e.type;e.accessCache=Object.create(null),e.proxy=xa(new Proxy(e.ctx,Au));const{setup:x}=a;if(x){const M=e.setupContext=x.length>1?ef(e):null;cr(e),mr();const K=Ct(x,e,0,[e.props,M]);if(pr(),Qt(),la(K)){if(K.then(Qt,Qt),t)return K.then(N=>{vs(e,N,t)}).catch(N=>{Nr(N,e,0)});e.asyncDep=K}else vs(e,K,t)}else so(e,t)}function vs(e,t,a){he(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:xe(t)&&(e.setupState=Ra(t)),so(e,a)}let gs;function so(e,t,a){const x=e.type;if(!e.render){if(!t&&gs&&!x.render){const M=x.template||Ci(e).template;if(M){const{isCustomElement:K,compilerOptions:N}=e.appContext.config,{delimiters:O,compilerOptions:v}=x,w=Be(Be({isCustomElement:K,delimiters:O},N),v);x.render=gs(M,w)}}e.render=x.render||lt}cr(e),mr(),Du(e),pr(),Qt()}function qu(e){return new Proxy(e.attrs,{get(t,a){return Ve(e,"get","$attrs"),t[a]}})}function ef(e){const t=x=>{e.exposed=x||{}};let a;return{get attrs(){return a||(a=qu(e))},slots:e.slots,emit:e.emit,expose:t}}function Rn(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Ra(xa(e.exposed)),{get(t,a){if(a in t)return t[a];if(a in Pr)return Pr[a](e)},has(t,a){return a in t||a in Pr}}))}function tf(e,t=!0){return he(e)?e.displayName||e.name:e.name||t&&e.__name}function rf(e){return he(e)&&"__vccOpts"in e}const Se=(e,t)=>Jl(e,t,dr);function Pe(e,t,a){const x=arguments.length;return x===2?xe(t)&&!ce(t)?vn(t)?Ie(e,null,[t]):Ie(e,t):Ie(e,null,t):(x>3?a=Array.prototype.slice.call(arguments,2):x===3&&vn(a)&&(a=[a]),Ie(e,t,a))}const nf=Symbol(""),sf=()=>Oe(nf),af="3.2.47",of="http://www.w3.org/2000/svg",Yt=typeof document!="undefined"?document:null,ms=Yt&&Yt.createElement("template"),lf={insert:(e,t,a)=>{t.insertBefore(e,a||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,a,x)=>{const M=t?Yt.createElementNS(of,e):Yt.createElement(e,a?{is:a}:void 0);return e==="select"&&x&&x.multiple!=null&&M.setAttribute("multiple",x.multiple),M},createText:e=>Yt.createTextNode(e),createComment:e=>Yt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Yt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,a,x,M,K){const N=a?a.previousSibling:t.lastChild;if(M&&(M===K||M.nextSibling))for(;t.insertBefore(M.cloneNode(!0),a),!(M===K||!(M=M.nextSibling)););else{ms.innerHTML=x?`<svg>${e}</svg>`:e;const O=ms.content;if(x){const v=O.firstChild;for(;v.firstChild;)O.appendChild(v.firstChild);O.removeChild(v)}t.insertBefore(O,a)}return[N?N.nextSibling:t.firstChild,a?a.previousSibling:t.lastChild]}};function uf(e,t,a){const x=e._vtc;x&&(t=(t?[t,...x]:[...x]).join(" ")),t==null?e.removeAttribute("class"):a?e.setAttribute("class",t):e.className=t}function ff(e,t,a){const x=e.style,M=Te(a);if(a&&!M){if(t&&!Te(t))for(const K in t)a[K]==null&&li(x,K,"");for(const K in a)li(x,K,a[K])}else{const K=x.display;M?t!==a&&(x.cssText=a):t&&e.removeAttribute("style"),"_vod"in e&&(x.display=K)}}const ps=/\s*!important$/;function li(e,t,a){if(ce(a))a.forEach(x=>li(e,t,x));else if(a==null&&(a=""),t.startsWith("--"))e.setProperty(t,a);else{const x=cf(e,t);ps.test(a)?e.setProperty(Jt(x),a.replace(ps,""),"important"):e[x]=a}}const Es=["Webkit","Moz","ms"],Nn={};function cf(e,t){const a=Nn[t];if(a)return a;let x=gt(t);if(x!=="filter"&&x in e)return Nn[t]=x;x=_n(x);for(let M=0;M<Es.length;M++){const K=Es[M]+x;if(K in e)return Nn[t]=K}return t}const ys="http://www.w3.org/1999/xlink";function df(e,t,a,x,M){if(x&&t.startsWith("xlink:"))a==null?e.removeAttributeNS(ys,t.slice(6,t.length)):e.setAttributeNS(ys,t,a);else{const K=al(t);a==null||K&&!ia(a)?e.removeAttribute(t):e.setAttribute(t,K?"":a)}}function hf(e,t,a,x,M,K,N){if(t==="innerHTML"||t==="textContent"){x&&N(x,M,K),e[t]=a==null?"":a;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=a;const v=a==null?"":a;(e.value!==v||e.tagName==="OPTION")&&(e.value=v),a==null&&e.removeAttribute(t);return}let O=!1;if(a===""||a==null){const v=typeof e[t];v==="boolean"?a=ia(a):a==null&&v==="string"?(a="",O=!0):v==="number"&&(a=0,O=!0)}try{e[t]=a}catch{}O&&e.removeAttribute(t)}function tr(e,t,a,x){e.addEventListener(t,a,x)}function vf(e,t,a,x){e.removeEventListener(t,a,x)}function gf(e,t,a,x,M=null){const K=e._vei||(e._vei={}),N=K[t];if(x&&N)N.value=x;else{const[O,v]=mf(t);if(x){const w=K[t]=yf(x,M);tr(e,O,w,v)}else N&&(vf(e,O,N,v),K[t]=void 0)}}const Ts=/(?:Once|Passive|Capture)$/;function mf(e){let t;if(Ts.test(e)){t={};let x;for(;x=e.match(Ts);)e=e.slice(0,e.length-x[0].length),t[x[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Jt(e.slice(2)),t]}let Kn=0;const pf=Promise.resolve(),Ef=()=>Kn||(pf.then(()=>Kn=0),Kn=Date.now());function yf(e,t){const a=x=>{if(!x._vts)x._vts=Date.now();else if(x._vts<=a.attached)return;et(Tf(x,a.value),t,5,[x])};return a.value=e,a.attached=Ef(),a}function Tf(e,t){if(ce(t)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},t.map(x=>M=>!M._stopped&&x&&x(M))}else return t}const _s=/^on[a-z]/,_f=(e,t,a,x,M=!1,K,N,O,v)=>{t==="class"?uf(e,x,M):t==="style"?ff(e,a,x):Br(t)?gi(t)||gf(e,t,a,x,N):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Sf(e,t,x,M))?hf(e,t,x,K,N,O,v):(t==="true-value"?e._trueValue=x:t==="false-value"&&(e._falseValue=x),df(e,t,x,M))};function Sf(e,t,a,x){return x?!!(t==="innerHTML"||t==="textContent"||t in e&&_s.test(t)&&he(a)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||_s.test(t)&&Te(a)?!1:t in e}const At="transition",_r="animation",wi=(e,{slots:t})=>Pe(Ba,xf(e),t);wi.displayName="Transition";const ao={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};wi.props=Be({},Ba.props,ao);const Nt=(e,t=[])=>{ce(e)?e.forEach(a=>a(...t)):e&&e(...t)},Ss=e=>e?ce(e)?e.some(t=>t.length>1):e.length>1:!1;function xf(e){const t={};for(const s in e)s in ao||(t[s]=e[s]);if(e.css===!1)return t;const{name:a="v",type:x,duration:M,enterFromClass:K=`${a}-enter-from`,enterActiveClass:N=`${a}-enter-active`,enterToClass:O=`${a}-enter-to`,appearFromClass:v=K,appearActiveClass:w=N,appearToClass:S=O,leaveFromClass:k=`${a}-leave-from`,leaveActiveClass:R=`${a}-leave-active`,leaveToClass:W=`${a}-leave-to`}=e,C=Lf(M),I=C&&C[0],b=C&&C[1],{onBeforeEnter:L,onEnter:A,onEnterCancelled:h,onLeave:D,onLeaveCancelled:T,onBeforeAppear:d=L,onAppear:f=A,onAppearCancelled:i=h}=t,l=(s,c,_)=>{Kt(s,c?S:O),Kt(s,c?w:N),_&&_()},p=(s,c)=>{s._isLeaving=!1,Kt(s,k),Kt(s,W),Kt(s,R),c&&c()},m=s=>(c,_)=>{const u=s?f:A,o=()=>l(c,s,_);Nt(u,[c,o]),xs(()=>{Kt(c,s?v:K),Dt(c,s?S:O),Ss(u)||Ls(c,x,I,o)})};return Be(t,{onBeforeEnter(s){Nt(L,[s]),Dt(s,K),Dt(s,N)},onBeforeAppear(s){Nt(d,[s]),Dt(s,v),Dt(s,w)},onEnter:m(!1),onAppear:m(!0),onLeave(s,c){s._isLeaving=!0;const _=()=>p(s,c);Dt(s,k),Pf(),Dt(s,R),xs(()=>{!s._isLeaving||(Kt(s,k),Dt(s,W),Ss(D)||Ls(s,x,b,_))}),Nt(D,[s,_])},onEnterCancelled(s){l(s,!1),Nt(h,[s])},onAppearCancelled(s){l(s,!0),Nt(i,[s])},onLeaveCancelled(s){p(s),Nt(T,[s])}})}function Lf(e){if(e==null)return null;if(xe(e))return[Wn(e.enter),Wn(e.leave)];{const t=Wn(e);return[t,t]}}function Wn(e){return hl(e)}function Dt(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.add(a)),(e._vtc||(e._vtc=new Set)).add(t)}function Kt(e,t){t.split(/\s+/).forEach(x=>x&&e.classList.remove(x));const{_vtc:a}=e;a&&(a.delete(t),a.size||(e._vtc=void 0))}function xs(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Af=0;function Ls(e,t,a,x){const M=e._endId=++Af,K=()=>{M===e._endId&&x()};if(a)return setTimeout(K,a);const{type:N,timeout:O,propCount:v}=Df(e,t);if(!N)return x();const w=N+"end";let S=0;const k=()=>{e.removeEventListener(w,R),K()},R=W=>{W.target===e&&++S>=v&&k()};setTimeout(()=>{S<v&&k()},O+1),e.addEventListener(w,R)}function Df(e,t){const a=window.getComputedStyle(e),x=C=>(a[C]||"").split(", "),M=x(`${At}Delay`),K=x(`${At}Duration`),N=As(M,K),O=x(`${_r}Delay`),v=x(`${_r}Duration`),w=As(O,v);let S=null,k=0,R=0;t===At?N>0&&(S=At,k=N,R=K.length):t===_r?w>0&&(S=_r,k=w,R=v.length):(k=Math.max(N,w),S=k>0?N>w?At:_r:null,R=S?S===At?K.length:v.length:0);const W=S===At&&/\b(transform|all)(,|$)/.test(x(`${At}Property`).toString());return{type:S,timeout:k,propCount:R,hasTransform:W}}function As(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((a,x)=>Ds(a)+Ds(e[x])))}function Ds(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function Pf(){return document.body.offsetHeight}const Ps=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ce(t)?a=>rn(t,a):t};function Rf(e){e.target.composing=!0}function Rs(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const If={created(e,{modifiers:{lazy:t,trim:a,number:x}},M){e._assign=Ps(M);const K=x||M.props&&M.props.type==="number";tr(e,t?"change":"input",N=>{if(N.target.composing)return;let O=e.value;a&&(O=O.trim()),K&&(O=Jn(O)),e._assign(O)}),a&&tr(e,"change",()=>{e.value=e.value.trim()}),t||(tr(e,"compositionstart",Rf),tr(e,"compositionend",Rs),tr(e,"change",Rs))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:a,trim:x,number:M}},K){if(e._assign=Ps(K),e.composing||document.activeElement===e&&e.type!=="range"&&(a||x&&e.value.trim()===t||(M||e.type==="number")&&Jn(e.value)===t))return;const N=t==null?"":t;e.value!==N&&(e.value=N)}},bf={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},yv=(e,t)=>a=>{if(!("key"in a))return;const x=Jt(a.key);if(t.some(M=>M===x||bf[M]===x))return e(a)},qr={beforeMount(e,{value:t},{transition:a}){e._vod=e.style.display==="none"?"":e.style.display,a&&t?a.beforeEnter(e):Sr(e,t)},mounted(e,{value:t},{transition:a}){a&&t&&a.enter(e)},updated(e,{value:t,oldValue:a},{transition:x}){!t!=!a&&(x?t?(x.beforeEnter(e),Sr(e,!0),x.enter(e)):x.leave(e,()=>{Sr(e,!1)}):Sr(e,t))},beforeUnmount(e,{value:t}){Sr(e,t)}};function Sr(e,t){e.style.display=t?e._vod:"none"}const Cf=Be({patchProp:_f},lf);let Hn,Is=!1;function Of(){return Hn=Is?Hn:Nu(Cf),Is=!0,Hn}const Mf=(...e)=>{const t=Of().createApp(...e),{mount:a}=t;return t.mount=x=>{const M=wf(x);if(M)return a(M,!0,M instanceof SVGElement)},t};function wf(e){return Te(e)?document.querySelector(e):e}const Ff=JSON.parse('{"base":"/","lang":"en-US","title":"Personal Root Live","description":"Personal Root live","head":[["meta",{"name":"theme-color","content":"#3eaf7c"}],["meta",{"name":"apple-mobile-web-app-capable","content":"yes"}],["meta",{"name":"apple-mobile-web-app-status-bar-style","content":"black"}],["link",{"rel":"apple-touch-icon","sizes":"180x180","href":"/favicons/apple-touch-icon.png"}],["link",{"rel":"icon","type":"image/png","sizes":"32x32","href":"/favicons/favicon-32x32.png"}],["link",{"rel":"icon","type":"image/png","sizes":"16x16","href":"/favicons/favicon-16x16.png"}],["link",{"rel":"manifest","href":"/favicons/site.webmanifest"}],["link",{"rel":"shortcut icon","href":"/favicons/favicon.ico"}],["meta",{"name":"msapplication-TileColor","content":"#3a0839"}],["meta",{"name":"robots","content":"noindex,nofollow"}]],"locales":{"/":{"lang":"en-US","title":"Personal Root Live","description":"Personal Root live"}}}');var kf=([e,t,a])=>e==="meta"&&t.name?`${e}.${t.name}`:["title","base"].includes(e)?e:e==="template"&&t.id?`${e}.${t.id}`:JSON.stringify([e,t,a]),Uf=e=>{const t=new Set,a=[];return e.forEach(x=>{const M=kf(x);t.has(M)||(t.add(M),a.push(x))}),a},Bf=e=>/^(https?:)?\/\//.test(e),Tv=e=>/^mailto:/.test(e),_v=e=>/^tel:/.test(e),oo=e=>Object.prototype.toString.call(e)==="[object Object]",Nf=e=>e.replace(/\/$/,""),Kf=e=>e.replace(/^\//,""),lo=(e,t)=>{const a=Object.keys(e).sort((x,M)=>{const K=M.split("/").length-x.split("/").length;return K!==0?K:M.length-x.length});for(const x of a)if(t.startsWith(x))return x;return"/"};const uo={"v-8daa1a0e":cn(()=>lr(()=>import("./index.html.9e29f9c8.js"),[])),"v-3706649a":cn(()=>lr(()=>import("./404.html.4e21e853.js"),[]))},Wf={404:cn(()=>lr(()=>import("./404.ee868220.js"),[])),Layout:cn(()=>lr(()=>import("./Layout.9f14d4c7.js"),[]))};var fo=Ue(el),co=Li({key:"",path:"",title:"",lang:"",frontmatter:{},excerpt:"",headers:[]}),yt=Ue(co),Wr=()=>yt;Hi.webpackHot&&(__VUE_HMR_RUNTIME__.updatePageData=e=>{fo.value[e.key]=()=>Promise.resolve(e),e.key===yt.value.key&&(yt.value=e)});var ho=Symbol(""),Hf=()=>{const e=Oe(ho);if(!e)throw new Error("usePageFrontmatter() is called without provider.");return e},vo=Symbol(""),Gf=()=>{const e=Oe(vo);if(!e)throw new Error("usePageHead() is called without provider.");return e},jf=Symbol(""),go=Symbol(""),Vf=()=>{const e=Oe(go);if(!e)throw new Error("usePageLang() is called without provider.");return e},Fi=Symbol(""),Yf=()=>{const e=Oe(Fi);if(!e)throw new Error("useRouteLocale() is called without provider.");return e},It=Ue(Ff),zf=()=>It;Hi.webpackHot&&(__VUE_HMR_RUNTIME__.updateSiteData=e=>{It.value=e});var mo=Symbol(""),Sv=()=>{const e=Oe(mo);if(!e)throw new Error("useSiteLocaleData() is called without provider.");return e},$f=Symbol(""),Ht=Er({resolvePageData:async e=>{const t=fo.value[e],a=await(t==null?void 0:t());return a!=null?a:co},resolvePageFrontmatter:e=>e.frontmatter,resolvePageHead:(e,t,a)=>{const x=Te(t.description)?t.description:a.description,M=[...ce(t.head)?t.head:[],...a.head,["title",{},e],["meta",{name:"description",content:x}]];return Uf(M)},resolvePageHeadTitle:(e,t)=>`${e.title?`${e.title} | `:""}${t.title}`,resolvePageLang:e=>e.lang||"en",resolveRouteLocale:(e,t)=>lo(e,t),resolveSiteLocaleData:(e,t)=>({...e,...e.locales[t]})}),Xf=tt({name:"ClientOnly",setup(e,t){const a=Ue(!1);return Ft(()=>{a.value=!0}),()=>{var x,M;return a.value?(M=(x=t.slots).default)==null?void 0:M.call(x):null}}}),Qf=tt({name:"Content",props:{pageKey:{type:String,required:!1,default:""}},setup(e){const t=Wr(),a=Se(()=>uo[e.pageKey||t.value.key]);return()=>a.value?Pe(a.value):Pe("div","404 Not Found")}}),bs=tt({name:"Vuepress",setup(){const e=Wr(),t=Se(()=>{let a;if(e.value.path){const x=e.value.frontmatter.layout;Te(x)?a=x:a="Layout"}else a="404";return Wf[a]||Su(a,!1)});return()=>Pe(t.value)}}),Jf=e=>Bf(e)?e:`${zf().value.base}${Kf(e)}`,kt=e=>e;function po(e,t,a){var x,M,K;t===void 0&&(t=50),a===void 0&&(a={});var N=(x=a.isImmediate)!=null&&x,O=(M=a.callback)!=null&&M,v=a.maxWait,w=Date.now(),S=[];function k(){if(v!==void 0){var W=Date.now()-w;if(W+t>=v)return v-W}return t}var R=function(){var W=[].slice.call(arguments),C=this;return new Promise(function(I,b){var L=N&&K===void 0;if(K!==void 0&&clearTimeout(K),K=setTimeout(function(){if(K=void 0,w=Date.now(),!N){var h=e.apply(C,W);O&&O(h),S.forEach(function(D){return(0,D.resolve)(h)}),S=[]}},k()),L){var A=e.apply(C,W);return O&&O(A),I(A)}S.push({resolve:I,reject:b})})};return R.cancel=function(W){K!==void 0&&clearTimeout(K),S.forEach(function(C){return(0,C.reject)(W)}),S=[]},R}/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const rr=typeof window!="undefined";function Zf(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const ye=Object.assign;function Gn(e,t){const a={};for(const x in t){const M=t[x];a[x]=ft(M)?M.map(e):e(M)}return a}const br=()=>{},ft=Array.isArray,qf=/\/$/,ec=e=>e.replace(qf,"");function jn(e,t,a="/"){let x,M={},K="",N="";const O=t.indexOf("#");let v=t.indexOf("?");return O<v&&O>=0&&(v=-1),v>-1&&(x=t.slice(0,v),K=t.slice(v+1,O>-1?O:t.length),M=e(K)),O>-1&&(x=x||t.slice(0,O),N=t.slice(O,t.length)),x=ic(x!=null?x:t,a),{fullPath:x+(K&&"?")+K+N,path:x,query:M,hash:N}}function tc(e,t){const a=t.query?e(t.query):"";return t.path+(a&&"?")+a+(t.hash||"")}function Cs(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function rc(e,t,a){const x=t.matched.length-1,M=a.matched.length-1;return x>-1&&x===M&&hr(t.matched[x],a.matched[M])&&Eo(t.params,a.params)&&e(t.query)===e(a.query)&&t.hash===a.hash}function hr(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Eo(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const a in e)if(!nc(e[a],t[a]))return!1;return!0}function nc(e,t){return ft(e)?Os(e,t):ft(t)?Os(t,e):e===t}function Os(e,t){return ft(t)?e.length===t.length&&e.every((a,x)=>a===t[x]):e.length===1&&e[0]===t}function ic(e,t){if(e.startsWith("/"))return e;if(!e)return t;const a=t.split("/"),x=e.split("/");let M=a.length-1,K,N;for(K=0;K<x.length;K++)if(N=x[K],N!==".")if(N==="..")M>1&&M--;else break;return a.slice(0,M).join("/")+"/"+x.slice(K-(K===x.length?1:0)).join("/")}var Ur;(function(e){e.pop="pop",e.push="push"})(Ur||(Ur={}));var Cr;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Cr||(Cr={}));function sc(e){if(!e)if(rr){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),ec(e)}const ac=/^[^#]+#/;function oc(e,t){return e.replace(ac,"#")+t}function lc(e,t){const a=document.documentElement.getBoundingClientRect(),x=e.getBoundingClientRect();return{behavior:t.behavior,left:x.left-a.left-(t.left||0),top:x.top-a.top-(t.top||0)}}const In=()=>({left:window.pageXOffset,top:window.pageYOffset});function uc(e){let t;if("el"in e){const a=e.el,x=typeof a=="string"&&a.startsWith("#"),M=typeof a=="string"?x?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!M)return;t=lc(M,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Ms(e,t){return(history.state?history.state.position-t:-1)+e}const ui=new Map;function fc(e,t){ui.set(e,t)}function cc(e){const t=ui.get(e);return ui.delete(e),t}let dc=()=>location.protocol+"//"+location.host;function yo(e,t){const{pathname:a,search:x,hash:M}=t,K=e.indexOf("#");if(K>-1){let O=M.includes(e.slice(K))?e.slice(K).length:1,v=M.slice(O);return v[0]!=="/"&&(v="/"+v),Cs(v,"")}return Cs(a,e)+x+M}function hc(e,t,a,x){let M=[],K=[],N=null;const O=({state:R})=>{const W=yo(e,location),C=a.value,I=t.value;let b=0;if(R){if(a.value=W,t.value=R,N&&N===C){N=null;return}b=I?R.position-I.position:0}else x(W);M.forEach(L=>{L(a.value,C,{delta:b,type:Ur.pop,direction:b?b>0?Cr.forward:Cr.back:Cr.unknown})})};function v(){N=a.value}function w(R){M.push(R);const W=()=>{const C=M.indexOf(R);C>-1&&M.splice(C,1)};return K.push(W),W}function S(){const{history:R}=window;!R.state||R.replaceState(ye({},R.state,{scroll:In()}),"")}function k(){for(const R of K)R();K=[],window.removeEventListener("popstate",O),window.removeEventListener("beforeunload",S)}return window.addEventListener("popstate",O),window.addEventListener("beforeunload",S),{pauseListeners:v,listen:w,destroy:k}}function ws(e,t,a,x=!1,M=!1){return{back:e,current:t,forward:a,replaced:x,position:window.history.length,scroll:M?In():null}}function vc(e){const{history:t,location:a}=window,x={value:yo(e,a)},M={value:t.state};M.value||K(x.value,{back:null,current:x.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function K(v,w,S){const k=e.indexOf("#"),R=k>-1?(a.host&&document.querySelector("base")?e:e.slice(k))+v:dc()+e+v;try{t[S?"replaceState":"pushState"](w,"",R),M.value=w}catch(W){console.error(W),a[S?"replace":"assign"](R)}}function N(v,w){const S=ye({},t.state,ws(M.value.back,v,M.value.forward,!0),w,{position:M.value.position});K(v,S,!0),x.value=v}function O(v,w){const S=ye({},M.value,t.state,{forward:v,scroll:In()});K(S.current,S,!0);const k=ye({},ws(x.value,v,null),{position:S.position+1},w);K(v,k,!1),x.value=v}return{location:x,state:M,push:O,replace:N}}function gc(e){e=sc(e);const t=vc(e),a=hc(e,t.state,t.location,t.replace);function x(K,N=!0){N||a.pauseListeners(),history.go(K)}const M=ye({location:"",base:e,go:x,createHref:oc.bind(null,e)},t,a);return Object.defineProperty(M,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(M,"state",{enumerable:!0,get:()=>t.state.value}),M}function mc(e){return typeof e=="string"||e&&typeof e=="object"}function To(e){return typeof e=="string"||typeof e=="symbol"}const pt={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},_o=Symbol("");var Fs;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Fs||(Fs={}));function vr(e,t){return ye(new Error,{type:e,[_o]:!0},t)}function mt(e,t){return e instanceof Error&&_o in e&&(t==null||!!(e.type&t))}const ks="[^/]+?",pc={sensitive:!1,strict:!1,start:!0,end:!0},Ec=/[.+*?^${}()[\]/\\]/g;function yc(e,t){const a=ye({},pc,t),x=[];let M=a.start?"^":"";const K=[];for(const w of e){const S=w.length?[]:[90];a.strict&&!w.length&&(M+="/");for(let k=0;k<w.length;k++){const R=w[k];let W=40+(a.sensitive?.25:0);if(R.type===0)k||(M+="/"),M+=R.value.replace(Ec,"\\$&"),W+=40;else if(R.type===1){const{value:C,repeatable:I,optional:b,regexp:L}=R;K.push({name:C,repeatable:I,optional:b});const A=L||ks;if(A!==ks){W+=10;try{new RegExp(`(${A})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${C}" (${A}): `+D.message)}}let h=I?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;k||(h=b&&w.length<2?`(?:/${h})`:"/"+h),b&&(h+="?"),M+=h,W+=20,b&&(W+=-8),I&&(W+=-20),A===".*"&&(W+=-50)}S.push(W)}x.push(S)}if(a.strict&&a.end){const w=x.length-1;x[w][x[w].length-1]+=.7000000000000001}a.strict||(M+="/?"),a.end?M+="$":a.strict&&(M+="(?:/|$)");const N=new RegExp(M,a.sensitive?"":"i");function O(w){const S=w.match(N),k={};if(!S)return null;for(let R=1;R<S.length;R++){const W=S[R]||"",C=K[R-1];k[C.name]=W&&C.repeatable?W.split("/"):W}return k}function v(w){let S="",k=!1;for(const R of e){(!k||!S.endsWith("/"))&&(S+="/"),k=!1;for(const W of R)if(W.type===0)S+=W.value;else if(W.type===1){const{value:C,repeatable:I,optional:b}=W,L=C in w?w[C]:"";if(ft(L)&&!I)throw new Error(`Provided param "${C}" is an array but it is not repeatable (* or + modifiers)`);const A=ft(L)?L.join("/"):L;if(!A)if(b)R.length<2&&(S.endsWith("/")?S=S.slice(0,-1):k=!0);else throw new Error(`Missing required param "${C}"`);S+=A}}return S||"/"}return{re:N,score:x,keys:K,parse:O,stringify:v}}function Tc(e,t){let a=0;for(;a<e.length&&a<t.length;){const x=t[a]-e[a];if(x)return x;a++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function _c(e,t){let a=0;const x=e.score,M=t.score;for(;a<x.length&&a<M.length;){const K=Tc(x[a],M[a]);if(K)return K;a++}if(Math.abs(M.length-x.length)===1){if(Us(x))return 1;if(Us(M))return-1}return M.length-x.length}function Us(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Sc={type:0,value:""},xc=/[a-zA-Z0-9_]/;function Lc(e){if(!e)return[[]];if(e==="/")return[[Sc]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(W){throw new Error(`ERR (${a})/"${w}": ${W}`)}let a=0,x=a;const M=[];let K;function N(){K&&M.push(K),K=[]}let O=0,v,w="",S="";function k(){!w||(a===0?K.push({type:0,value:w}):a===1||a===2||a===3?(K.length>1&&(v==="*"||v==="+")&&t(`A repeatable param (${w}) must be alone in its segment. eg: '/:ids+.`),K.push({type:1,value:w,regexp:S,repeatable:v==="*"||v==="+",optional:v==="*"||v==="?"})):t("Invalid state to consume buffer"),w="")}function R(){w+=v}for(;O<e.length;){if(v=e[O++],v==="\\"&&a!==2){x=a,a=4;continue}switch(a){case 0:v==="/"?(w&&k(),N()):v===":"?(k(),a=1):R();break;case 4:R(),a=x;break;case 1:v==="("?a=2:xc.test(v)?R():(k(),a=0,v!=="*"&&v!=="?"&&v!=="+"&&O--);break;case 2:v===")"?S[S.length-1]=="\\"?S=S.slice(0,-1)+v:a=3:S+=v;break;case 3:k(),a=0,v!=="*"&&v!=="?"&&v!=="+"&&O--,S="";break;default:t("Unknown state");break}}return a===2&&t(`Unfinished custom RegExp for param "${w}"`),k(),N(),M}function Ac(e,t,a){const x=yc(Lc(e.path),a),M=ye(x,{record:e,parent:t,children:[],alias:[]});return t&&!M.record.aliasOf==!t.record.aliasOf&&t.children.push(M),M}function Dc(e,t){const a=[],x=new Map;t=Ks({strict:!1,end:!0,sensitive:!1},t);function M(S){return x.get(S)}function K(S,k,R){const W=!R,C=Pc(S);C.aliasOf=R&&R.record;const I=Ks(t,S),b=[C];if("alias"in S){const h=typeof S.alias=="string"?[S.alias]:S.alias;for(const D of h)b.push(ye({},C,{components:R?R.record.components:C.components,path:D,aliasOf:R?R.record:C}))}let L,A;for(const h of b){const{path:D}=h;if(k&&D[0]!=="/"){const T=k.record.path,d=T[T.length-1]==="/"?"":"/";h.path=k.record.path+(D&&d+D)}if(L=Ac(h,k,I),R?R.alias.push(L):(A=A||L,A!==L&&A.alias.push(L),W&&S.name&&!Ns(L)&&N(S.name)),C.children){const T=C.children;for(let d=0;d<T.length;d++)K(T[d],L,R&&R.children[d])}R=R||L,(L.record.components&&Object.keys(L.record.components).length||L.record.name||L.record.redirect)&&v(L)}return A?()=>{N(A)}:br}function N(S){if(To(S)){const k=x.get(S);k&&(x.delete(S),a.splice(a.indexOf(k),1),k.children.forEach(N),k.alias.forEach(N))}else{const k=a.indexOf(S);k>-1&&(a.splice(k,1),S.record.name&&x.delete(S.record.name),S.children.forEach(N),S.alias.forEach(N))}}function O(){return a}function v(S){let k=0;for(;k<a.length&&_c(S,a[k])>=0&&(S.record.path!==a[k].record.path||!So(S,a[k]));)k++;a.splice(k,0,S),S.record.name&&!Ns(S)&&x.set(S.record.name,S)}function w(S,k){let R,W={},C,I;if("name"in S&&S.name){if(R=x.get(S.name),!R)throw vr(1,{location:S});I=R.record.name,W=ye(Bs(k.params,R.keys.filter(A=>!A.optional).map(A=>A.name)),S.params&&Bs(S.params,R.keys.map(A=>A.name))),C=R.stringify(W)}else if("path"in S)C=S.path,R=a.find(A=>A.re.test(C)),R&&(W=R.parse(C),I=R.record.name);else{if(R=k.name?x.get(k.name):a.find(A=>A.re.test(k.path)),!R)throw vr(1,{location:S,currentLocation:k});I=R.record.name,W=ye({},k.params,S.params),C=R.stringify(W)}const b=[];let L=R;for(;L;)b.unshift(L.record),L=L.parent;return{name:I,path:C,params:W,matched:b,meta:Ic(b)}}return e.forEach(S=>K(S)),{addRoute:K,resolve:w,removeRoute:N,getRoutes:O,getRecordMatcher:M}}function Bs(e,t){const a={};for(const x of t)x in e&&(a[x]=e[x]);return a}function Pc(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Rc(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Rc(e){const t={},a=e.props||!1;if("component"in e)t.default=a;else for(const x in e.components)t[x]=typeof a=="boolean"?a:a[x];return t}function Ns(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Ic(e){return e.reduce((t,a)=>ye(t,a.meta),{})}function Ks(e,t){const a={};for(const x in e)a[x]=x in t?t[x]:e[x];return a}function So(e,t){return t.children.some(a=>a===e||So(e,a))}const xo=/#/g,bc=/&/g,Cc=/\//g,Oc=/=/g,Mc=/\?/g,Lo=/\+/g,wc=/%5B/g,Fc=/%5D/g,Ao=/%5E/g,kc=/%60/g,Do=/%7B/g,Uc=/%7C/g,Po=/%7D/g,Bc=/%20/g;function ki(e){return encodeURI(""+e).replace(Uc,"|").replace(wc,"[").replace(Fc,"]")}function Nc(e){return ki(e).replace(Do,"{").replace(Po,"}").replace(Ao,"^")}function fi(e){return ki(e).replace(Lo,"%2B").replace(Bc,"+").replace(xo,"%23").replace(bc,"%26").replace(kc,"`").replace(Do,"{").replace(Po,"}").replace(Ao,"^")}function Kc(e){return fi(e).replace(Oc,"%3D")}function Wc(e){return ki(e).replace(xo,"%23").replace(Mc,"%3F")}function Hc(e){return e==null?"":Wc(e).replace(Cc,"%2F")}function gn(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function Gc(e){const t={};if(e===""||e==="?")return t;const x=(e[0]==="?"?e.slice(1):e).split("&");for(let M=0;M<x.length;++M){const K=x[M].replace(Lo," "),N=K.indexOf("="),O=gn(N<0?K:K.slice(0,N)),v=N<0?null:gn(K.slice(N+1));if(O in t){let w=t[O];ft(w)||(w=t[O]=[w]),w.push(v)}else t[O]=v}return t}function Ws(e){let t="";for(let a in e){const x=e[a];if(a=Kc(a),x==null){x!==void 0&&(t+=(t.length?"&":"")+a);continue}(ft(x)?x.map(K=>K&&fi(K)):[x&&fi(x)]).forEach(K=>{K!==void 0&&(t+=(t.length?"&":"")+a,K!=null&&(t+="="+K))})}return t}function jc(e){const t={};for(const a in e){const x=e[a];x!==void 0&&(t[a]=ft(x)?x.map(M=>M==null?null:""+M):x==null?x:""+x)}return t}const Vc=Symbol(""),Hs=Symbol(""),bn=Symbol(""),Ui=Symbol(""),ci=Symbol("");function xr(){let e=[];function t(x){return e.push(x),()=>{const M=e.indexOf(x);M>-1&&e.splice(M,1)}}function a(){e=[]}return{add:t,list:()=>e,reset:a}}function Rt(e,t,a,x,M){const K=x&&(x.enterCallbacks[M]=x.enterCallbacks[M]||[]);return()=>new Promise((N,O)=>{const v=k=>{k===!1?O(vr(4,{from:a,to:t})):k instanceof Error?O(k):mc(k)?O(vr(2,{from:t,to:k})):(K&&x.enterCallbacks[M]===K&&typeof k=="function"&&K.push(k),N())},w=e.call(x&&x.instances[M],t,a,v);let S=Promise.resolve(w);e.length<3&&(S=S.then(v)),S.catch(k=>O(k))})}function Vn(e,t,a,x){const M=[];for(const K of e)for(const N in K.components){let O=K.components[N];if(!(t!=="beforeRouteEnter"&&!K.instances[N]))if(Yc(O)){const w=(O.__vccOpts||O)[t];w&&M.push(Rt(w,a,x,K,N))}else{let v=O();M.push(()=>v.then(w=>{if(!w)return Promise.reject(new Error(`Couldn't resolve component "${N}" at "${K.path}"`));const S=Zf(w)?w.default:w;K.components[N]=S;const R=(S.__vccOpts||S)[t];return R&&Rt(R,a,x,K,N)()}))}}return M}function Yc(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Gs(e){const t=Oe(bn),a=Oe(Ui),x=Se(()=>t.resolve(ut(e.to))),M=Se(()=>{const{matched:v}=x.value,{length:w}=v,S=v[w-1],k=a.matched;if(!S||!k.length)return-1;const R=k.findIndex(hr.bind(null,S));if(R>-1)return R;const W=js(v[w-2]);return w>1&&js(S)===W&&k[k.length-1].path!==W?k.findIndex(hr.bind(null,v[w-2])):R}),K=Se(()=>M.value>-1&&Qc(a.params,x.value.params)),N=Se(()=>M.value>-1&&M.value===a.matched.length-1&&Eo(a.params,x.value.params));function O(v={}){return Xc(v)?t[ut(e.replace)?"replace":"push"](ut(e.to)).catch(br):Promise.resolve()}return{route:x,href:Se(()=>x.value.href),isActive:K,isExactActive:N,navigate:O}}const zc=tt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Gs,setup(e,{slots:t}){const a=Er(Gs(e)),{options:x}=Oe(bn),M=Se(()=>({[Vs(e.activeClass,x.linkActiveClass,"router-link-active")]:a.isActive,[Vs(e.exactActiveClass,x.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const K=t.default&&t.default(a);return e.custom?K:Pe("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:M.value},K)}}}),$c=zc;function Xc(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Qc(e,t){for(const a in t){const x=t[a],M=e[a];if(typeof x=="string"){if(x!==M)return!1}else if(!ft(M)||M.length!==x.length||x.some((K,N)=>K!==M[N]))return!1}return!0}function js(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Vs=(e,t,a)=>e!=null?e:t!=null?t:a,Jc=tt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:a}){const x=Oe(ci),M=Se(()=>e.route||x.value),K=Oe(Hs,0),N=Se(()=>{let w=ut(K);const{matched:S}=M.value;let k;for(;(k=S[w])&&!k.components;)w++;return w}),O=Se(()=>M.value.matched[N.value]);Xt(Hs,Se(()=>N.value+1)),Xt(Vc,O),Xt(ci,M);const v=Ue();return Tt(()=>[v.value,O.value,e.name],([w,S,k],[R,W,C])=>{S&&(S.instances[k]=w,W&&W!==S&&w&&w===R&&(S.leaveGuards.size||(S.leaveGuards=W.leaveGuards),S.updateGuards.size||(S.updateGuards=W.updateGuards))),w&&S&&(!W||!hr(S,W)||!R)&&(S.enterCallbacks[k]||[]).forEach(I=>I(w))},{flush:"post"}),()=>{const w=M.value,S=e.name,k=O.value,R=k&&k.components[S];if(!R)return Ys(a.default,{Component:R,route:w});const W=k.props[S],C=W?W===!0?w.params:typeof W=="function"?W(w):W:null,b=Pe(R,ye({},C,t,{onVnodeUnmounted:L=>{L.component.isUnmounted&&(k.instances[S]=null)},ref:v}));return Ys(a.default,{Component:b,route:w})||b}}});function Ys(e,t){if(!e)return null;const a=e(t);return a.length===1?a[0]:a}const Ro=Jc;function Zc(e){const t=Dc(e.routes,e),a=e.parseQuery||Gc,x=e.stringifyQuery||Ws,M=e.history,K=xr(),N=xr(),O=xr(),v=Da(pt);let w=pt;rr&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const S=Gn.bind(null,F=>""+F),k=Gn.bind(null,Hc),R=Gn.bind(null,gn);function W(F,H){let G,V;return To(F)?(G=t.getRecordMatcher(F),V=H):V=F,t.addRoute(V,G)}function C(F){const H=t.getRecordMatcher(F);H&&t.removeRoute(H)}function I(){return t.getRoutes().map(F=>F.record)}function b(F){return!!t.getRecordMatcher(F)}function L(F,H){if(H=ye({},H||v.value),typeof F=="string"){const j=jn(a,F,H.path),Y=t.resolve({path:j.path},H),Q=M.createHref(j.fullPath);return ye(j,Y,{params:R(Y.params),hash:gn(j.hash),redirectedFrom:void 0,href:Q})}let G;if("path"in F)G=ye({},F,{path:jn(a,F.path,H.path).path});else{const j=ye({},F.params);for(const Y in j)j[Y]==null&&delete j[Y];G=ye({},F,{params:k(F.params)}),H.params=k(H.params)}const V=t.resolve(G,H),z=F.hash||"";V.params=S(R(V.params));const $=tc(x,ye({},F,{hash:Nc(z),path:V.path})),X=M.createHref($);return ye({fullPath:$,hash:z,query:x===Ws?jc(F.query):F.query||{}},V,{redirectedFrom:void 0,href:X})}function A(F){return typeof F=="string"?jn(a,F,v.value.path):ye({},F)}function h(F,H){if(w!==F)return vr(8,{from:H,to:F})}function D(F){return f(F)}function T(F){return D(ye(A(F),{replace:!0}))}function d(F){const H=F.matched[F.matched.length-1];if(H&&H.redirect){const{redirect:G}=H;let V=typeof G=="function"?G(F):G;return typeof V=="string"&&(V=V.includes("?")||V.includes("#")?V=A(V):{path:V},V.params={}),ye({query:F.query,hash:F.hash,params:"path"in V?{}:F.params},V)}}function f(F,H){const G=w=L(F),V=v.value,z=F.state,$=F.force,X=F.replace===!0,j=d(G);if(j)return f(ye(A(j),{state:typeof j=="object"?ye({},z,j.state):z,force:$,replace:X}),H||G);const Y=G;Y.redirectedFrom=H;let Q;return!$&&rc(x,V,G)&&(Q=vr(16,{to:Y,from:V}),E(V,V,!0,!1)),(Q?Promise.resolve(Q):l(Y,V)).catch(J=>mt(J)?mt(J,2)?J:r(J):n(J,Y,V)).then(J=>{if(J){if(mt(J,2))return f(ye({replace:X},A(J.to),{state:typeof J.to=="object"?ye({},z,J.to.state):z,force:$}),H||Y)}else J=m(Y,V,!0,X,z);return p(Y,V,J),J})}function i(F,H){const G=h(F,H);return G?Promise.reject(G):Promise.resolve()}function l(F,H){let G;const[V,z,$]=qc(F,H);G=Vn(V.reverse(),"beforeRouteLeave",F,H);for(const j of V)j.leaveGuards.forEach(Y=>{G.push(Rt(Y,F,H))});const X=i.bind(null,F,H);return G.push(X),qt(G).then(()=>{G=[];for(const j of K.list())G.push(Rt(j,F,H));return G.push(X),qt(G)}).then(()=>{G=Vn(z,"beforeRouteUpdate",F,H);for(const j of z)j.updateGuards.forEach(Y=>{G.push(Rt(Y,F,H))});return G.push(X),qt(G)}).then(()=>{G=[];for(const j of F.matched)if(j.beforeEnter&&!H.matched.includes(j))if(ft(j.beforeEnter))for(const Y of j.beforeEnter)G.push(Rt(Y,F,H));else G.push(Rt(j.beforeEnter,F,H));return G.push(X),qt(G)}).then(()=>(F.matched.forEach(j=>j.enterCallbacks={}),G=Vn($,"beforeRouteEnter",F,H),G.push(X),qt(G))).then(()=>{G=[];for(const j of N.list())G.push(Rt(j,F,H));return G.push(X),qt(G)}).catch(j=>mt(j,8)?j:Promise.reject(j))}function p(F,H,G){for(const V of O.list())V(F,H,G)}function m(F,H,G,V,z){const $=h(F,H);if($)return $;const X=H===pt,j=rr?history.state:{};G&&(V||X?M.replace(F.fullPath,ye({scroll:X&&j&&j.scroll},z)):M.push(F.fullPath,z)),v.value=F,E(F,H,G,X),r()}let s;function c(){s||(s=M.listen((F,H,G)=>{if(!B.listening)return;const V=L(F),z=d(V);if(z){f(ye(z,{replace:!0}),V).catch(br);return}w=V;const $=v.value;rr&&fc(Ms($.fullPath,G.delta),In()),l(V,$).catch(X=>mt(X,12)?X:mt(X,2)?(f(X.to,V).then(j=>{mt(j,20)&&!G.delta&&G.type===Ur.pop&&M.go(-1,!1)}).catch(br),Promise.reject()):(G.delta&&M.go(-G.delta,!1),n(X,V,$))).then(X=>{X=X||m(V,$,!1),X&&(G.delta&&!mt(X,8)?M.go(-G.delta,!1):G.type===Ur.pop&&mt(X,20)&&M.go(-1,!1)),p(V,$,X)}).catch(br)}))}let _=xr(),u=xr(),o;function n(F,H,G){r(F);const V=u.list();return V.length?V.forEach(z=>z(F,H,G)):console.error(F),Promise.reject(F)}function g(){return o&&v.value!==pt?Promise.resolve():new Promise((F,H)=>{_.add([F,H])})}function r(F){return o||(o=!F,c(),_.list().forEach(([H,G])=>F?G(F):H()),_.reset()),F}function E(F,H,G,V){const{scrollBehavior:z}=e;if(!rr||!z)return Promise.resolve();const $=!G&&cc(Ms(F.fullPath,0))||(V||!G)&&history.state&&history.state.scroll||null;return Ri().then(()=>z(F,H,$)).then(X=>X&&uc(X)).catch(X=>n(X,F,H))}const P=F=>M.go(F);let y;const U=new Set,B={currentRoute:v,listening:!0,addRoute:W,removeRoute:C,hasRoute:b,getRoutes:I,resolve:L,options:e,push:D,replace:T,go:P,back:()=>P(-1),forward:()=>P(1),beforeEach:K.add,beforeResolve:N.add,afterEach:O.add,onError:u.add,isReady:g,install(F){const H=this;F.component("RouterLink",$c),F.component("RouterView",Ro),F.config.globalProperties.$router=H,Object.defineProperty(F.config.globalProperties,"$route",{enumerable:!0,get:()=>ut(v)}),rr&&!y&&v.value===pt&&(y=!0,D(M.location).catch(z=>{}));const G={};for(const z in pt)G[z]=Se(()=>v.value[z]);F.provide(bn,H),F.provide(Ui,Er(G)),F.provide(ci,v);const V=F.unmount;U.add(F),F.unmount=function(){U.delete(F),U.size<1&&(w=pt,s&&s(),s=null,v.value=pt,y=!1,o=!1),V()}}};return B}function qt(e){return e.reduce((t,a)=>t.then(()=>a()),Promise.resolve())}function qc(e,t){const a=[],x=[],M=[],K=Math.max(t.matched.length,e.matched.length);for(let N=0;N<K;N++){const O=t.matched[N];O&&(e.matched.find(w=>hr(w,O))?x.push(O):a.push(O));const v=e.matched[N];v&&(t.matched.find(w=>hr(w,v))||M.push(v))}return[a,x,M]}function Bi(){return Oe(bn)}function Ni(){return Oe(Ui)}const ed=({headerLinkSelector:e,headerAnchorSelector:t,delay:a,offset:x=5})=>{const M=Bi(),K=Wr(),O=po(()=>{var b,L,A,h;const v=Math.max(window.scrollY,document.documentElement.scrollTop,document.body.scrollTop);if(Math.abs(v-0)<x){zs(M,{hash:"",force:!0});return}const S=window.innerHeight+v,k=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),R=Math.abs(k-S)<x,W=Array.from(document.querySelectorAll(e)),I=Array.from(document.querySelectorAll(t)).filter(D=>W.some(T=>T.hash===D.hash));for(let D=0;D<I.length;D++){const T=I[D],d=I[D+1],f=v>=((L=(b=T.parentElement)==null?void 0:b.offsetTop)!=null?L:0)-x,i=!d||v<((h=(A=d.parentElement)==null?void 0:A.offsetTop)!=null?h:0)-x;if(!(f&&i))continue;const p=decodeURIComponent(M.currentRoute.value.hash),m=decodeURIComponent(T.hash);if(p===m)return;if(R){for(let s=D+1;s<I.length;s++)if(p===decodeURIComponent(I[s].hash))return}zs(M,{hash:m,force:!0});return}},a);Ft(()=>{O(),window.addEventListener("scroll",O)}),Ii(()=>{window.removeEventListener("scroll",O)}),Tt(()=>K.value.path,O)},zs=async(e,...t)=>{const{scrollBehavior:a}=e.options;e.options.scrollBehavior=void 0,await e.replace(...t).finally(()=>e.options.scrollBehavior=a)},td="a.sidebar-item",rd=".header-anchor",nd=300,id=5;var sd=kt({setup(){ed({headerLinkSelector:td,headerAnchorSelector:rd,delay:nd,offset:id})}});const $s=()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,ad=()=>window.scrollTo({top:0,behavior:"smooth"});const od=tt({name:"BackToTop",setup(){const e=Ue(0),t=Se(()=>e.value>300),a=po(()=>{e.value=$s()},100);Ft(()=>{e.value=$s(),window.addEventListener("scroll",()=>a())});const x=Pe("div",{class:"back-to-top",onClick:ad});return()=>Pe(wi,{name:"back-to-top"},()=>t.value?x:null)}});var ld=kt({rootComponents:[od]});const ud=Pe("svg",{class:"external-link-icon",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"},[Pe("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),Pe("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]),fd=tt({name:"ExternalLinkIcon",props:{locales:{type:Object,required:!1,default:()=>({})}},setup(e){const t=Yf(),a=Se(()=>{var x;return(x=e.locales[t.value])!=null?x:{openInNewWindow:"open in new window"}});return()=>Pe("span",[ud,Pe("span",{class:"external-link-icon-sr-only"},a.value.openInNewWindow)])}}),cd={"/":{openInNewWindow:"open in new window"}};var dd=kt({enhance({app:e}){e.component("ExternalLinkIcon",Pe(fd,{locales:cd}))}});/*! medium-zoom 1.0.8 | MIT License | https://github.com/francoischalifour/medium-zoom */var Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var x in a)Object.prototype.hasOwnProperty.call(a,x)&&(e[x]=a[x])}return e},en=function(t){return t.tagName==="IMG"},hd=function(t){return NodeList.prototype.isPrototypeOf(t)},sn=function(t){return t&&t.nodeType===1},Xs=function(t){var a=t.currentSrc||t.src;return a.substr(-4).toLowerCase()===".svg"},Qs=function(t){try{return Array.isArray(t)?t.filter(en):hd(t)?[].slice.call(t).filter(en):sn(t)?[t].filter(en):typeof t=="string"?[].slice.call(document.querySelectorAll(t)).filter(en):[]}catch{throw new TypeError(`The provided selector is invalid.
Expects a CSS selector, a Node element, a NodeList or an array.
See: https://github.com/francoischalifour/medium-zoom`)}},vd=function(t){var a=document.createElement("div");return a.classList.add("medium-zoom-overlay"),a.style.background=t,a},gd=function(t){var a=t.getBoundingClientRect(),x=a.top,M=a.left,K=a.width,N=a.height,O=t.cloneNode(),v=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,w=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return O.removeAttribute("id"),O.style.position="absolute",O.style.top=x+v+"px",O.style.left=M+w+"px",O.style.width=K+"px",O.style.height=N+"px",O.style.transform="",O},er=function(t,a){var x=Gt({bubbles:!1,cancelable:!1,detail:void 0},a);if(typeof window.CustomEvent=="function")return new CustomEvent(t,x);var M=document.createEvent("CustomEvent");return M.initCustomEvent(t,x.bubbles,x.cancelable,x.detail),M},md=function e(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=window.Promise||function(s){function c(){}s(c,c)},M=function(s){var c=s.target;if(c===l){C();return}h.indexOf(c)!==-1&&I({target:c})},K=function(){if(!(T||!i.original)){var s=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(d-s)>f.scrollOffset&&setTimeout(C,150)}},N=function(s){var c=s.key||s.keyCode;(c==="Escape"||c==="Esc"||c===27)&&C()},O=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=s;if(s.background&&(l.style.background=s.background),s.container&&s.container instanceof Object&&(c.container=Gt({},f.container,s.container)),s.template){var _=sn(s.template)?s.template:document.querySelector(s.template);c.template=_}return f=Gt({},f,c),h.forEach(function(u){u.dispatchEvent(er("medium-zoom:update",{detail:{zoom:p}}))}),p},v=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e(Gt({},f,s))},w=function(){for(var s=arguments.length,c=Array(s),_=0;_<s;_++)c[_]=arguments[_];var u=c.reduce(function(o,n){return[].concat(o,Qs(n))},[]);return u.filter(function(o){return h.indexOf(o)===-1}).forEach(function(o){h.push(o),o.classList.add("medium-zoom-image")}),D.forEach(function(o){var n=o.type,g=o.listener,r=o.options;u.forEach(function(E){E.addEventListener(n,g,r)})}),p},S=function(){for(var s=arguments.length,c=Array(s),_=0;_<s;_++)c[_]=arguments[_];i.zoomed&&C();var u=c.length>0?c.reduce(function(o,n){return[].concat(o,Qs(n))},[]):h;return u.forEach(function(o){o.classList.remove("medium-zoom-image"),o.dispatchEvent(er("medium-zoom:detach",{detail:{zoom:p}}))}),h=h.filter(function(o){return u.indexOf(o)===-1}),p},k=function(s,c){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return h.forEach(function(u){u.addEventListener("medium-zoom:"+s,c,_)}),D.push({type:"medium-zoom:"+s,listener:c,options:_}),p},R=function(s,c){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return h.forEach(function(u){u.removeEventListener("medium-zoom:"+s,c,_)}),D=D.filter(function(u){return!(u.type==="medium-zoom:"+s&&u.listener.toString()===c.toString())}),p},W=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=s.target,_=function(){var o={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},n=void 0,g=void 0;if(f.container)if(f.container instanceof Object)o=Gt({},o,f.container),n=o.width-o.left-o.right-f.margin*2,g=o.height-o.top-o.bottom-f.margin*2;else{var r=sn(f.container)?f.container:document.querySelector(f.container),E=r.getBoundingClientRect(),P=E.width,y=E.height,U=E.left,B=E.top;o=Gt({},o,{width:P,height:y,left:U,top:B})}n=n||o.width-f.margin*2,g=g||o.height-f.margin*2;var F=i.zoomedHd||i.original,H=Xs(F)?n:F.naturalWidth||n,G=Xs(F)?g:F.naturalHeight||g,V=F.getBoundingClientRect(),z=V.top,$=V.left,X=V.width,j=V.height,Y=Math.min(Math.max(X,H),n)/X,Q=Math.min(Math.max(j,G),g)/j,J=Math.min(Y,Q),Z=(-$+(n-X)/2+f.margin+o.left)/J,ee=(-z+(g-j)/2+f.margin+o.top)/J,ne="scale("+J+") translate3d("+Z+"px, "+ee+"px, 0)";i.zoomed.style.transform=ne,i.zoomedHd&&(i.zoomedHd.style.transform=ne)};return new x(function(u){if(c&&h.indexOf(c)===-1){u(p);return}var o=function P(){T=!1,i.zoomed.removeEventListener("transitionend",P),i.original.dispatchEvent(er("medium-zoom:opened",{detail:{zoom:p}})),u(p)};if(i.zoomed){u(p);return}if(c)i.original=c;else if(h.length>0){var n=h;i.original=n[0]}else{u(p);return}if(i.original.dispatchEvent(er("medium-zoom:open",{detail:{zoom:p}})),d=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,T=!0,i.zoomed=gd(i.original),document.body.appendChild(l),f.template){var g=sn(f.template)?f.template:document.querySelector(f.template);i.template=document.createElement("div"),i.template.appendChild(g.content.cloneNode(!0)),document.body.appendChild(i.template)}if(i.original.parentElement&&i.original.parentElement.tagName==="PICTURE"&&i.original.currentSrc&&(i.zoomed.src=i.original.currentSrc),document.body.appendChild(i.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),i.original.classList.add("medium-zoom-image--hidden"),i.zoomed.classList.add("medium-zoom-image--opened"),i.zoomed.addEventListener("click",C),i.zoomed.addEventListener("transitionend",o),i.original.getAttribute("data-zoom-src")){i.zoomedHd=i.zoomed.cloneNode(),i.zoomedHd.removeAttribute("srcset"),i.zoomedHd.removeAttribute("sizes"),i.zoomedHd.removeAttribute("loading"),i.zoomedHd.src=i.zoomed.getAttribute("data-zoom-src"),i.zoomedHd.onerror=function(){clearInterval(r),console.warn("Unable to reach the zoom image target "+i.zoomedHd.src),i.zoomedHd=null,_()};var r=setInterval(function(){i.zoomedHd.complete&&(clearInterval(r),i.zoomedHd.classList.add("medium-zoom-image--opened"),i.zoomedHd.addEventListener("click",C),document.body.appendChild(i.zoomedHd),_())},10)}else if(i.original.hasAttribute("srcset")){i.zoomedHd=i.zoomed.cloneNode(),i.zoomedHd.removeAttribute("sizes"),i.zoomedHd.removeAttribute("loading");var E=i.zoomedHd.addEventListener("load",function(){i.zoomedHd.removeEventListener("load",E),i.zoomedHd.classList.add("medium-zoom-image--opened"),i.zoomedHd.addEventListener("click",C),document.body.appendChild(i.zoomedHd),_()})}else _()})},C=function(){return new x(function(s){if(T||!i.original){s(p);return}var c=function _(){i.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(i.zoomed),i.zoomedHd&&document.body.removeChild(i.zoomedHd),document.body.removeChild(l),i.zoomed.classList.remove("medium-zoom-image--opened"),i.template&&document.body.removeChild(i.template),T=!1,i.zoomed.removeEventListener("transitionend",_),i.original.dispatchEvent(er("medium-zoom:closed",{detail:{zoom:p}})),i.original=null,i.zoomed=null,i.zoomedHd=null,i.template=null,s(p)};T=!0,document.body.classList.remove("medium-zoom--opened"),i.zoomed.style.transform="",i.zoomedHd&&(i.zoomedHd.style.transform=""),i.template&&(i.template.style.transition="opacity 150ms",i.template.style.opacity=0),i.original.dispatchEvent(er("medium-zoom:close",{detail:{zoom:p}})),i.zoomed.addEventListener("transitionend",c)})},I=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=s.target;return i.original?C():W({target:c})},b=function(){return f},L=function(){return h},A=function(){return i.original},h=[],D=[],T=!1,d=0,f=a,i={original:null,zoomed:null,zoomedHd:null,template:null};Object.prototype.toString.call(t)==="[object Object]"?f=t:(t||typeof t=="string")&&w(t),f=Gt({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},f);var l=vd(f.background);document.addEventListener("click",M),document.addEventListener("keyup",N),document.addEventListener("scroll",K),window.addEventListener("resize",C);var p={open:W,close:C,toggle:I,update:O,clone:v,attach:w,detach:S,on:k,off:R,getOptions:b,getImages:L,getZoomedImage:A};return p};function pd(e,t){t===void 0&&(t={});var a=t.insertAt;if(!(!e||typeof document=="undefined")){var x=document.head||document.getElementsByTagName("head")[0],M=document.createElement("style");M.type="text/css",a==="top"&&x.firstChild?x.insertBefore(M,x.firstChild):x.appendChild(M),M.styleSheet?M.styleSheet.cssText=e:M.appendChild(document.createTextNode(e))}}var Ed=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}";pd(Ed);var yd=md;const Td=Symbol("mediumZoom");const _d=".theme-default-content > img, .theme-default-content :not(a) > img",Sd={},xd=300;var Ld=kt({enhance({app:e,router:t}){const a=yd(Sd);a.refresh=(x=_d)=>{a.detach(),a.attach(x)},e.provide(Td,a),t.afterEach(()=>{setTimeout(()=>a.refresh(),xd)})}});/**
 * NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT
 */const ge={settings:{minimum:.08,easing:"ease",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,barSelector:'[role="bar"]',parent:"body",template:'<div class="bar" role="bar"></div>'},status:null,set:e=>{const t=ge.isStarted();e=Yn(e,ge.settings.minimum,1),ge.status=e===1?null:e;const a=ge.render(!t),x=a.querySelector(ge.settings.barSelector),M=ge.settings.speed,K=ge.settings.easing;return a.offsetWidth,Ad(N=>{tn(x,{transform:"translate3d("+Js(e)+"%,0,0)",transition:"all "+M+"ms "+K}),e===1?(tn(a,{transition:"none",opacity:"1"}),a.offsetWidth,setTimeout(function(){tn(a,{transition:"all "+M+"ms linear",opacity:"0"}),setTimeout(function(){ge.remove(),N()},M)},M)):setTimeout(()=>N(),M)}),ge},isStarted:()=>typeof ge.status=="number",start:()=>{ge.status||ge.set(0);const e=()=>{setTimeout(()=>{!ge.status||(ge.trickle(),e())},ge.settings.trickleSpeed)};return ge.settings.trickle&&e(),ge},done:e=>!e&&!ge.status?ge:ge.inc(.3+.5*Math.random()).set(1),inc:e=>{let t=ge.status;return t?(typeof e!="number"&&(e=(1-t)*Yn(Math.random()*t,.1,.95)),t=Yn(t+e,0,.994),ge.set(t)):ge.start()},trickle:()=>ge.inc(Math.random()*ge.settings.trickleRate),render:e=>{if(ge.isRendered())return document.getElementById("nprogress");Zs(document.documentElement,"nprogress-busy");const t=document.createElement("div");t.id="nprogress",t.innerHTML=ge.settings.template;const a=t.querySelector(ge.settings.barSelector),x=e?"-100":Js(ge.status||0),M=document.querySelector(ge.settings.parent);return tn(a,{transition:"all 0 linear",transform:"translate3d("+x+"%,0,0)"}),M!==document.body&&Zs(M,"nprogress-custom-parent"),M==null||M.appendChild(t),t},remove:()=>{qs(document.documentElement,"nprogress-busy"),qs(document.querySelector(ge.settings.parent),"nprogress-custom-parent");const e=document.getElementById("nprogress");e&&Dd(e)},isRendered:()=>!!document.getElementById("nprogress")},Yn=(e,t,a)=>e<t?t:e>a?a:e,Js=e=>(-1+e)*100,Ad=function(){const e=[];function t(){const a=e.shift();a&&a(t)}return function(a){e.push(a),e.length===1&&t()}}(),tn=function(){const e=["Webkit","O","Moz","ms"],t={};function a(N){return N.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(O,v){return v.toUpperCase()})}function x(N){const O=document.body.style;if(N in O)return N;let v=e.length;const w=N.charAt(0).toUpperCase()+N.slice(1);let S;for(;v--;)if(S=e[v]+w,S in O)return S;return N}function M(N){return N=a(N),t[N]||(t[N]=x(N))}function K(N,O,v){O=M(O),N.style[O]=v}return function(N,O){for(const v in O){const w=O[v];w!==void 0&&Object.prototype.hasOwnProperty.call(O,v)&&K(N,v,w)}}}(),Io=(e,t)=>(typeof e=="string"?e:Ki(e)).indexOf(" "+t+" ")>=0,Zs=(e,t)=>{const a=Ki(e),x=a+t;Io(a,t)||(e.className=x.substring(1))},qs=(e,t)=>{const a=Ki(e);if(!Io(e,t))return;const x=a.replace(" "+t+" "," ");e.className=x.substring(1,x.length-1)},Ki=e=>(" "+(e.className||"")+" ").replace(/\s+/gi," "),Dd=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)};const Pd=()=>{Ft(()=>{const e=Bi(),t=new Set;t.add(e.currentRoute.value.path),e.beforeEach(a=>{t.has(a.path)||ge.start()}),e.afterEach(a=>{t.add(a.path),ge.done()})})};var Rd=kt({setup(){Pd()}});const Id=JSON.parse(`{"repo":"https://github.com/magikcypress/personal-root-live-vuepress-next/","editLink":true,"docsDir":"docs/","editLinkText":"Edit on Github","lastUpdated":true,"sidebar":false,"locales":{"/":{"selectLanguageName":"English"}},"colorMode":"auto","colorModeSwitch":true,"navbar":[],"logo":null,"selectLanguageText":"Languages","selectLanguageAriaLabel":"Select language","sidebarDepth":2,"lastUpdatedText":"Last Updated","contributors":true,"contributorsText":"Contributors","notFound":["There's nothing here.","How did we get here?","That's a Four-Oh-Four.","Looks like we've got some broken links."],"backToHome":"Take me home","openInNewWindow":"open in new window","toggleColorMode":"toggle color mode","toggleSidebar":"toggle sidebar"}`),bo=Ue(Id),bd=()=>bo;Hi.webpackHot&&(__VUE_HMR_RUNTIME__.updateThemeData=e=>{bo.value=e});const Co=Symbol(""),Cd=()=>{const e=Oe(Co);if(!e)throw new Error("useThemeLocaleData() is called without provider.");return e},Od=(e,t)=>{var a;return{...e,...(a=e.locales)==null?void 0:a[t]}};var Md=kt({enhance({app:e}){const t=bd(),a=e._context.provides[Fi],x=Se(()=>Od(t.value,a.value));e.provide(Co,x),Object.defineProperties(e.config.globalProperties,{$theme:{get(){return t.value}},$themeLocale:{get(){return x.value}}})}}),yr=(e,t)=>{const a=e.__vccOpts||e;for(const[x,M]of t)a[x]=M;return a};const wd=tt({__name:"Badge",props:{type:{type:String,required:!1,default:"tip"},text:{type:String,required:!1,default:""},vertical:{type:String,required:!1,default:void 0}},setup(e){return(t,a)=>(vt(),Ot("span",{class:gr(["badge",e.type]),style:En({verticalAlign:e.vertical})},[ja(t.$slots,"default",{},()=>[Pn(sa(e.text),1)])],6))}});var Fd=yr(wd,[["__file","Badge.vue"]]);const kd=tt({name:"CodeGroup",setup(e,{slots:t}){const a=Ue(-1),x=Ue([]),M=(O=a.value)=>{O<x.value.length-1?a.value=O+1:a.value=0,x.value[a.value].focus()},K=(O=a.value)=>{O>0?a.value=O-1:a.value=x.value.length-1,x.value[a.value].focus()},N=(O,v)=>{O.key===" "||O.key==="Enter"?(O.preventDefault(),a.value=v):O.key==="ArrowRight"?(O.preventDefault(),M(v)):O.key==="ArrowLeft"&&(O.preventDefault(),K(v))};return()=>{var v;const O=(((v=t.default)==null?void 0:v.call(t))||[]).filter(w=>w.type.name==="CodeGroupItem").map(w=>(w.props===null&&(w.props={}),w));return O.length===0?null:(a.value<0||a.value>O.length-1?(a.value=O.findIndex(w=>w.props.active===""||w.props.active===!0),a.value===-1&&(a.value=0)):O.forEach((w,S)=>{w.props.active=S===a.value}),Pe("div",{class:"code-group"},[Pe("div",{class:"code-group__nav"},Pe("ul",{class:"code-group__ul"},O.map((w,S)=>{const k=S===a.value;return Pe("li",{class:"code-group__li"},Pe("button",{ref:R=>{R&&(x.value[S]=R)},class:{"code-group__nav-tab":!0,"code-group__nav-tab-active":k},ariaPressed:k,ariaExpanded:k,onClick:()=>a.value=S,onKeydown:R=>N(R,S)},w.props.title))}))),O]))}}}),Ud=["aria-selected"],Bd=tt({name:"CodeGroupItem"}),Nd=tt({...Bd,props:{title:{type:String,required:!0},active:{type:Boolean,required:!1,default:!1}},setup(e){return(t,a)=>(vt(),Ot("div",{class:gr(["code-group-item",{"code-group-item__active":e.active}]),"aria-selected":e.active},[ja(t.$slots,"default")],10,Ud))}});var Kd=yr(Nd,[["__file","CodeGroupItem.vue"]]),ea;const Hr=typeof window!="undefined",Wd=e=>typeof e=="string",zn=()=>{};Hr&&((ea=window==null?void 0:window.navigator)==null?void 0:ea.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Hd(e,t){function a(...x){e(()=>t.apply(this,x),{fn:t,thisArg:this,args:x})}return a}const Oo=e=>e();function Gd(e=Oo){const t=Ue(!0);function a(){t.value=!1}function x(){t.value=!0}return{isActive:t,pause:a,resume:x,eventFilter:(...K)=>{t.value&&e(...K)}}}function Mo(e){return ca()?(pl(e),!0):!1}function jd(e,t=!0){no()?Ha(e):t?e():Ri(e)}function xv(e=!1,t={}){const{truthyValue:a=!0,falsyValue:x=!1}=t,M=Me(e),K=Ue(e);function N(O){return arguments.length?(K.value=O,K.value):(K.value=K.value===ut(a)?ut(x):ut(a),K.value)}return M?N:[K,N]}var ta=Object.getOwnPropertySymbols,Vd=Object.prototype.hasOwnProperty,Yd=Object.prototype.propertyIsEnumerable,zd=(e,t)=>{var a={};for(var x in e)Vd.call(e,x)&&t.indexOf(x)<0&&(a[x]=e[x]);if(e!=null&&ta)for(var x of ta(e))t.indexOf(x)<0&&Yd.call(e,x)&&(a[x]=e[x]);return a};function $d(e,t,a={}){const x=a,{eventFilter:M=Oo}=x,K=zd(x,["eventFilter"]);return Tt(e,Hd(M,t),K)}var Xd=Object.defineProperty,Qd=Object.defineProperties,Jd=Object.getOwnPropertyDescriptors,mn=Object.getOwnPropertySymbols,wo=Object.prototype.hasOwnProperty,Fo=Object.prototype.propertyIsEnumerable,ra=(e,t,a)=>t in e?Xd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Zd=(e,t)=>{for(var a in t||(t={}))wo.call(t,a)&&ra(e,a,t[a]);if(mn)for(var a of mn(t))Fo.call(t,a)&&ra(e,a,t[a]);return e},qd=(e,t)=>Qd(e,Jd(t)),eh=(e,t)=>{var a={};for(var x in e)wo.call(e,x)&&t.indexOf(x)<0&&(a[x]=e[x]);if(e!=null&&mn)for(var x of mn(e))t.indexOf(x)<0&&Fo.call(e,x)&&(a[x]=e[x]);return a};function th(e,t,a={}){const x=a,{eventFilter:M}=x,K=eh(x,["eventFilter"]),{eventFilter:N,pause:O,resume:v,isActive:w}=Gd(M);return{stop:$d(e,t,qd(Zd({},K),{eventFilter:N})),pause:O,resume:v,isActive:w}}function rh(e){var t;const a=ut(e);return(t=a==null?void 0:a.$el)!=null?t:a}const pn=Hr?window:void 0;Hr&&window.document;Hr&&window.navigator;Hr&&window.location;function nh(...e){let t,a,x,M;if(Wd(e[0])?([a,x,M]=e,t=pn):[t,a,x,M]=e,!t)return zn;let K=zn;const N=Tt(()=>rh(t),v=>{K(),v&&(v.addEventListener(a,x,M),K=()=>{v.removeEventListener(a,x,M),K=zn})},{immediate:!0,flush:"post"}),O=()=>{N(),K()};return Mo(O),O}function ih(e,t={}){const{window:a=pn}=t,x=Boolean(a&&"matchMedia"in a&&typeof a.matchMedia=="function");let M;const K=Ue(!1),N=()=>{!x||(M||(M=a.matchMedia(e)),K.value=M.matches)};return jd(()=>{N(),M&&("addEventListener"in M?M.addEventListener("change",N):M.addListener(N),Mo(()=>{"removeEventListener"in M?M.removeEventListener("change",N):M.removeListener(N)}))}),K}const di=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},hi="__vueuse_ssr_handlers__";di[hi]=di[hi]||{};const sh=di[hi];function ah(e,t){return sh[e]||t}function oh(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}const lh={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function uh(e,t,a,x={}){var M;const{flush:K="pre",deep:N=!0,listenToStorageChanges:O=!0,writeDefaults:v=!0,shallow:w,window:S=pn,eventFilter:k,onError:R=d=>{console.error(d)}}=x,W=(w?Da:Ue)(t);if(!a)try{a=ah("getDefaultStorage",()=>{var d;return(d=pn)==null?void 0:d.localStorage})()}catch(d){R(d)}if(!a)return W;const C=ut(t),I=oh(C),b=(M=x.serializer)!=null?M:lh[I],{pause:L,resume:A}=th(W,()=>h(W.value),{flush:K,deep:N,eventFilter:k});return S&&O&&nh(S,"storage",T),T(),W;function h(d){try{d==null?a.removeItem(e):a.setItem(e,b.write(d))}catch(f){R(f)}}function D(d){if(!(d&&d.key!==e)){L();try{const f=d?d.newValue:a.getItem(e);return f==null?(v&&C!==null&&a.setItem(e,b.write(C)),C):typeof f!="string"?f:b.read(f)}catch(f){R(f)}finally{A()}}}function T(d){d&&d.key!==e||(W.value=D(d))}}function fh(e){return ih("(prefers-color-scheme: dark)",e)}var na;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(na||(na={}));const ko=Symbol(""),Lv=()=>{const e=Oe(ko);if(!e)throw new Error("useDarkMode() is called without provider.");return e},ch=()=>{const e=Ko(),t=fh(),a=uh("vuepress-color-scheme",e.value.colorMode),x=Se({get(){return e.value.colorModeSwitch?a.value==="auto"?t.value:a.value==="dark":e.value.colorMode==="dark"},set(M){M===t.value?a.value="auto":a.value=M?"dark":"light"}});Xt(ko,x),dh(x)},dh=e=>{const t=(a=e.value)=>{const x=window==null?void 0:window.document.querySelector("html");x==null||x.classList.toggle("dark",a)};Ft(()=>{Tt(e,t,{immediate:!0})}),bi(()=>t())},Uo=(...e)=>{const a=Bi().resolve(...e),x=a.matched[a.matched.length-1];if(!(x!=null&&x.redirect))return a;const{redirect:M}=x,K=he(M)?M(a):M,N=Te(K)?{path:K}:K;return Uo({hash:a.hash,query:a.query,params:a.params,...N})},hh=e=>{const t=Uo(encodeURI(e));return{text:t.meta.title||e,link:t.name==="404"?e:t.fullPath}};let $n=null,Lr=null;const vh={wait:()=>$n,pending:()=>{$n=new Promise(e=>Lr=e)},resolve:()=>{Lr==null||Lr(),$n=null,Lr=null}},gh=()=>vh,Bo=Symbol("sidebarItems"),Av=()=>{const e=Oe(Bo);if(!e)throw new Error("useSidebarItems() is called without provider.");return e},mh=()=>{const e=Ko(),t=Hf(),a=Se(()=>ph(t.value,e.value));Xt(Bo,a)},ph=(e,t)=>{var M,K,N,O;const a=(K=(M=e.sidebar)!=null?M:t.sidebar)!=null?K:"auto",x=(O=(N=e.sidebarDepth)!=null?N:t.sidebarDepth)!=null?O:2;return e.home||a===!1?[]:a==="auto"?yh(x):ce(a)?No(a,x):oo(a)?Th(a,x):[]},Eh=(e,t)=>({text:e.title,link:`#${e.slug}`,children:Wi(e.children,t)}),Wi=(e,t)=>t>0?e.map(a=>Eh(a,t-1)):[],yh=e=>{const t=Wr();return[{text:t.value.title,children:Wi(t.value.headers,e)}]},No=(e,t)=>{const a=Ni(),x=Wr(),M=K=>{var O;let N;if(Te(K)?N=hh(K):N=K,N.children)return{...N,children:N.children.map(v=>M(v))};if(N.link===a.path){const v=((O=x.value.headers[0])==null?void 0:O.level)===1?x.value.headers[0].children:x.value.headers;return{...N,children:Wi(v,t)}}return N};return e.map(K=>M(K))},Th=(e,t)=>{var K;const a=Ni(),x=lo(e,a.path),M=(K=e[x])!=null?K:[];return No(M,t)},Ko=()=>Cd();var _h=kt({enhance({app:e,router:t}){e.component("Badge",Fd),e.component("CodeGroup",kd),e.component("CodeGroupItem",Kd),e.component("AutoLinkExternalIcon",()=>{const x=e.component("ExternalLinkIcon");return x?Pe(x):null}),e.component("NavbarSearch",()=>{const x=e.component("Docsearch")||e.component("SearchBox");return x?Pe(x):null});const a=t.options.scrollBehavior;t.options.scrollBehavior=async(...x)=>(await gh().wait(),a(...x))},setup(){ch(),mh()}});const Sh={},xh={class:"theme-container no-sidebar"},Lh=Yu('<div class="theme-default-content"><div class="page-meta"><p><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Licence Creative Commons" style="border-width:0;" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png"></a> This work is made available under the terms of the <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a></p></div></div>',1),Ah=[Lh];function Dh(e,t){return vt(),Ot("div",xh,Ah)}var Ph=yr(Sh,[["render",Dh],["__file","Footer.vue"]]),Rh=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ih(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wo={exports:{}};(function(e,t){typeof window!="undefined"&&function(x,M){e.exports=M()}(Rh,()=>(()=>{var a={"./src/config.ts":(N,O,v)=>{v.r(O),v.d(O,{enableStreamingMode:()=>g,hlsDefaultConfig:()=>u,mergeConfig:()=>n});var w=v("./src/controller/abr-controller.ts"),S=v("./src/controller/audio-stream-controller.ts"),k=v("./src/controller/audio-track-controller.ts"),R=v("./src/controller/subtitle-stream-controller.ts"),W=v("./src/controller/subtitle-track-controller.ts"),C=v("./src/controller/buffer-controller.ts"),I=v("./src/controller/timeline-controller.ts"),b=v("./src/controller/cap-level-controller.ts"),L=v("./src/controller/fps-controller.ts"),A=v("./src/controller/eme-controller.ts"),h=v("./src/controller/cmcd-controller.ts"),D=v("./src/utils/xhr-loader.ts"),T=v("./src/utils/fetch-loader.ts"),d=v("./src/utils/cues.ts"),f=v("./src/utils/mediakeys-helper.ts"),i=v("./src/utils/logger.ts");function l(){return l=Object.assign?Object.assign.bind():function(r){for(var E=1;E<arguments.length;E++){var P=arguments[E];for(var y in P)Object.prototype.hasOwnProperty.call(P,y)&&(r[y]=P[y])}return r},l.apply(this,arguments)}function p(r,E){var P=Object.keys(r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(r);E&&(y=y.filter(function(U){return Object.getOwnPropertyDescriptor(r,U).enumerable})),P.push.apply(P,y)}return P}function m(r){for(var E=1;E<arguments.length;E++){var P=arguments[E]!=null?arguments[E]:{};E%2?p(Object(P),!0).forEach(function(y){s(r,y,P[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(P)):p(Object(P)).forEach(function(y){Object.defineProperty(r,y,Object.getOwnPropertyDescriptor(P,y))})}return r}function s(r,E,P){return E=c(E),E in r?Object.defineProperty(r,E,{value:P,enumerable:!0,configurable:!0,writable:!0}):r[E]=P,r}function c(r){var E=_(r,"string");return typeof E=="symbol"?E:String(E)}function _(r,E){if(typeof r!="object"||r===null)return r;var P=r[Symbol.toPrimitive];if(P!==void 0){var y=P.call(r,E||"default");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(r)}var u=m(m({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:D.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:w.default,bufferController:C.default,capLevelController:b.default,fpsController:L.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:f.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},o()),{},{subtitleStreamController:R.SubtitleStreamController,subtitleTrackController:W.default,timelineController:I.TimelineController,audioStreamController:S.default,audioTrackController:k.default,emeController:A.default,cmcdController:h.default});function o(){return{cueHandler:d.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function n(r,E){if((E.liveSyncDurationCount||E.liveMaxLatencyDurationCount)&&(E.liveSyncDuration||E.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(E.liveMaxLatencyDurationCount!==void 0&&(E.liveSyncDurationCount===void 0||E.liveMaxLatencyDurationCount<=E.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(E.liveMaxLatencyDuration!==void 0&&(E.liveSyncDuration===void 0||E.liveMaxLatencyDuration<=E.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return l({},r,E)}function g(r){var E=r.loader;if(E!==T.default&&E!==D.default)i.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1;else{var P=(0,T.fetchSupported)();P&&(r.loader=T.default,r.progressive=!0,r.enableSoftwareAES=!0,i.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>D});var w=v("./src/polyfills/number.ts"),S=v("./src/utils/ewma-bandwidth-estimator.ts"),k=v("./src/events.ts"),R=v("./src/errors.ts"),W=v("./src/types/loader.ts"),C=v("./src/utils/logger.ts");function I(T,d){for(var f=0;f<d.length;f++){var i=d[f];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(T,L(i.key),i)}}function b(T,d,f){return d&&I(T.prototype,d),f&&I(T,f),Object.defineProperty(T,"prototype",{writable:!1}),T}function L(T){var d=A(T,"string");return typeof d=="symbol"?d:String(d)}function A(T,d){if(typeof T!="object"||T===null)return T;var f=T[Symbol.toPrimitive];if(f!==void 0){var i=f.call(T,d||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(T)}var h=function(){function T(f){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=f;var i=f.config;this.bwEstimator=new S.default(i.abrEwmaSlowVoD,i.abrEwmaFastVoD,i.abrEwmaDefaultEstimate),this.registerListeners()}var d=T.prototype;return d.registerListeners=function(){var i=this.hls;i.on(k.Events.FRAG_LOADING,this.onFragLoading,this),i.on(k.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(k.Events.FRAG_BUFFERED,this.onFragBuffered,this),i.on(k.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(k.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var i=this.hls;i.off(k.Events.FRAG_LOADING,this.onFragLoading,this),i.off(k.Events.FRAG_LOADED,this.onFragLoaded,this),i.off(k.Events.FRAG_BUFFERED,this.onFragBuffered,this),i.off(k.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(k.Events.ERROR,this.onError,this)},d.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},d.onFragLoading=function(i,l){var p=l.frag;if(p.type===W.PlaylistLevelType.MAIN&&!this.timer){var m;this.fragCurrent=p,this.partCurrent=(m=l.part)!=null?m:null,this.timer=self.setInterval(this.onCheck,100)}},d.onLevelLoaded=function(i,l){var p=this.hls.config;l.details.live?this.bwEstimator.update(p.abrEwmaSlowLive,p.abrEwmaFastLive):this.bwEstimator.update(p.abrEwmaSlowVoD,p.abrEwmaFastVoD)},d._abandonRulesCheck=function(){var i=this.fragCurrent,l=this.partCurrent,p=this.hls,m=p.autoLevelEnabled,s=p.media;if(!(!i||!s)){var c=l?l.stats:i.stats,_=l?l.duration:i.duration;if(c.aborted||c.loaded&&c.loaded===c.total||i.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!m||s.paused||!s.playbackRate||!s.readyState)){var u=p.mainForwardBufferInfo;if(u!==null){var o=performance.now()-c.loading.start,n=Math.abs(s.playbackRate);if(!(o<=500*_/n)){var g=c.loaded&&c.loading.first,r=this.bwEstimator.getEstimate(),E=p.levels,P=p.minAutoLevel,y=E[i.level],U=c.total||Math.max(c.loaded,Math.round(_*y.maxBitrate/8)),B=g?c.loaded*1e3/o:0,F=B?(U-c.loaded)/B:U*8/r,H=u.len/n;if(!(F<=H)){var G=Number.POSITIVE_INFINITY,V;for(V=i.level-1;V>P;V--){var z=E[V].maxBitrate;if(G=B?_*z/(8*.8*B):_*z/r,G<H)break}G>=F||(C.logger.warn("Fragment "+i.sn+(l?" part "+l.index:"")+" of level "+i.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+V+`
      Current BW estimate: `+((0,w.isFiniteNumber)(r)?(r/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+F.toFixed(3)+` s
      Estimated load time for the next fragment: `+G.toFixed(3)+` s
      Time to underbuffer: `+H.toFixed(3)+" s"),p.nextLoadLevel=V,g&&this.bwEstimator.sample(o,c.loaded),this.clearTimer(),(i.loader||i.keyLoader)&&(this.fragCurrent=this.partCurrent=null,i.abortRequests()),p.trigger(k.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:l,stats:c}))}}}}}},d.onFragLoaded=function(i,l){var p=l.frag,m=l.part;if(p.type===W.PlaylistLevelType.MAIN&&(0,w.isFiniteNumber)(p.sn)){var s=m?m.stats:p.stats,c=m?m.duration:p.duration;if(this.clearTimer(),this.lastLoadedFragLevel=p.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var _=this.hls.levels[p.level],u=(_.loaded?_.loaded.bytes:0)+s.loaded,o=(_.loaded?_.loaded.duration:0)+c;_.loaded={bytes:u,duration:o},_.realBitrate=Math.round(8*u/o)}if(p.bitrateTest){var n={stats:s,frag:p,part:m,id:p.type};this.onFragBuffered(k.Events.FRAG_BUFFERED,n)}}},d.onFragBuffered=function(i,l){var p=l.frag,m=l.part,s=m?m.stats:p.stats;if(!s.aborted&&!(p.type!==W.PlaylistLevelType.MAIN||p.sn==="initSegment")){var c=s.parsing.end-s.loading.start;this.bwEstimator.sample(c,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),p.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}},d.onError=function(i,l){var p;if(((p=l.frag)===null||p===void 0?void 0:p.type)===W.PlaylistLevelType.MAIN){if(l.type===R.ErrorTypes.KEY_SYSTEM_ERROR){this.clearTimer();return}switch(l.details){case R.ErrorDetails.FRAG_LOAD_ERROR:case R.ErrorDetails.FRAG_LOAD_TIMEOUT:case R.ErrorDetails.KEY_LOAD_ERROR:case R.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer();break}}},d.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},d.getNextABRAutoLevel=function(){var i=this.fragCurrent,l=this.partCurrent,p=this.hls,m=p.maxAutoLevel,s=p.config,c=p.minAutoLevel,_=p.media,u=l?l.duration:i?i.duration:0,o=_&&_.playbackRate!==0?Math.abs(_.playbackRate):1,n=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,g=p.mainForwardBufferInfo,r=(g?g.len:0)/o,E=this.findBestLevel(n,c,m,r,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(E>=0)return E;C.logger.trace((r?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var P=u?Math.min(u,s.maxStarvationDelay):s.maxStarvationDelay,y=s.abrBandWidthFactor,U=s.abrBandWidthUpFactor;if(!r){var B=this.bitrateTestDelay;if(B){var F=u?Math.min(u,s.maxLoadingDelay):s.maxLoadingDelay;P=F-B,C.logger.trace("bitrate test took "+Math.round(1e3*B)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*P)+" ms"),y=U=1}}return E=this.findBestLevel(n,c,m,r+P,y,U),Math.max(E,0)},d.findBestLevel=function(i,l,p,m,s,c){for(var _,u=this.fragCurrent,o=this.partCurrent,n=this.lastLoadedFragLevel,g=this.hls.levels,r=g[n],E=!!(r!=null&&(_=r.details)!==null&&_!==void 0&&_.live),P=r==null?void 0:r.codecSet,y=o?o.duration:u?u.duration:0,U=p;U>=l;U--){var B=g[U];if(!(!B||P&&B.codecSet!==P)){var F=B.details,H=(o?F==null?void 0:F.partTarget:F==null?void 0:F.averagetargetduration)||y,G=void 0;U<=n?G=s*i:G=c*i;var V=g[U].maxBitrate,z=V*H/G;if(C.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+U+"/"+Math.round(G)+"/"+V+"/"+H+"/"+m+"/"+z),G>V&&(z===0||!(0,w.isFiniteNumber)(z)||E&&!this.bitrateTestDelay||z<m))return U}}return-1},b(T,[{key:"nextAutoLevel",get:function(){var i=this._nextAutoLevel,l=this.bwEstimator;if(i!==-1&&!l.canEstimate())return i;var p=this.getNextABRAutoLevel();return i!==-1&&this.hls.levels[p].loadError?i:(i!==-1&&(p=Math.min(i,p)),p)},set:function(i){this._nextAutoLevel=i}}]),T}();const D=h},"./src/controller/audio-stream-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>s});var w=v("./src/polyfills/number.ts"),S=v("./src/controller/base-stream-controller.ts"),k=v("./src/events.ts"),R=v("./src/utils/buffer-helper.ts"),W=v("./src/controller/fragment-tracker.ts"),C=v("./src/types/level.ts"),I=v("./src/types/loader.ts"),b=v("./src/loader/fragment.ts"),L=v("./src/demux/chunk-cache.ts"),A=v("./src/demux/transmuxer-interface.ts"),h=v("./src/types/transmuxer.ts"),D=v("./src/controller/fragment-finders.ts"),T=v("./src/utils/discontinuities.ts"),d=v("./src/errors.ts");function f(){return f=Object.assign?Object.assign.bind():function(c){for(var _=1;_<arguments.length;_++){var u=arguments[_];for(var o in u)Object.prototype.hasOwnProperty.call(u,o)&&(c[o]=u[o])}return c},f.apply(this,arguments)}function i(c,_){c.prototype=Object.create(_.prototype),c.prototype.constructor=c,l(c,_)}function l(c,_){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,n){return o.__proto__=n,o},l(c,_)}var p=100,m=function(c){i(_,c);function _(o,n,g){var r;return r=c.call(this,o,n,g,"[audio-stream-controller]")||this,r.videoBuffer=null,r.videoTrackCC=-1,r.waitingVideoCC=-1,r.audioSwitch=!1,r.trackId=-1,r.waitingData=null,r.mainDetails=null,r.bufferFlushed=!1,r.cachedTrackLoadedData=null,r._registerListeners(),r}var u=_.prototype;return u.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},u._registerListeners=function(){var n=this.hls;n.on(k.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(k.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.on(k.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),n.on(k.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.on(k.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),n.on(k.Events.ERROR,this.onError,this),n.on(k.Events.BUFFER_RESET,this.onBufferReset,this),n.on(k.Events.BUFFER_CREATED,this.onBufferCreated,this),n.on(k.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.on(k.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.on(k.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u._unregisterListeners=function(){var n=this.hls;n.off(k.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(k.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.off(k.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),n.off(k.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.off(k.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),n.off(k.Events.ERROR,this.onError,this),n.off(k.Events.BUFFER_RESET,this.onBufferReset,this),n.off(k.Events.BUFFER_CREATED,this.onBufferCreated,this),n.off(k.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.off(k.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.off(k.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u.onInitPtsFound=function(n,g){var r=g.frag,E=g.id,P=g.initPTS;if(E==="main"){var y=r.cc;this.initPTS[r.cc]=P,this.log("InitPTS for cc: "+y+" found from main: "+P),this.videoTrackCC=y,this.state===S.State.WAITING_INIT_PTS&&this.tick()}},u.startLoad=function(n){if(!this.levels){this.startPosition=n,this.state=S.State.STOPPED;return}var g=this.lastCurrentTime;this.stopLoad(),this.setInterval(p),this.fragLoadError=0,g>0&&n===-1?(this.log("Override startPosition with lastCurrentTime @"+g.toFixed(3)),n=g,this.state=S.State.IDLE):(this.loadedmetadata=!1,this.state=S.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()},u.doTick=function(){switch(this.state){case S.State.IDLE:this.doTickIdle();break;case S.State.WAITING_TRACK:{var n,g=this.levels,r=this.trackId,E=g==null||(n=g[r])===null||n===void 0?void 0:n.details;if(E){if(this.waitForCdnTuneIn(E))break;this.state=S.State.WAITING_INIT_PTS}break}case S.State.FRAG_LOADING_WAITING_RETRY:{var P,y=performance.now(),U=this.retryDate;(!U||y>=U||(P=this.media)!==null&&P!==void 0&&P.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=S.State.IDLE);break}case S.State.WAITING_INIT_PTS:{var B=this.waitingData;if(B){var F=B.frag,H=B.part,G=B.cache,V=B.complete;if(this.initPTS[F.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=S.State.FRAG_LOADING;var z=G.flush(),$={frag:F,part:H,payload:z,networkDetails:null};this._handleFragmentLoadProgress($),V&&c.prototype._handleFragmentLoadComplete.call(this,$)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+F.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var X=this.getLoadPosition(),j=R.BufferHelper.bufferInfo(this.mediaBuffer,X,this.config.maxBufferHole),Y=(0,D.fragmentWithinToleranceTest)(j.end,this.config.maxFragLookUpTolerance,F);Y<0&&(this.log("Waiting fragment cc ("+F.cc+") @ "+F.start+" cancelled because another fragment at "+j.end+" is needed"),this.clearWaitingFragment())}}else this.state=S.State.IDLE}}this.onTickEnd()},u.clearWaitingFragment=function(){var n=this.waitingData;n&&(this.fragmentTracker.removeFragment(n.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=S.State.IDLE)},u.resetLoadingState=function(){this.clearWaitingFragment(),c.prototype.resetLoadingState.call(this)},u.onTickEnd=function(){var n=this.media;!n||!n.readyState||(this.lastCurrentTime=n.currentTime)},u.doTickIdle=function(){var n=this.hls,g=this.levels,r=this.media,E=this.trackId,P=n.config;if(!(!g||!g[E])&&!(!r&&(this.startFragRequested||!P.startFragPrefetch))){var y=g[E],U=y.details;if(!U||U.live&&this.levelLastLoaded!==E||this.waitForCdnTuneIn(U)){this.state=S.State.WAITING_TRACK;return}var B=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&B&&(this.bufferFlushed=!1,this.afterBufferFlushed(B,b.ElementaryStreamTypes.AUDIO,I.PlaylistLevelType.AUDIO));var F=this.getFwdBufferInfo(B,I.PlaylistLevelType.AUDIO);if(F!==null){var H=this.audioSwitch;if(!H&&this._streamEnded(F,U)){n.trigger(k.Events.BUFFER_EOS,{type:"audio"}),this.state=S.State.ENDED;return}var G=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,I.PlaylistLevelType.MAIN),V=F.len,z=this.getMaxBufferLength(G==null?void 0:G.len);if(!(V>=z&&!H)){var $=U.fragments,X=$[0].start,j=F.end;if(H&&r){var Y=this.getLoadPosition();j=Y,U.PTSKnown&&Y<X&&(F.end>X||F.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=X+.05)}if(!(G&&j>G.end+U.targetduration)&&!((!G||!G.len)&&F.len)){var Q=this.getNextFragment(j,U);if(!Q){this.bufferFlushed=!0;return}this.loadFragment(Q,U,j)}}}}},u.getMaxBufferLength=function(n){var g=c.prototype.getMaxBufferLength.call(this);return n?Math.max(g,n):g},u.onMediaDetaching=function(){this.videoBuffer=null,c.prototype.onMediaDetaching.call(this)},u.onAudioTracksUpdated=function(n,g){var r=g.audioTracks;this.resetTransmuxer(),this.levels=r.map(function(E){return new C.Level(E)})},u.onAudioTrackSwitching=function(n,g){var r=!!g.url;this.trackId=g.id;var E=this.fragCurrent;E&&E.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),r?this.setInterval(p):this.resetTransmuxer(),r?(this.audioSwitch=!0,this.state=S.State.IDLE):this.state=S.State.STOPPED,this.tick()},u.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},u.onLevelLoaded=function(n,g){this.mainDetails=g.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(k.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},u.onAudioTrackLoaded=function(n,g){var r;if(this.mainDetails==null){this.cachedTrackLoadedData=g;return}var E=this.levels,P=g.details,y=g.id;if(!E){this.warn("Audio tracks were reset while loading level "+y);return}this.log("Track "+y+" loaded ["+P.startSN+","+P.endSN+"],duration:"+P.totalduration);var U=E[y],B=0;if(P.live||(r=U.details)!==null&&r!==void 0&&r.live){var F=this.mainDetails;if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed||!F)return;!U.details&&P.hasProgramDateTime&&F.hasProgramDateTime?((0,T.alignMediaPlaylistByPDT)(P,F),B=P.fragments[0].start):B=this.alignPlaylists(P,U.details)}U.details=P,this.levelLastLoaded=y,!this.startFragRequested&&(this.mainDetails||!P.live)&&this.setStartPosition(U.details,B),this.state===S.State.WAITING_TRACK&&!this.waitForCdnTuneIn(P)&&(this.state=S.State.IDLE),this.tick()},u._handleFragmentLoadProgress=function(n){var g,r=n.frag,E=n.part,P=n.payload,y=this.config,U=this.trackId,B=this.levels;if(!B){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered");return}var F=B[U];console.assert(F,"Audio track is defined on fragment load progress");var H=F.details;console.assert(H,"Audio track details are defined on fragment load progress");var G=y.defaultAudioCodec||F.audioCodec||"mp4a.40.2",V=this.transmuxer;V||(V=this.transmuxer=new A.default(this.hls,I.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var z=this.initPTS[r.cc],$=(g=r.initSegment)===null||g===void 0?void 0:g.data;if(z!==void 0){var X=!1,j=E?E.index:-1,Y=j!==-1,Q=new h.ChunkMetadata(r.level,r.sn,r.stats.chunkCount,P.byteLength,j,Y);V.push(P,$,G,"",r,E,H.totalduration,X,Q,z)}else{this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+H.startSN+" ,"+H.endSN+"],track "+U);var J=this.waitingData=this.waitingData||{frag:r,part:E,cache:new L.default,complete:!1},Z=J.cache;Z.push(new Uint8Array(P)),this.waitingVideoCC=this.videoTrackCC,this.state=S.State.WAITING_INIT_PTS}},u._handleFragmentLoadComplete=function(n){if(this.waitingData){this.waitingData.complete=!0;return}c.prototype._handleFragmentLoadComplete.call(this,n)},u.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},u.onBufferCreated=function(n,g){var r=g.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),g.tracks.video&&(this.videoBuffer=g.tracks.video.buffer||null)},u.onFragBuffered=function(n,g){var r=g.frag,E=g.part;if(r.type!==I.PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&r.type===I.PlaylistLevelType.MAIN){var P;(P=this.videoBuffer||this.media)!==null&&P!==void 0&&P.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(r)){this.warn("Fragment "+r.sn+(E?" p: "+E.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}r.sn!=="initSegment"&&(this.fragPrevious=r,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(k.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(r,E)},u.onError=function(n,g){if(g.type===d.ErrorTypes.KEY_SYSTEM_ERROR){this.onFragmentOrKeyLoadError(I.PlaylistLevelType.AUDIO,g);return}switch(g.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:case d.ErrorDetails.FRAG_PARSING_ERROR:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.AUDIO,g);break;case d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==S.State.ERROR&&this.state!==S.State.STOPPED&&(this.state=g.fatal?S.State.ERROR:S.State.IDLE,this.warn(g.details+" while loading frag, switching to "+this.state+" state"));break;case d.ErrorDetails.BUFFER_FULL_ERROR:if(g.parent==="audio"&&(this.state===S.State.PARSING||this.state===S.State.PARSED)){var r=!0,E=this.getFwdBufferInfo(this.mediaBuffer,I.PlaylistLevelType.AUDIO);E&&E.len>.5&&(r=!this.reduceMaxBufferLength(E.len)),r&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,c.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},u.onBufferFlushed=function(n,g){var r=g.type;r===b.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===S.State.ENDED&&(this.state=S.State.IDLE))},u._handleTransmuxComplete=function(n){var g,r="audio",E=this.hls,P=n.remuxResult,y=n.chunkMeta,U=this.getCurrentContext(y);if(!U){this.warn("The loading context changed while buffering fragment "+y.sn+" of level "+y.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(y.level);return}var B=U.frag,F=U.part,H=U.level.details,G=P.audio,V=P.text,z=P.id3,$=P.initSegment;if(!(this.fragContextChanged(B)||!H)){if(this.state=S.State.PARSING,this.audioSwitch&&G&&this.completeAudioSwitch(),$!=null&&$.tracks&&(this._bufferInitSegment($.tracks,B,y),E.trigger(k.Events.FRAG_PARSING_INIT_SEGMENT,{frag:B,id:r,tracks:$.tracks})),G){var X=G.startPTS,j=G.endPTS,Y=G.startDTS,Q=G.endDTS;F&&(F.elementaryStreams[b.ElementaryStreamTypes.AUDIO]={startPTS:X,endPTS:j,startDTS:Y,endDTS:Q}),B.setElementaryStreamInfo(b.ElementaryStreamTypes.AUDIO,X,j,Y,Q),this.bufferFragmentData(G,B,F,y)}if(z!=null&&(g=z.samples)!==null&&g!==void 0&&g.length){var J=f({id:r,frag:B,details:H},z);E.trigger(k.Events.FRAG_PARSING_METADATA,J)}if(V){var Z=f({id:r,frag:B,details:H},V);E.trigger(k.Events.FRAG_PARSING_USERDATA,Z)}}},u._bufferInitSegment=function(n,g,r){if(this.state===S.State.PARSING){n.video&&delete n.video;var E=n.audio;if(!!E){E.levelCodec=E.codec,E.id="audio",this.log("Init audio buffer, container:"+E.container+", codecs[parsed]=["+E.codec+"]"),this.hls.trigger(k.Events.BUFFER_CODECS,n);var P=E.initSegment;if(P!=null&&P.byteLength){var y={type:"audio",frag:g,part:null,chunkMeta:r,parent:g.type,data:P};this.hls.trigger(k.Events.BUFFER_APPENDING,y)}this.tick()}}},u.loadFragment=function(n,g,r){var E=this.fragmentTracker.getState(n);this.fragCurrent=n,(this.audioSwitch||E===W.FragmentState.NOT_LOADED||E===W.FragmentState.PARTIAL)&&(n.sn==="initSegment"?this._loadInitSegment(n,g):g.live&&!(0,w.isFiniteNumber)(this.initPTS[n.cc])?(this.log("Waiting for video PTS in continuity counter "+n.cc+" of live stream before loading audio fragment "+n.sn+" of level "+this.trackId),this.state=S.State.WAITING_INIT_PTS):(this.startFragRequested=!0,c.prototype.loadFragment.call(this,n,g,r)))},u.completeAudioSwitch=function(){var n=this.hls,g=this.media,r=this.trackId;g&&(this.log("Switching audio track : flushing all audio"),c.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,n.trigger(k.Events.AUDIO_TRACK_SWITCHED,{id:r})},_}(S.default);const s=m},"./src/controller/audio-track-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>D});var w=v("./src/events.ts"),S=v("./src/errors.ts"),k=v("./src/controller/base-playlist-controller.ts"),R=v("./src/types/loader.ts");function W(T,d){for(var f=0;f<d.length;f++){var i=d[f];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(T,I(i.key),i)}}function C(T,d,f){return d&&W(T.prototype,d),f&&W(T,f),Object.defineProperty(T,"prototype",{writable:!1}),T}function I(T){var d=b(T,"string");return typeof d=="symbol"?d:String(d)}function b(T,d){if(typeof T!="object"||T===null)return T;var f=T[Symbol.toPrimitive];if(f!==void 0){var i=f.call(T,d||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(T)}function L(T,d){T.prototype=Object.create(d.prototype),T.prototype.constructor=T,A(T,d)}function A(T,d){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,l){return i.__proto__=l,i},A(T,d)}var h=function(T){L(d,T);function d(i){var l;return l=T.call(this,i,"[audio-track-controller]")||this,l.tracks=[],l.groupId=null,l.tracksInGroup=[],l.trackId=-1,l.trackName="",l.selectDefaultTrack=!0,l.registerListeners(),l}var f=d.prototype;return f.registerListeners=function(){var l=this.hls;l.on(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(w.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.on(w.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),l.on(w.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var l=this.hls;l.off(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(w.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.off(w.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),l.off(w.Events.ERROR,this.onError,this)},f.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,T.prototype.destroy.call(this)},f.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},f.onManifestParsed=function(l,p){this.tracks=p.audioTracks||[]},f.onAudioTrackLoaded=function(l,p){var m=p.id,s=p.details,c=this.tracksInGroup[m];if(!c){this.warn("Invalid audio track id "+m);return}var _=c.details;c.details=p.details,this.log("audioTrack "+m+" loaded ["+s.startSN+"-"+s.endSN+"]"),m===this.trackId&&(this.retryCount=0,this.playlistLoaded(m,p,_))},f.onLevelLoading=function(l,p){this.switchLevel(p.level)},f.onLevelSwitching=function(l,p){this.switchLevel(p.level)},f.switchLevel=function(l){var p=this.hls.levels[l];if(!!(p!=null&&p.audioGroupIds)){var m=p.audioGroupIds[p.urlId];if(this.groupId!==m){this.groupId=m;var s=this.tracks.filter(function(_){return!m||_.groupId===m});this.selectDefaultTrack&&!s.some(function(_){return _.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=s;var c={audioTracks:s};this.log("Updating audio tracks, "+s.length+' track(s) found in "'+m+'" group-id'),this.hls.trigger(w.Events.AUDIO_TRACKS_UPDATED,c),this.selectInitialTrack()}}},f.onError=function(l,p){T.prototype.onError.call(this,l,p),!(p.fatal||!p.context)&&p.context.type===R.PlaylistContextType.AUDIO_TRACK&&p.context.id===this.trackId&&p.context.groupId===this.groupId&&this.retryLoadingOrFail(p)},f.setAudioTrack=function(l){var p=this.tracksInGroup;if(l<0||l>=p.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var m=p[this.trackId];this.log("Now switching to audio-track index "+l);var s=p[l],c=s.id,_=s.groupId,u=_===void 0?"":_,o=s.name,n=s.type,g=s.url;if(this.trackId=l,this.trackName=o,this.selectDefaultTrack=!1,this.hls.trigger(w.Events.AUDIO_TRACK_SWITCHING,{id:c,groupId:u,name:o,type:n,url:g}),!(s.details&&!s.details.live)){var r=this.switchParams(s.url,m==null?void 0:m.details);this.loadPlaylist(r)}},f.selectInitialTrack=function(){var l=this.tracksInGroup;console.assert(l.length,"Initial audio track should be selected when tracks are known");var p=this.trackName,m=this.findTrackId(p)||this.findTrackId();m!==-1?this.setAudioTrack(m):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(w.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},f.findTrackId=function(l){for(var p=this.tracksInGroup,m=0;m<p.length;m++){var s=p[m];if((!this.selectDefaultTrack||s.default)&&(!l||l===s.name))return s.id}return-1},f.loadPlaylist=function(l){T.prototype.loadPlaylist.call(this);var p=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(p)){var m=p.id,s=p.groupId,c=p.url;if(l)try{c=l.addDirectives(c)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("loading audio-track playlist for id: "+m),this.clearTimer(),this.hls.trigger(w.Events.AUDIO_TRACK_LOADING,{url:c,id:m,groupId:s,deliveryDirectives:l||null})}},C(d,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(l){this.selectDefaultTrack=!1,this.setAudioTrack(l)}}]),d}(k.default);const D=h},"./src/controller/base-playlist-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>W});var w=v("./src/types/level.ts"),S=v("./src/controller/level-helper.ts"),k=v("./src/utils/logger.ts"),R=v("./src/errors.ts"),W=function(){function C(b,L){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=k.logger.log.bind(k.logger,L+":"),this.warn=k.logger.warn.bind(k.logger,L+":"),this.hls=b}var I=C.prototype;return I.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},I.onError=function(L,A){A.fatal&&(A.type===R.ErrorTypes.NETWORK_ERROR||A.type===R.ErrorTypes.KEY_SYSTEM_ERROR)&&this.stopLoad()},I.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},I.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},I.stopLoad=function(){this.canLoad=!1,this.clearTimer()},I.switchParams=function(L,A){var h=A==null?void 0:A.renditionReports;if(h)for(var D=0;D<h.length;D++){var T=h[D],d=void 0;try{d=new self.URL(T.URI,A.url).href}catch(p){k.logger.warn("Could not construct new URL for Rendition Report: "+p),d=T.URI||""}if(d===L.slice(-d.length)){var f=parseInt(T["LAST-MSN"])||(A==null?void 0:A.lastPartSn),i=parseInt(T["LAST-PART"])||(A==null?void 0:A.lastPartIndex);if(this.hls.config.lowLatencyMode){var l=Math.min(A.age-A.partTarget,A.targetduration);i>=0&&l>A.partTarget&&(i+=1)}return new w.HlsUrlParameters(f,i>=0?i:void 0,w.HlsSkip.No)}}},I.loadPlaylist=function(L){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())},I.shouldLoadTrack=function(L){return this.canLoad&&L&&!!L.url&&(!L.details||L.details.live)},I.playlistLoaded=function(L,A,h){var D=this,T=A.details,d=A.stats,f=self.performance.now(),i=d.loading.first?Math.max(0,f-d.loading.first):0;if(T.advancedDateTime=Date.now()-i,T.live||h!=null&&h.live){if(T.reloaded(h),h&&this.log("live playlist "+L+" "+(T.advanced?"REFRESHED "+T.lastPartSn+"-"+T.lastPartIndex:"MISSED")),h&&T.fragments.length>0&&(0,S.mergeDetails)(h,T),!this.canLoad||!T.live)return;var l,p=void 0,m=void 0;if(T.canBlockReload&&T.endSN&&T.advanced){var s=this.hls.config.lowLatencyMode,c=T.lastPartSn,_=T.endSN,u=T.lastPartIndex,o=u!==-1,n=c===_,g=s?0:u;o?(p=n?_+1:c,m=n?g:u+1):p=_+1;var r=T.age,E=r+T.ageHeader,P=Math.min(E-T.partTarget,T.targetduration*1.5);if(P>0){if(h&&P>h.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+h.tuneInGoal+" to: "+P+" with playlist age: "+T.age),P=0;else{var y=Math.floor(P/T.targetduration);if(p+=y,m!==void 0){var U=Math.round(P%T.targetduration/T.partTarget);m+=U}this.log("CDN Tune-in age: "+T.ageHeader+"s last advanced "+r.toFixed(2)+"s goal: "+P+" skip sn "+y+" to part "+m)}T.tuneInGoal=P}if(l=this.getDeliveryDirectives(T,A.deliveryDirectives,p,m),s||!n){this.loadPlaylist(l);return}}else l=this.getDeliveryDirectives(T,A.deliveryDirectives,p,m);var B=this.hls.mainForwardBufferInfo,F=B?B.end-B.len:0,H=(T.edge-F)*1e3,G=(0,S.computeReloadInterval)(T,H);T.updated?f>this.requestScheduled+G&&(this.requestScheduled=d.loading.start):this.requestScheduled=-1,p!==void 0&&T.canBlockReload?this.requestScheduled=d.loading.first+G-(T.partTarget*1e3||1e3):this.requestScheduled=(this.requestScheduled===-1?f:this.requestScheduled)+G;var V=this.requestScheduled-f;V=Math.max(0,V),this.log("reload live playlist "+L+" in "+Math.round(V)+" ms"),this.timer=self.setTimeout(function(){return D.loadPlaylist(l)},V)}else this.clearTimer()},I.getDeliveryDirectives=function(L,A,h,D){var T=(0,w.getSkipValue)(L,h);return A!=null&&A.skip&&L.deltaUpdateFailed&&(h=A.msn,D=A.part,T=w.HlsSkip.No),new w.HlsUrlParameters(h,D,T)},I.retryLoadingOrFail=function(L){var A=this,h=this.hls.config,D=this.retryCount<h.levelLoadingMaxRetry;if(D){var T;if(this.requestScheduled=-1,this.retryCount++,L.details.indexOf("LoadTimeOut")>-1&&(T=L.context)!==null&&T!==void 0&&T.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+L.details+'"'),this.loadPlaylist();else{var d=Math.min(Math.pow(2,this.retryCount)*h.levelLoadingRetryDelay,h.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return A.loadPlaylist()},d),this.warn("retry playlist loading #"+this.retryCount+" in "+d+' ms after "'+L.details+'"')}}else this.warn('cannot recover from error "'+L.details+'"'),this.clearTimer(),L.fatal=!0;return D},C}()},"./src/controller/base-stream-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{State:()=>o,default:()=>n});var w=v("./src/polyfills/number.ts"),S=v("./src/task-loop.ts"),k=v("./src/controller/fragment-tracker.ts"),R=v("./src/utils/buffer-helper.ts"),W=v("./src/utils/logger.ts"),C=v("./src/events.ts"),I=v("./src/errors.ts"),b=v("./src/types/transmuxer.ts"),L=v("./src/utils/mp4-tools.ts"),A=v("./src/utils/discontinuities.ts"),h=v("./src/controller/fragment-finders.ts"),D=v("./src/controller/level-helper.ts"),T=v("./src/loader/fragment-loader.ts"),d=v("./src/crypt/decrypter.ts"),f=v("./src/utils/time-ranges.ts"),i=v("./src/types/loader.ts");function l(g,r){for(var E=0;E<r.length;E++){var P=r[E];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(g,m(P.key),P)}}function p(g,r,E){return r&&l(g.prototype,r),E&&l(g,E),Object.defineProperty(g,"prototype",{writable:!1}),g}function m(g){var r=s(g,"string");return typeof r=="symbol"?r:String(r)}function s(g,r){if(typeof g!="object"||g===null)return g;var E=g[Symbol.toPrimitive];if(E!==void 0){var P=E.call(g,r||"default");if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(g)}function c(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function _(g,r){g.prototype=Object.create(r.prototype),g.prototype.constructor=g,u(g,r)}function u(g,r){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(P,y){return P.__proto__=y,P},u(g,r)}var o={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},n=function(g){_(r,g);function r(P,y,U,B){var F;return F=g.call(this)||this,F.hls=void 0,F.fragPrevious=null,F.fragCurrent=null,F.fragmentTracker=void 0,F.transmuxer=null,F._state=o.STOPPED,F.media=null,F.mediaBuffer=null,F.config=void 0,F.bitrateTest=!1,F.lastCurrentTime=0,F.nextLoadPosition=0,F.startPosition=0,F.loadedmetadata=!1,F.fragLoadError=0,F.retryDate=0,F.levels=null,F.fragmentLoader=void 0,F.keyLoader=void 0,F.levelLastLoaded=null,F.startFragRequested=!1,F.decrypter=void 0,F.initPTS=[],F.onvseeking=null,F.onvended=null,F.logPrefix="",F.log=void 0,F.warn=void 0,F.logPrefix=B,F.log=W.logger.log.bind(W.logger,B+":"),F.warn=W.logger.warn.bind(W.logger,B+":"),F.hls=P,F.fragmentLoader=new T.default(P.config),F.keyLoader=U,F.fragmentTracker=y,F.config=P.config,F.decrypter=new d.default(P.config),P.on(C.Events.LEVEL_SWITCHING,F.onLevelSwitching,c(F)),F}var E=r.prototype;return E.doTick=function(){this.onTickEnd()},E.onTickEnd=function(){},E.startLoad=function(y){},E.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var y=this.fragCurrent;y&&(y.abortRequests(),this.fragmentTracker.removeFragment(y)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=o.STOPPED},E._streamEnded=function(y,U){if(U.live||y.nextStart||!y.end||!this.media)return!1;var B=U.partList;if(B!=null&&B.length){var F=B[B.length-1],H=R.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return H}var G=U.fragments[U.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(G)},E.getLevelDetails=function(){if(this.levels&&this.levelLastLoaded!==null){var y;return(y=this.levels[this.levelLastLoaded])===null||y===void 0?void 0:y.details}},E.onMediaAttached=function(y,U){var B=this.media=this.mediaBuffer=U.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),B.addEventListener("seeking",this.onvseeking),B.addEventListener("ended",this.onvended);var F=this.config;this.levels&&F.autoStartLoad&&this.state===o.STOPPED&&this.startLoad(F.startPosition)},E.onMediaDetaching=function(){var y=this.media;y!=null&&y.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),y&&this.onvseeking&&this.onvended&&(y.removeEventListener("seeking",this.onvseeking),y.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},E.onMediaSeeking=function(){var y=this.config,U=this.fragCurrent,B=this.media,F=this.mediaBuffer,H=this.state,G=B?B.currentTime:0,V=R.BufferHelper.bufferInfo(F||B,G,y.maxBufferHole);if(this.log("media seeking to "+((0,w.isFiniteNumber)(G)?G.toFixed(3):G)+", state: "+H),this.state===o.ENDED)this.resetLoadingState();else if(U){var z=y.maxFragLookUpTolerance,$=U.start-z,X=U.start+U.duration+z;if(!V.len||X<V.start||$>V.end){var j=G>X;(G<$||j)&&(j&&U.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),U.abortRequests()),this.resetLoadingState())}}B&&(this.lastCurrentTime=G),!this.loadedmetadata&&!V.len&&(this.nextLoadPosition=this.startPosition=G),this.tickImmediate()},E.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},E.onLevelSwitching=function(y,U){this.fragLoadError=0},E.onHandlerDestroying=function(){this.stopLoad(),g.prototype.onHandlerDestroying.call(this)},E.onHandlerDestroyed=function(){this.state=o.STOPPED,this.hls.off(C.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,g.prototype.onHandlerDestroyed.call(this)},E.loadFragment=function(y,U,B){this._loadFragForPlayback(y,U,B)},E._loadFragForPlayback=function(y,U,B){var F=this,H=function(V){if(F.fragContextChanged(y)){F.warn("Fragment "+y.sn+(V.part?" p: "+V.part.index:"")+" of level "+y.level+" was dropped during download."),F.fragmentTracker.removeFragment(y);return}y.stats.chunkCount++,F._handleFragmentLoadProgress(V)};this._doFragLoad(y,U,B,H).then(function(G){if(!!G){F.fragLoadError=0;var V=F.state;if(F.fragContextChanged(y)){(V===o.FRAG_LOADING||!F.fragCurrent&&V===o.PARSING)&&(F.fragmentTracker.removeFragment(y),F.state=o.IDLE);return}"payload"in G&&(F.log("Loaded fragment "+y.sn+" of level "+y.level),F.hls.trigger(C.Events.FRAG_LOADED,G)),F._handleFragmentLoadComplete(G)}}).catch(function(G){F.state===o.STOPPED||F.state===o.ERROR||(F.warn(G),F.resetFragmentLoading(y))})},E.flushMainBuffer=function(y,U,B){if(B===void 0&&(B=null),!!(y-U)){var F={startOffset:y,endOffset:U,type:B};this.fragLoadError=0,this.hls.trigger(C.Events.BUFFER_FLUSHING,F)}},E._loadInitSegment=function(y,U){var B=this;this._doFragLoad(y,U).then(function(F){if(!F||B.fragContextChanged(y)||!B.levels)throw new Error("init load aborted");return F}).then(function(F){var H=B.hls,G=F.payload,V=y.decryptdata;if(G&&G.byteLength>0&&V&&V.key&&V.iv&&V.method==="AES-128"){var z=self.performance.now();return B.decrypter.decrypt(new Uint8Array(G),V.key.buffer,V.iv.buffer).then(function($){var X=self.performance.now();return H.trigger(C.Events.FRAG_DECRYPTED,{frag:y,payload:$,stats:{tstart:z,tdecrypt:X}}),F.payload=$,F})}return F}).then(function(F){var H=B.fragCurrent,G=B.hls,V=B.levels;if(!V)throw new Error("init load aborted, missing levels");var z=V[y.level].details;console.assert(z,"Level details are defined when init segment is loaded");var $=y.stats;B.state=o.IDLE,B.fragLoadError=0,y.data=new Uint8Array(F.payload),$.parsing.start=$.buffering.start=self.performance.now(),$.parsing.end=$.buffering.end=self.performance.now(),F.frag===H&&G.trigger(C.Events.FRAG_BUFFERED,{stats:$,frag:H,part:null,id:y.type}),B.tick()}).catch(function(F){B.state===o.STOPPED||B.state===o.ERROR||(B.warn(F),B.resetFragmentLoading(y))})},E.fragContextChanged=function(y){var U=this.fragCurrent;return!y||!U||y.level!==U.level||y.sn!==U.sn||y.urlId!==U.urlId},E.fragBufferedComplete=function(y,U){var B,F,H=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+y.type+" sn: "+y.sn+(U?" part: "+U.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+y.level+" (frag:["+(y.startPTS||NaN).toFixed(3)+"-"+(y.endPTS||NaN).toFixed(3)+"] > buffer:"+(H?f.default.toString(R.BufferHelper.getBuffered(H)):"(detached)")+")"),this.state=o.IDLE,H&&(!this.loadedmetadata&&y.type==i.PlaylistLevelType.MAIN&&H.buffered.length&&((B=this.fragCurrent)===null||B===void 0?void 0:B.sn)===((F=this.fragPrevious)===null||F===void 0?void 0:F.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},E.seekToStartPos=function(){},E._handleFragmentLoadComplete=function(y){var U=this.transmuxer;if(!!U){var B=y.frag,F=y.part,H=y.partsLoaded,G=!H||H.length===0||H.some(function(z){return!z}),V=new b.ChunkMetadata(B.level,B.sn,B.stats.chunkCount+1,0,F?F.index:-1,!G);U.flush(V)}},E._handleFragmentLoadProgress=function(y){},E._doFragLoad=function(y,U,B,F){var H,G=this;if(B===void 0&&(B=null),!this.levels)throw new Error("frag load aborted, missing levels");var V=null;if(y.encrypted&&!((H=y.decryptdata)!==null&&H!==void 0&&H.key)?(this.log("Loading key for "+y.sn+" of ["+U.startSN+"-"+U.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+y.level),this.state=o.KEY_LOADING,this.fragCurrent=y,V=this.keyLoader.load(y).then(function(Y){if(!G.fragContextChanged(Y.frag))return G.hls.trigger(C.Events.KEY_LOADED,Y),G.state===o.KEY_LOADING&&(G.state=o.IDLE),Y}),this.hls.trigger(C.Events.KEY_LOADING,{frag:y}),this.throwIfFragContextChanged("KEY_LOADING")):!y.encrypted&&U.encryptedFragments.length&&this.keyLoader.loadClear(y,U.encryptedFragments),B=Math.max(y.start,B||0),this.config.lowLatencyMode&&U){var z=U.partList;if(z&&F){B>y.end&&U.fragmentHint&&(y=U.fragmentHint);var $=this.getNextPart(z,y,B);if($>-1){var X=z[$];return this.log("Loading part sn: "+y.sn+" p: "+X.index+" cc: "+y.cc+" of playlist ["+U.startSN+"-"+U.endSN+"] parts [0-"+$+"-"+(z.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+y.level+", target: "+parseFloat(B.toFixed(3))),this.nextLoadPosition=X.start+X.duration,this.state=o.FRAG_LOADING,this.hls.trigger(C.Events.FRAG_LOADING,{frag:y,part:z[$],targetBufferTime:B}),this.throwIfFragContextChanged("FRAG_LOADING parts"),V?V.then(function(Y){return!Y||G.fragContextChanged(Y.frag)?null:G.doFragPartsLoad(y,z,$,F)}).catch(function(Y){return G.handleFragLoadError(Y)}):this.doFragPartsLoad(y,z,$,F).catch(function(Y){return G.handleFragLoadError(Y)})}else if(!y.url||this.loadedEndOfParts(z,B))return Promise.resolve(null)}}this.log("Loading fragment "+y.sn+" cc: "+y.cc+" "+(U?"of ["+U.startSN+"-"+U.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+y.level+", target: "+parseFloat(B.toFixed(3))),(0,w.isFiniteNumber)(y.sn)&&!this.bitrateTest&&(this.nextLoadPosition=y.start+y.duration),this.state=o.FRAG_LOADING,this.hls.trigger(C.Events.FRAG_LOADING,{frag:y,targetBufferTime:B}),this.throwIfFragContextChanged("FRAG_LOADING");var j=this.config.progressive;return j&&V?V.then(function(Y){return!Y||G.fragContextChanged(Y==null?void 0:Y.frag)?null:G.fragmentLoader.load(y,F)}).catch(function(Y){return G.handleFragLoadError(Y)}):Promise.all([this.fragmentLoader.load(y,j?F:void 0),V]).then(function(Y){var Q=Y[0];return!j&&Q&&F&&F(Q),Q}).catch(function(Y){return G.handleFragLoadError(Y)})},E.throwIfFragContextChanged=function(y){if(this.fragCurrent===null)throw new Error("frag load aborted, context changed in "+y)},E.doFragPartsLoad=function(y,U,B,F){var H=this;return new Promise(function(G,V){var z=[],$=function X(j){var Y=U[j];H.fragmentLoader.loadPart(y,Y,F).then(function(Q){z[Y.index]=Q;var J=Q.part;H.hls.trigger(C.Events.FRAG_LOADED,Q);var Z=U[j+1];if(Z&&Z.fragment===y)X(j+1);else return G({frag:y,part:J,partsLoaded:z})}).catch(V)};$(B)})},E.handleFragLoadError=function(y){if("data"in y){var U=y.data;y.data&&U.details===I.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(U.frag,U.part):this.hls.trigger(C.Events.ERROR,U)}else this.hls.trigger(C.Events.ERROR,{type:I.ErrorTypes.OTHER_ERROR,details:I.ErrorDetails.INTERNAL_EXCEPTION,err:y,fatal:!0});return null},E._handleTransmuxerFlush=function(y){var U=this.getCurrentContext(y);if(!U||this.state!==o.PARSING){!this.fragCurrent&&this.state!==o.STOPPED&&this.state!==o.ERROR&&(this.state=o.IDLE);return}var B=U.frag,F=U.part,H=U.level,G=self.performance.now();B.stats.parsing.end=G,F&&(F.stats.parsing.end=G),this.updateLevelTiming(B,F,H,y.partial)},E.getCurrentContext=function(y){var U=this.levels,B=y.level,F=y.sn,H=y.part;if(!U||!U[B])return this.warn("Levels object was unset while buffering fragment "+F+" of level "+B+". The current chunk will not be buffered."),null;var G=U[B],V=H>-1?(0,D.getPartWith)(G,F,H):null,z=V?V.fragment:(0,D.getFragmentWithSN)(G,F,this.fragCurrent);return z?{frag:z,part:V,level:G}:null},E.bufferFragmentData=function(y,U,B,F){if(!(!y||this.state!==o.PARSING)){var H=y.data1,G=y.data2,V=H;if(H&&G&&(V=(0,L.appendUint8Array)(H,G)),!(!V||!V.length)){var z={type:y.type,frag:U,part:B,chunkMeta:F,parent:U.type,data:V};this.hls.trigger(C.Events.BUFFER_APPENDING,z),y.dropped&&y.independent&&!B&&this.flushBufferGap(U)}}},E.flushBufferGap=function(y){var U=this.media;if(!!U){if(!R.BufferHelper.isBuffered(U,U.currentTime)){this.flushMainBuffer(0,y.start);return}var B=U.currentTime,F=R.BufferHelper.bufferInfo(U,B,0),H=y.duration,G=Math.min(this.config.maxFragLookUpTolerance*2,H*.25),V=Math.max(Math.min(y.start-G,F.end-G),B+G);y.start-V>G&&this.flushMainBuffer(V,y.start)}},E.getFwdBufferInfo=function(y,U){var B=this.config,F=this.getLoadPosition();if(!(0,w.isFiniteNumber)(F))return null;var H=R.BufferHelper.bufferInfo(y,F,B.maxBufferHole);if(H.len===0&&H.nextStart!==void 0){var G=this.fragmentTracker.getBufferedFrag(F,U);if(G&&H.nextStart<G.end)return R.BufferHelper.bufferInfo(y,F,Math.max(H.nextStart,B.maxBufferHole))}return H},E.getMaxBufferLength=function(y){var U=this.config,B;return y?B=Math.max(8*U.maxBufferSize/y,U.maxBufferLength):B=U.maxBufferLength,Math.min(B,U.maxMaxBufferLength)},E.reduceMaxBufferLength=function(y){var U=this.config,B=y||U.maxBufferLength;return U.maxMaxBufferLength>=B?(U.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+U.maxMaxBufferLength+"s"),!0):!1},E.getNextFragment=function(y,U){var B=U.fragments,F=B.length;if(!F)return null;var H=this.config,G=B[0].start,V;if(U.live){var z=H.initialLiveManifestSize;if(F<z)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+z+")"),null;!U.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(V=this.getInitialLiveFragment(U,B),this.startPosition=V?this.hls.liveSyncPosition||V.start:y)}else y<=G&&(V=B[0]);if(!V){var $=H.lowLatencyMode?U.partEnd:U.fragmentEnd;V=this.getFragmentAtPosition(y,$,U)}return this.mapToInitFragWhenRequired(V)},E.mapToInitFragWhenRequired=function(y){return y!=null&&y.initSegment&&!(y!=null&&y.initSegment.data)&&!this.bitrateTest?y.initSegment:y},E.getNextPart=function(y,U,B){for(var F=-1,H=!1,G=!0,V=0,z=y.length;V<z;V++){var $=y[V];if(G=G&&!$.independent,F>-1&&B<$.start)break;var X=$.loaded;X?F=-1:(H||$.independent||G)&&$.fragment===U&&(F=V),H=X}return F},E.loadedEndOfParts=function(y,U){var B=y[y.length-1];return B&&U>B.start&&B.loaded},E.getInitialLiveFragment=function(y,U){var B=this.fragPrevious,F=null;if(B){if(y.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+B.programDateTime),F=(0,h.findFragmentByPDT)(U,B.endProgramDateTime,this.config.maxFragLookUpTolerance)),!F){var H=B.sn+1;if(H>=y.startSN&&H<=y.endSN){var G=U[H-y.startSN];B.cc===G.cc&&(F=G,this.log("Live playlist, switching playlist, load frag with next SN: "+F.sn))}F||(F=(0,h.findFragWithCC)(U,B.cc),F&&this.log("Live playlist, switching playlist, load frag with same CC: "+F.sn))}}else{var V=this.hls.liveSyncPosition;V!==null&&(F=this.getFragmentAtPosition(V,this.bitrateTest?y.fragmentEnd:y.edge,y))}return F},E.getFragmentAtPosition=function(y,U,B){var F=this.config,H=this.fragPrevious,G=B.fragments,V=B.endSN,z=B.fragmentHint,$=F.maxFragLookUpTolerance,X=!!(F.lowLatencyMode&&B.partList&&z);X&&z&&!this.bitrateTest&&(G=G.concat(z),V=z.sn);var j;if(y<U){var Y=y>U-$?0:$;j=(0,h.findFragmentByPTS)(H,G,y,Y)}else j=G[G.length-1];if(j){var Q=j.sn-B.startSN;if(this.fragmentTracker.getState(j)===k.FragmentState.OK&&(H=j),H&&j.sn===H.sn&&!X){var J=H&&j.level===H.level;if(J){var Z=G[Q+1];j.sn<V&&this.fragmentTracker.getState(Z)!==k.FragmentState.OK?(this.log("SN "+j.sn+" just loaded, load next one: "+Z.sn),j=Z):j=null}}}return j},E.synchronizeToLiveEdge=function(y){var U=this.config,B=this.media;if(!!B){var F=this.hls.liveSyncPosition,H=B.currentTime,G=y.fragments[0].start,V=y.edge,z=H>=G-U.maxFragLookUpTolerance&&H<=V;if(F!==null&&B.duration>F&&(H<F||!z)){var $=U.liveMaxLatencyDuration!==void 0?U.liveMaxLatencyDuration:U.liveMaxLatencyDurationCount*y.targetduration;(!z&&B.readyState<4||H<V-$)&&(this.loadedmetadata||(this.nextLoadPosition=F),B.readyState&&(this.warn("Playback: "+H.toFixed(3)+" is located too far from the end of live sliding playlist: "+V+", reset currentTime to : "+F.toFixed(3)),B.currentTime=F))}}},E.alignPlaylists=function(y,U){var B=this.levels,F=this.levelLastLoaded,H=this.fragPrevious,G=F!==null?B[F]:null,V=y.fragments.length;if(!V)return this.warn("No fragments in live playlist"),0;var z=y.fragments[0].start,$=!U,X=y.alignedSliding&&(0,w.isFiniteNumber)(z);if($||!X&&!z){(0,A.alignStream)(H,G,y);var j=y.fragments[0].start;return this.log("Live playlist sliding: "+j.toFixed(2)+" start-sn: "+(U?U.startSN:"na")+"->"+y.startSN+" prev-sn: "+(H?H.sn:"na")+" fragments: "+V),j}return z},E.waitForCdnTuneIn=function(y){var U=3;return y.live&&y.canBlockReload&&y.partTarget&&y.tuneInGoal>Math.max(y.partHoldBack,y.partTarget*U)},E.setStartPosition=function(y,U){var B=this.startPosition;if(B<U&&(B=-1),B===-1||this.lastCurrentTime===-1){var F=y.startTimeOffset;(0,w.isFiniteNumber)(F)?(B=U+F,F<0&&(B+=y.totalduration),B=Math.min(Math.max(U,B),U+y.totalduration),this.log("Start time offset "+F+" found in playlist, adjust startPosition to "+B),this.startPosition=B):y.live?B=this.hls.liveSyncPosition||U:this.startPosition=B=0,this.lastCurrentTime=B}this.nextLoadPosition=B},E.getLoadPosition=function(){var y=this.media,U=0;return this.loadedmetadata&&y?U=y.currentTime:this.nextLoadPosition&&(U=this.nextLoadPosition),U},E.handleFragLoadAborted=function(y,U){this.transmuxer&&y.sn!=="initSegment"&&y.stats.aborted&&(this.warn("Fragment "+y.sn+(U?" part"+U.index:"")+" of level "+y.level+" was aborted"),this.resetFragmentLoading(y))},E.resetFragmentLoading=function(y){(!this.fragCurrent||!this.fragContextChanged(y)&&this.state!==o.FRAG_LOADING_WAITING_RETRY)&&(this.state=o.IDLE)},E.onFragmentOrKeyLoadError=function(y,U){if(U.fatal){this.stopLoad(),this.state=o.ERROR;return}var B=this.config;if(U.chunkMeta){var F=this.getCurrentContext(U.chunkMeta);F&&(U.frag=F.frag,U.levelRetry=!0,this.fragLoadError=B.fragLoadingMaxRetry)}var H=U.frag;if(!(!H||H.type!==y)){var G=this.fragCurrent;if(console.assert(G&&H.sn===G.sn&&H.level===G.level&&H.urlId===G.urlId,"Frag load error must match current frag to retry"),this.fragLoadError+1<=B.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var V=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+H.sn+" of "+y+" "+H.level+" failed to load, retrying in "+V+"ms"),this.retryDate=self.performance.now()+V,this.fragLoadError++,this.state=o.FRAG_LOADING_WAITING_RETRY}else U.levelRetry?(y===i.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=o.IDLE):(W.logger.error(U.details+" reaches max retry, redispatch as fatal ..."),U.fatal=!0,this.hls.stopLoad(),this.state=o.ERROR)}},E.afterBufferFlushed=function(y,U,B){if(!!y){var F=R.BufferHelper.getBuffered(y);this.fragmentTracker.detectEvictedFragments(U,F,B),this.state===o.ENDED&&this.resetLoadingState()}},E.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=o.IDLE},E.resetStartWhenNotLoaded=function(y){if(!this.loadedmetadata){this.startFragRequested=!1;var U=this.levels?this.levels[y].details:null;U!=null&&U.live?(this.startPosition=-1,this.setStartPosition(U,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},E.updateLevelTiming=function(y,U,B,F){var H=this,G=B.details;console.assert(!!G,"level.details must be defined");var V=Object.keys(y.elementaryStreams).reduce(function(z,$){var X=y.elementaryStreams[$];if(X){var j=X.endPTS-X.startPTS;if(j<=0)return H.warn("Could not parse fragment "+y.sn+" "+$+" duration reliably ("+j+")"),z||!1;var Y=F?0:(0,D.updateFragPTSDTS)(G,y,X.startPTS,X.endPTS,X.startDTS,X.endDTS);return H.hls.trigger(C.Events.LEVEL_PTS_UPDATED,{details:G,level:B,drift:Y,type:$,frag:y,start:X.startPTS,end:X.endPTS}),!0}return z},!1);V||(this.warn("Found no media in fragment "+y.sn+" of level "+B.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=o.PARSED,this.hls.trigger(C.Events.FRAG_PARSED,{frag:y,part:U})},E.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},p(r,[{key:"state",get:function(){return this._state},set:function(y){var U=this._state;U!==y&&(this._state=y,this.log(U+"->"+y))}}]),r}(S.default)},"./src/controller/buffer-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>h});var w=v("./src/polyfills/number.ts"),S=v("./src/events.ts"),k=v("./src/utils/logger.ts"),R=v("./src/errors.ts"),W=v("./src/utils/buffer-helper.ts"),C=v("./src/utils/mediasource-helper.ts"),I=v("./src/loader/fragment.ts"),b=v("./src/controller/buffer-operation-queue.ts"),L=(0,C.getMediaSource)(),A=/([ha]vc.)(?:\.[^.,]+)+/,h=function(){function D(d){var f=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var i=f.media,l=f.mediaSource;k.logger.log("[buffer-controller]: Media source opened"),i&&(i.removeEventListener("emptied",f._onMediaEmptied),f.updateMediaElementDuration(),f.hls.trigger(S.Events.MEDIA_ATTACHED,{media:i})),l&&l.removeEventListener("sourceopen",f._onMediaSourceOpen),f.checkPendingTracks()},this._onMediaSourceClose=function(){k.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){k.logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=function(){var i=f.media,l=f._objectUrl;i&&i.src!==l&&k.logger.error("Media element src was set while attaching MediaSource ("+l+" > "+i.src+")")},this.hls=d,this._initSourceBuffer(),this.registerListeners()}var T=D.prototype;return T.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},T.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},T.registerListeners=function(){var f=this.hls;f.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(S.Events.BUFFER_RESET,this.onBufferReset,this),f.on(S.Events.BUFFER_APPENDING,this.onBufferAppending,this),f.on(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.on(S.Events.BUFFER_EOS,this.onBufferEos,this),f.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),f.on(S.Events.FRAG_PARSED,this.onFragParsed,this),f.on(S.Events.FRAG_CHANGED,this.onFragChanged,this)},T.unregisterListeners=function(){var f=this.hls;f.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(S.Events.BUFFER_RESET,this.onBufferReset,this),f.off(S.Events.BUFFER_APPENDING,this.onBufferAppending,this),f.off(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.off(S.Events.BUFFER_EOS,this.onBufferEos,this),f.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),f.off(S.Events.FRAG_PARSED,this.onFragParsed,this),f.off(S.Events.FRAG_CHANGED,this.onFragChanged,this)},T._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new b.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},T.onManifestParsed=function(f,i){var l=2;(i.audio&&!i.video||!i.altAudio)&&(l=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=l,this.details=null,k.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},T.onMediaAttaching=function(f,i){var l=this.media=i.media;if(l&&L){var p=this.mediaSource=new L;p.addEventListener("sourceopen",this._onMediaSourceOpen),p.addEventListener("sourceended",this._onMediaSourceEnded),p.addEventListener("sourceclose",this._onMediaSourceClose),l.src=self.URL.createObjectURL(p),this._objectUrl=l.src,l.addEventListener("emptied",this._onMediaEmptied)}},T.onMediaDetaching=function(){var f=this.media,i=this.mediaSource,l=this._objectUrl;if(i){if(k.logger.log("[buffer-controller]: media source detaching"),i.readyState==="open")try{i.endOfStream()}catch(p){k.logger.warn("[buffer-controller]: onMediaDetaching: "+p.message+" while calling endOfStream")}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),f&&(f.removeEventListener("emptied",this._onMediaEmptied),l&&self.URL.revokeObjectURL(l),f.src===l?(f.removeAttribute("src"),f.load()):k.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(S.Events.MEDIA_DETACHED,void 0)},T.onBufferReset=function(){var f=this;this.getSourceBufferTypes().forEach(function(i){var l=f.sourceBuffer[i];try{l&&(f.removeBufferListeners(i),f.mediaSource&&f.mediaSource.removeSourceBuffer(l),f.sourceBuffer[i]=void 0)}catch(p){k.logger.warn("[buffer-controller]: Failed to reset the "+i+" buffer",p)}}),this._initSourceBuffer()},T.onBufferCodecs=function(f,i){var l=this,p=this.getSourceBufferTypes().length;Object.keys(i).forEach(function(m){if(p){var s=l.tracks[m];if(s&&typeof s.buffer.changeType=="function"){var c=i[m],_=c.id,u=c.codec,o=c.levelCodec,n=c.container,g=c.metadata,r=(s.levelCodec||s.codec).replace(A,"$1"),E=(o||u).replace(A,"$1");if(r!==E){var P=n+";codecs="+(o||u);l.appendChangeType(m,P),k.logger.log("[buffer-controller]: switching codec "+r+" to "+E),l.tracks[m]={buffer:s.buffer,codec:u,container:n,levelCodec:o,metadata:g,id:_}}}}else l.pendingTracks[m]=i[m]}),!p&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},T.appendChangeType=function(f,i){var l=this,p=this.operationQueue,m={execute:function(){var c=l.sourceBuffer[f];c&&(k.logger.log("[buffer-controller]: changing "+f+" sourceBuffer type to "+i),c.changeType(i)),p.shiftAndExecuteNext(f)},onStart:function(){},onComplete:function(){},onError:function(c){k.logger.warn("[buffer-controller]: Failed to change "+f+" SourceBuffer type",c)}};p.append(m,f)},T.onBufferAppending=function(f,i){var l=this,p=this.hls,m=this.operationQueue,s=this.tracks,c=i.data,_=i.type,u=i.frag,o=i.part,n=i.chunkMeta,g=n.buffering[_],r=self.performance.now();g.start=r;var E=u.stats.buffering,P=o?o.stats.buffering:null;E.start===0&&(E.start=r),P&&P.start===0&&(P.start=r);var y=s.audio,U=!1;_==="audio"&&(y==null?void 0:y.container)==="audio/mpeg"&&(U=!this.lastMpegAudioChunk||n.id===1||this.lastMpegAudioChunk.sn!==n.sn,this.lastMpegAudioChunk=n);var B=u.start,F={execute:function(){if(g.executeStart=self.performance.now(),U){var G=l.sourceBuffer[_];if(G){var V=B-G.timestampOffset;Math.abs(V)>=.1&&(k.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+B+" (delta: "+V+") sn: "+u.sn+")"),G.timestampOffset=B)}}l.appendExecutor(c,_)},onStart:function(){},onComplete:function(){var G=self.performance.now();g.executeEnd=g.end=G,E.first===0&&(E.first=G),P&&P.first===0&&(P.first=G);var V=l.sourceBuffer,z={};for(var $ in V)z[$]=W.BufferHelper.getBuffered(V[$]);l.appendError=0,l.hls.trigger(S.Events.BUFFER_APPENDED,{type:_,frag:u,part:o,chunkMeta:n,parent:u.type,timeRanges:z})},onError:function(G){k.logger.error("[buffer-controller]: Error encountered while trying to append to the "+_+" SourceBuffer",G);var V={type:R.ErrorTypes.MEDIA_ERROR,parent:u.type,details:R.ErrorDetails.BUFFER_APPEND_ERROR,err:G,fatal:!1};G.code===DOMException.QUOTA_EXCEEDED_ERR?V.details=R.ErrorDetails.BUFFER_FULL_ERROR:(l.appendError++,V.details=R.ErrorDetails.BUFFER_APPEND_ERROR,l.appendError>p.config.appendErrorMaxRetry&&(k.logger.error("[buffer-controller]: Failed "+p.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),V.fatal=!0,p.stopLoad())),p.trigger(S.Events.ERROR,V)}};m.append(F,_)},T.onBufferFlushing=function(f,i){var l=this,p=this.operationQueue,m=function(c){return{execute:l.removeExecutor.bind(l,c,i.startOffset,i.endOffset),onStart:function(){},onComplete:function(){l.hls.trigger(S.Events.BUFFER_FLUSHED,{type:c})},onError:function(u){k.logger.warn("[buffer-controller]: Failed to remove from "+c+" SourceBuffer",u)}}};i.type?p.append(m(i.type),i.type):this.getSourceBufferTypes().forEach(function(s){p.append(m(s),s)})},T.onFragParsed=function(f,i){var l=this,p=i.frag,m=i.part,s=[],c=m?m.elementaryStreams:p.elementaryStreams;c[I.ElementaryStreamTypes.AUDIOVIDEO]?s.push("audiovideo"):(c[I.ElementaryStreamTypes.AUDIO]&&s.push("audio"),c[I.ElementaryStreamTypes.VIDEO]&&s.push("video"));var _=function(){var o=self.performance.now();p.stats.buffering.end=o,m&&(m.stats.buffering.end=o);var n=m?m.stats:p.stats;l.hls.trigger(S.Events.FRAG_BUFFERED,{frag:p,part:m,stats:n,id:p.type})};s.length===0&&k.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+p.type+" level: "+p.level+" sn: "+p.sn),this.blockBuffers(_,s)},T.onFragChanged=function(f,i){this.flushBackBuffer()},T.onBufferEos=function(f,i){var l=this,p=this.getSourceBufferTypes().reduce(function(m,s){var c=l.sourceBuffer[s];return c&&(!i.type||i.type===s)&&(c.ending=!0,c.ended||(c.ended=!0,k.logger.log("[buffer-controller]: "+s+" sourceBuffer now EOS"))),m&&!!(!c||c.ended)},!0);p&&(k.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){l.getSourceBufferTypes().forEach(function(s){var c=l.sourceBuffer[s];c&&(c.ending=!1)});var m=l.mediaSource;if(!m||m.readyState!=="open"){m&&k.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+m.readyState);return}k.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),m.endOfStream()}))},T.onLevelUpdated=function(f,i){var l=i.details;!l.fragments.length||(this.details=l,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},T.flushBackBuffer=function(){var f=this.hls,i=this.details,l=this.media,p=this.sourceBuffer;if(!(!l||i===null)){var m=this.getSourceBufferTypes();if(!!m.length){var s=i.live&&f.config.liveBackBufferLength!==null?f.config.liveBackBufferLength:f.config.backBufferLength;if(!(!(0,w.isFiniteNumber)(s)||s<0)){var c=l.currentTime,_=i.levelTargetDuration,u=Math.max(s,_),o=Math.floor(c/_)*_-u;m.forEach(function(n){var g=p[n];if(g){var r=W.BufferHelper.getBuffered(g);if(r.length>0&&o>r.start(0)){if(f.trigger(S.Events.BACK_BUFFER_REACHED,{bufferEnd:o}),i.live)f.trigger(S.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:o});else if(g.ended&&r.end(r.length-1)-c<_*2){k.logger.info("[buffer-controller]: Cannot flush "+n+" back buffer while SourceBuffer is in ended state");return}f.trigger(S.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:o,type:n})}}})}}}},T.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var f=this.details,i=this.hls,l=this.media,p=this.mediaSource,m=f.fragments[0].start+f.totalduration,s=l.duration,c=(0,w.isFiniteNumber)(p.duration)?p.duration:0;f.live&&i.config.liveDurationInfinity?(k.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),p.duration=1/0,this.updateSeekableRange(f)):(m>c&&m>s||!(0,w.isFiniteNumber)(s))&&(k.logger.log("[buffer-controller]: Updating Media Source duration to "+m.toFixed(3)),p.duration=m)}},T.updateSeekableRange=function(f){var i=this.mediaSource,l=f.fragments,p=l.length;if(p&&f.live&&i!==null&&i!==void 0&&i.setLiveSeekableRange){var m=Math.max(0,l[0].start),s=Math.max(m,m+f.totalduration);i.setLiveSeekableRange(m,s)}},T.checkPendingTracks=function(){var f=this.bufferCodecEventsExpected,i=this.operationQueue,l=this.pendingTracks,p=Object.keys(l).length;if(p&&!f||p===2){this.createSourceBuffers(l),this.pendingTracks={};var m=this.getSourceBufferTypes();if(m.length===0){this.hls.trigger(S.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}m.forEach(function(s){i.executeNext(s)})}},T.createSourceBuffers=function(f){var i=this.sourceBuffer,l=this.mediaSource;if(!l)throw Error("createSourceBuffers called when mediaSource was null");var p=0;for(var m in f)if(!i[m]){var s=f[m];if(!s)throw Error("source buffer exists for track "+m+", however track does not");var c=s.levelCodec||s.codec,_=s.container+";codecs="+c;k.logger.log("[buffer-controller]: creating sourceBuffer("+_+")");try{var u=i[m]=l.addSourceBuffer(_),o=m;this.addBufferListener(o,"updatestart",this._onSBUpdateStart),this.addBufferListener(o,"updateend",this._onSBUpdateEnd),this.addBufferListener(o,"error",this._onSBUpdateError),this.tracks[m]={buffer:u,codec:c,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id},p++}catch(n){k.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+n.message),this.hls.trigger(S.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:n,mimeType:_})}}p&&this.hls.trigger(S.Events.BUFFER_CREATED,{tracks:this.tracks})},T._onSBUpdateStart=function(f){var i=this.operationQueue,l=i.current(f);l.onStart()},T._onSBUpdateEnd=function(f){var i=this.operationQueue,l=i.current(f);l.onComplete(),i.shiftAndExecuteNext(f)},T._onSBUpdateError=function(f,i){k.logger.error("[buffer-controller]: "+f+" SourceBuffer error",i),this.hls.trigger(S.Events.ERROR,{type:R.ErrorTypes.MEDIA_ERROR,details:R.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var l=this.operationQueue.current(f);l&&l.onError(i)},T.removeExecutor=function(f,i,l){var p=this.media,m=this.mediaSource,s=this.operationQueue,c=this.sourceBuffer,_=c[f];if(!p||!m||!_){k.logger.warn("[buffer-controller]: Attempting to remove from the "+f+" SourceBuffer, but it does not exist"),s.shiftAndExecuteNext(f);return}var u=(0,w.isFiniteNumber)(p.duration)?p.duration:1/0,o=(0,w.isFiniteNumber)(m.duration)?m.duration:1/0,n=Math.max(0,i),g=Math.min(l,u,o);g>n&&!_.ending?(_.ended=!1,k.logger.log("[buffer-controller]: Removing ["+n+","+g+"] from the "+f+" SourceBuffer"),console.assert(!_.updating,f+" sourceBuffer must not be updating"),_.remove(n,g)):s.shiftAndExecuteNext(f)},T.appendExecutor=function(f,i){var l=this.operationQueue,p=this.sourceBuffer,m=p[i];if(!m){k.logger.warn("[buffer-controller]: Attempting to append to the "+i+" SourceBuffer, but it does not exist"),l.shiftAndExecuteNext(i);return}m.ended=!1,console.assert(!m.updating,i+" sourceBuffer must not be updating"),m.appendBuffer(f)},T.blockBuffers=function(f,i){var l=this;if(i===void 0&&(i=this.getSourceBufferTypes()),!i.length){k.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(f);return}var p=this.operationQueue,m=i.map(function(s){return p.appendBlocker(s)});Promise.all(m).then(function(){f(),i.forEach(function(s){var c=l.sourceBuffer[s];(!c||!c.updating)&&p.shiftAndExecuteNext(s)})})},T.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},T.addBufferListener=function(f,i,l){var p=this.sourceBuffer[f];if(!!p){var m=l.bind(this,f);this.listeners[f].push({event:i,listener:m}),p.addEventListener(i,m)}},T.removeBufferListeners=function(f){var i=this.sourceBuffer[f];!i||this.listeners[f].forEach(function(l){i.removeEventListener(l.event,l.listener)})},D}()},"./src/controller/buffer-operation-queue.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>S});var w=v("./src/utils/logger.ts"),S=function(){function k(W){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=W}var R=k.prototype;return R.append=function(C,I){var b=this.queues[I];b.push(C),b.length===1&&this.buffers[I]&&this.executeNext(I)},R.insertAbort=function(C,I){var b=this.queues[I];b.unshift(C),this.executeNext(I)},R.appendBlocker=function(C){var I,b=new Promise(function(A){I=A}),L={execute:I,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(L,C),b},R.executeNext=function(C){var I=this.buffers,b=this.queues,L=I[C],A=b[C];if(A.length){var h=A[0];try{h.execute()}catch(D){w.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),h.onError(D),(!L||!L.updating)&&(A.shift(),this.executeNext(C))}}},R.shiftAndExecuteNext=function(C){this.queues[C].shift(),this.executeNext(C)},R.current=function(C){return this.queues[C][0]},k}()},"./src/controller/cap-level-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>I});var w=v("./src/events.ts");function S(b,L){for(var A=0;A<L.length;A++){var h=L[A];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(b,R(h.key),h)}}function k(b,L,A){return L&&S(b.prototype,L),A&&S(b,A),Object.defineProperty(b,"prototype",{writable:!1}),b}function R(b){var L=W(b,"string");return typeof L=="symbol"?L:String(L)}function W(b,L){if(typeof b!="object"||b===null)return b;var A=b[Symbol.toPrimitive];if(A!==void 0){var h=A.call(b,L||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(L==="string"?String:Number)(b)}var C=function(){function b(A){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=A,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var L=b.prototype;return L.setStreamController=function(h){this.streamController=h},L.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},L.registerListeners=function(){var h=this.hls;h.on(w.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),h.on(w.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),h.on(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),h.on(w.Events.BUFFER_CODECS,this.onBufferCodecs,this),h.on(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},L.unregisterListener=function(){var h=this.hls;h.off(w.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),h.off(w.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),h.off(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),h.off(w.Events.BUFFER_CODECS,this.onBufferCodecs,this),h.off(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},L.onFpsDropLevelCapping=function(h,D){b.isLevelAllowed(D.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(D.droppedLevel)},L.onMediaAttaching=function(h,D){this.media=D.media instanceof HTMLVideoElement?D.media:null,this.clientRect=null},L.onManifestParsed=function(h,D){var T=this.hls;this.restrictedLevels=[],this.firstLevel=D.firstLevel,T.config.capLevelToPlayerSize&&D.video&&this.startCapping()},L.onBufferCodecs=function(h,D){var T=this.hls;T.config.capLevelToPlayerSize&&D.video&&this.startCapping()},L.onMediaDetaching=function(){this.stopCapping()},L.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var h=this.hls.levels;if(h.length){var D=this.hls;D.autoLevelCapping=this.getMaxLevel(h.length-1),D.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=D.autoLevelCapping}}},L.getMaxLevel=function(h){var D=this,T=this.hls.levels;if(!T.length)return-1;var d=T.filter(function(f,i){return b.isLevelAllowed(i,D.restrictedLevels)&&i<=h});return this.clientRect=null,b.getMaxLevelByMediaSize(d,this.mediaWidth,this.mediaHeight)},L.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},L.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},L.getDimensions=function(){if(this.clientRect)return this.clientRect;var h=this.media,D={width:0,height:0};if(h){var T=h.getBoundingClientRect();D.width=T.width,D.height=T.height,!D.width&&!D.height&&(D.width=T.right-T.left||h.width||0,D.height=T.bottom-T.top||h.height||0)}return this.clientRect=D,D},b.isLevelAllowed=function(h,D){return D===void 0&&(D=[]),D.indexOf(h)===-1},b.getMaxLevelByMediaSize=function(h,D,T){if(!h||!h.length)return-1;for(var d=function(m,s){return s?m.width!==s.width||m.height!==s.height:!0},f=h.length-1,i=0;i<h.length;i+=1){var l=h[i];if((l.width>=D||l.height>=T)&&d(l,h[i+1])){f=i;break}}return f},k(b,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var h=1;if(!this.hls.config.ignoreDevicePixelRatio)try{h=self.devicePixelRatio}catch{}return h}}]),b}();const I=C},"./src/controller/cmcd-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>T});var w=v("./src/events.ts"),S=v("./src/types/cmcd.ts"),k=v("./src/utils/buffer-helper.ts"),R=v("./src/utils/logger.ts");function W(d,f){for(var i=0;i<f.length;i++){var l=f[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,I(l.key),l)}}function C(d,f,i){return f&&W(d.prototype,f),i&&W(d,i),Object.defineProperty(d,"prototype",{writable:!1}),d}function I(d){var f=b(d,"string");return typeof f=="symbol"?f:String(f)}function b(d,f){if(typeof d!="object"||d===null)return d;var i=d[Symbol.toPrimitive];if(i!==void 0){var l=i.call(d,f||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(d)}function L(d,f){var i=typeof Symbol!="undefined"&&d[Symbol.iterator]||d["@@iterator"];if(i)return(i=i.call(d)).next.bind(i);if(Array.isArray(d)||(i=A(d))||f&&d&&typeof d.length=="number"){i&&(d=i);var l=0;return function(){return l>=d.length?{done:!0}:{done:!1,value:d[l++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A(d,f){if(!!d){if(typeof d=="string")return h(d,f);var i=Object.prototype.toString.call(d).slice(8,-1);if(i==="Object"&&d.constructor&&(i=d.constructor.name),i==="Map"||i==="Set")return Array.from(d);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(d,f)}}function h(d,f){(f==null||f>d.length)&&(f=d.length);for(var i=0,l=new Array(f);i<f;i++)l[i]=d[i];return l}function D(){return D=Object.assign?Object.assign.bind():function(d){for(var f=1;f<arguments.length;f++){var i=arguments[f];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(d[l]=i[l])}return d},D.apply(this,arguments)}var T=function(){function d(i){var l=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){l.initialized&&(l.starved=!0),l.buffering=!0},this.onPlaying=function(){l.initialized||(l.initialized=!0),l.buffering=!1},this.applyPlaylistData=function(s){try{l.apply(s,{ot:S.CMCDObjectType.MANIFEST,su:!l.initialized})}catch(c){R.logger.warn("Could not generate manifest CMCD data.",c)}},this.applyFragmentData=function(s){try{var c=s.frag,_=l.hls.levels[c.level],u=l.getObjectType(c),o={d:c.duration*1e3,ot:u};(u===S.CMCDObjectType.VIDEO||u===S.CMCDObjectType.AUDIO||u==S.CMCDObjectType.MUXED)&&(o.br=_.bitrate/1e3,o.tb=l.getTopBandwidth(u)/1e3,o.bl=l.getBufferLength(u)),l.apply(s,o)}catch(n){R.logger.warn("Could not generate segment CMCD data.",n)}},this.hls=i;var p=this.config=i.config,m=p.cmcd;m!=null&&(p.pLoader=this.createPlaylistLoader(),p.fLoader=this.createFragmentLoader(),this.sid=m.sessionId||d.uuid(),this.cid=m.contentId,this.useHeaders=m.useHeaders===!0,this.registerListeners())}var f=d.prototype;return f.registerListeners=function(){var l=this.hls;l.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),l.on(w.Events.BUFFER_CREATED,this.onBufferCreated,this)},f.unregisterListeners=function(){var l=this.hls;l.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),l.off(w.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},f.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},f.onMediaAttached=function(l,p){this.media=p.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},f.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},f.onBufferCreated=function(l,p){var m,s;this.audioBuffer=(m=p.tracks.audio)===null||m===void 0?void 0:m.buffer,this.videoBuffer=(s=p.tracks.video)===null||s===void 0?void 0:s.buffer},f.createData=function(){var l;return{v:S.CMCDVersion,sf:S.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(l=this.media)===null||l===void 0?void 0:l.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},f.apply=function(l,p){p===void 0&&(p={}),D(p,this.createData());var m=p.ot===S.CMCDObjectType.INIT||p.ot===S.CMCDObjectType.VIDEO||p.ot===S.CMCDObjectType.MUXED;if(this.starved&&m&&(p.bs=!0,p.su=!0,this.starved=!1),p.su==null&&(p.su=this.buffering),this.useHeaders){var s=d.toHeaders(p);if(!Object.keys(s).length)return;l.headers||(l.headers={}),D(l.headers,s)}else{var c=d.toQuery(p);if(!c)return;l.url=d.appendQueryToUri(l.url,c)}},f.getObjectType=function(l){var p=l.type;if(p==="subtitle")return S.CMCDObjectType.TIMED_TEXT;if(l.sn==="initSegment")return S.CMCDObjectType.INIT;if(p==="audio")return S.CMCDObjectType.AUDIO;if(p==="main")return this.hls.audioTracks.length?S.CMCDObjectType.VIDEO:S.CMCDObjectType.MUXED},f.getTopBandwidth=function(l){var p=0,m,s=this.hls;if(l===S.CMCDObjectType.AUDIO)m=s.audioTracks;else{var c=s.maxAutoLevel,_=c>-1?c+1:s.levels.length;m=s.levels.slice(0,_)}for(var u=L(m),o;!(o=u()).done;){var n=o.value;n.bitrate>p&&(p=n.bitrate)}return p>0?p:NaN},f.getBufferLength=function(l){var p=this.hls.media,m=l===S.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!m||!p)return NaN;var s=k.BufferHelper.bufferInfo(m,p.currentTime,this.config.maxBufferHole);return s.len*1e3},f.createPlaylistLoader=function(){var l=this.config.pLoader,p=this.applyPlaylistData,m=l||this.config.loader;return function(){function s(_){this.loader=void 0,this.loader=new m(_)}var c=s.prototype;return c.destroy=function(){this.loader.destroy()},c.abort=function(){this.loader.abort()},c.load=function(u,o,n){p(u),this.loader.load(u,o,n)},C(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},f.createFragmentLoader=function(){var l=this.config.fLoader,p=this.applyFragmentData,m=l||this.config.loader;return function(){function s(_){this.loader=void 0,this.loader=new m(_)}var c=s.prototype;return c.destroy=function(){this.loader.destroy()},c.abort=function(){this.loader.abort()},c.load=function(u,o,n){p(u),this.loader.load(u,o,n)},C(s,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),s}()},d.uuid=function(){var l=URL.createObjectURL(new Blob),p=l.toString();return URL.revokeObjectURL(l),p.slice(p.lastIndexOf("/")+1)},d.serialize=function(l){for(var p=[],m=function(F){return!Number.isNaN(F)&&F!=null&&F!==""&&F!==!1},s=function(F){return Math.round(F)},c=function(F){return s(F/100)*100},_=function(F){return encodeURIComponent(F)},u={br:s,d:s,bl:c,dl:c,mtp:c,nor:_,rtp:c,tb:s},o=Object.keys(l||{}).sort(),n=L(o),g;!(g=n()).done;){var r=g.value,E=l[r];if(!!m(E)&&!(r==="v"&&E===1)&&!(r=="pr"&&E===1)){var P=u[r];P&&(E=P(E));var y=typeof E,U=void 0;r==="ot"||r==="sf"||r==="st"?U=r+"="+E:y==="boolean"?U=r:y==="number"?U=r+"="+E:U=r+"="+JSON.stringify(E),p.push(U)}}return p.join(",")},d.toHeaders=function(l){for(var p=Object.keys(l),m={},s=["Object","Request","Session","Status"],c=[{},{},{},{}],_={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},u=0,o=p;u<o.length;u++){var n=o[u],g=_[n]!=null?_[n]:1;c[g][n]=l[n]}for(var r=0;r<c.length;r++){var E=d.serialize(c[r]);E&&(m["CMCD-"+s[r]]=E)}return m},d.toQuery=function(l){return"CMCD="+encodeURIComponent(d.serialize(l))},d.appendQueryToUri=function(l,p){if(!p)return l;var m=l.includes("?")?"&":"?";return""+l+m+p},d}()},"./src/controller/eme-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>u});var w=v("./src/events.ts"),S=v("./src/errors.ts"),k=v("./src/utils/logger.ts"),R=v("./src/utils/mediakeys-helper.ts"),W=v("./src/utils/keysystem-util.ts"),C=v("./src/utils/numeric-encoding-utils.ts"),I=v("./src/loader/level-key.ts"),b=v("./src/utils/hex.ts"),L=v("./src/utils/mp4-tools.ts"),A=v("./node_modules/eventemitter3/index.js"),h=v.n(A);function D(o,n){o.prototype=Object.create(n.prototype),o.prototype.constructor=o,l(o,n)}function T(o){var n=typeof Map=="function"?new Map:void 0;return T=function(r){if(r===null||!i(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n!="undefined"){if(n.has(r))return n.get(r);n.set(r,E)}function E(){return d(r,arguments,p(this).constructor)}return E.prototype=Object.create(r.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),l(E,r)},T(o)}function d(o,n,g){return f()?d=Reflect.construct.bind():d=function(E,P,y){var U=[null];U.push.apply(U,P);var B=Function.bind.apply(E,U),F=new B;return y&&l(F,y.prototype),F},d.apply(null,arguments)}function f(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(o){return Function.toString.call(o).indexOf("[native code]")!==-1}function l(o,n){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,E){return r.__proto__=E,r},l(o,n)}function p(o){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(g){return g.__proto__||Object.getPrototypeOf(g)},p(o)}var m=3,s="[eme]",c=function(){function o(g){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=o.CDMCleanupPromise?[o.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=k.logger.debug.bind(k.logger,s),this.log=k.logger.log.bind(k.logger,s),this.warn=k.logger.warn.bind(k.logger,s),this.error=k.logger.error.bind(k.logger,s),this.hls=g,this.config=g.config,this.registerListeners()}var n=o.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},n.registerListeners=function(){this.hls.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(w.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},n.unregisterListeners=function(){this.hls.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(w.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},n.getLicenseServerUrl=function(r){var E=this.config,P=E.drmSystems,y=E.widevineLicenseUrl,U=P[r];if(U)return U.licenseUrl;if(r===R.KeySystems.WIDEVINE&&y)return y;throw new Error('no license server URL configured for key-system "'+r+'"')},n.getServerCertificateUrl=function(r){var E=this.config.drmSystems,P=E[r];if(P)return P.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+r+'"]')},n.attemptKeySystemAccess=function(r){var E=this,P=this.hls.levels,y=function(H,G,V){return!!H&&V.indexOf(H)===G},U=P.map(function(F){return F.audioCodec}).filter(y),B=P.map(function(F){return F.videoCodec}).filter(y);return U.length+B.length===0&&B.push("avc1.42e01e"),new Promise(function(F,H){var G=function V(z){var $=z.shift();E.getMediaKeysPromise($,U,B).then(function(X){return F({keySystem:$,mediaKeys:X})}).catch(function(X){z.length?V(z):X instanceof _?H(X):H(new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:X,fatal:!0},X.message))})};G(r)})},n.requestMediaKeySystemAccess=function(r,E){var P=this.config.requestMediaKeySystemAccessFunc;if(typeof P!="function"){var y="Configured requestMediaKeySystemAccess is not a function "+P;return R.requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(y="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(y))}return P(r,E)},n.getMediaKeysPromise=function(r,E,P){var y=this,U=(0,R.getSupportedMediaKeySystemConfigurations)(r,E,P,this.config.drmSystemOptions),B=this.keySystemAccessPromises[r],F=B==null?void 0:B.keySystemAccess;if(!F){this.log('Requesting encrypted media "'+r+'" key-system access with config: '+JSON.stringify(U)),F=this.requestMediaKeySystemAccess(r,U);var H=this.keySystemAccessPromises[r]={keySystemAccess:F};return F.catch(function(G){y.log('Failed to obtain access to key-system "'+r+'": '+G)}),F.then(function(G){y.log('Access for key-system "'+G.keySystem+'" obtained');var V=y.fetchServerCertificate(r);return y.log('Create media-keys for "'+r+'"'),H.mediaKeys=G.createMediaKeys().then(function(z){return y.log('Media-keys created for "'+r+'"'),V.then(function($){return $?y.setMediaKeysServerCertificate(z,r,$):z})}),H.mediaKeys.catch(function(z){y.error('Failed to create media-keys for "'+r+'"}: '+z)}),H.mediaKeys})}return F.then(function(){return B.mediaKeys})},n.createMediaKeySessionContext=function(r){var E=r.decryptdata,P=r.keySystem,y=r.mediaKeys;console.assert(!!y,"mediaKeys is defined"),this.log('Creating key-system session "'+P+'" keyId: '+b.default.hexDump(E.keyId||[]));var U=y.createSession(),B={decryptdata:E,keySystem:P,mediaKeys:y,mediaKeysSession:U,keyStatus:"status-pending"};return this.mediaKeySessions.push(B),B},n.renewKeySession=function(r){var E=r.decryptdata;if(E.pssh){var P=this.createMediaKeySessionContext(r),y=this.getKeyIdString(E),U="cenc";this.keyIdToKeySessionPromise[y]=this.generateRequestWithPreferredKeySession(P,U,E.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(r)},n.getKeyIdString=function(r){if(!r)throw new Error("Could not read keyId of undefined decryptdata");if(r.keyId===null)throw new Error("keyId is null");return b.default.hexDump(r.keyId)},n.updateKeySession=function(r,E){var P,y=r.mediaKeysSession;return this.log('Updating key-session "'+y.sessionId+'" for keyID '+b.default.hexDump(((P=r.decryptdata)===null||P===void 0?void 0:P.keyId)||[])+`
      } (data length: `+(E&&E.byteLength)+")"),y.update(E)},n.selectKeySystemFormat=function(r){var E=Object.keys(r.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+r.sn+" "+r.type+": "+r.level+") key formats "+E.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(E)),this.keyFormatPromise},n.getKeyFormatPromise=function(r){var E=this;return new Promise(function(P,y){var U=(0,R.getKeySystemsForConfig)(E.config),B=r.map(R.keySystemFormatToKeySystemDomain).filter(function(F){return!!F&&U.indexOf(F)!==-1});return E.getKeySystemSelectionPromise(B).then(function(F){var H=F.keySystem,G=(0,R.keySystemDomainToKeySystemFormat)(H);G?P(G):y(new Error('Unable to find format for key-system "'+H+'"'))}).catch(y)})},n.loadKey=function(r){var E=this,P=r.keyInfo.decryptdata,y=this.getKeyIdString(P),U="(keyId: "+y+' format: "'+P.keyFormat+'" method: '+P.method+" uri: "+P.uri+")";this.log("Starting session for key "+U);var B=this.keyIdToKeySessionPromise[y];return B||(B=this.keyIdToKeySessionPromise[y]=this.getKeySystemForKeyPromise(P).then(function(F){var H=F.keySystem,G=F.mediaKeys;return E.throwIfDestroyed(),E.log("Handle encrypted media sn: "+r.frag.sn+" "+r.frag.type+": "+r.frag.level+" using key "+U),E.attemptSetMediaKeys(H,G).then(function(){E.throwIfDestroyed();var V=E.createMediaKeySessionContext({keySystem:H,mediaKeys:G,decryptdata:P}),z="cenc";return E.generateRequestWithPreferredKeySession(V,z,P.pssh,"playlist-key")})}),B.catch(function(F){return E.handleError(F)})),B},n.throwIfDestroyed=function(r){if(!this.hls)throw new Error("invalid state")},n.handleError=function(r){!this.hls||(this.error(r.message),r instanceof _?this.hls.trigger(w.Events.ERROR,r.data):this.hls.trigger(w.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:r,fatal:!0}))},n.getKeySystemForKeyPromise=function(r){var E=this.getKeyIdString(r),P=this.keyIdToKeySessionPromise[E];if(!P){var y=(0,R.keySystemFormatToKeySystemDomain)(r.keyFormat),U=y?[y]:(0,R.getKeySystemsForConfig)(this.config);return this.attemptKeySystemAccess(U)}return P},n.getKeySystemSelectionPromise=function(r){if(r.length||(r=(0,R.getKeySystemsForConfig)(this.config)),r.length===0)throw new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(r)},n._onMediaEncrypted=function(r){var E=this,P=r.initDataType,y=r.initData;if(this.debug('"'+r.type+'" event: init data type: "'+P+'"'),y!==null){var U,B;if(P==="sinf"&&this.config.drmSystems[R.KeySystems.FAIRPLAY]){var F=(0,L.bin2str)(new Uint8Array(y));try{var H=(0,C.base64Decode)(JSON.parse(F).sinf),G=(0,L.parseSinf)(new Uint8Array(H));if(!G)return;U=G.subarray(8,24),B=R.KeySystems.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{var V=(0,L.parsePssh)(y);if(V===null)return;V.version===0&&V.systemId===R.KeySystemIds.WIDEVINE&&V.data&&(U=V.data.subarray(8,24)),B=(0,R.keySystemIdToKeySystemDomain)(V.systemId)}if(!(!B||!U)){for(var z=b.default.hexDump(U),$=this.keyIdToKeySessionPromise,X=this.mediaKeySessions,j=$[z],Y=function(ee){var ne=X[ee],te=ne.decryptdata;if(te.pssh||!te.keyId)return"continue";var q=b.default.hexDump(te.keyId);if(z===q||te.uri.replace(/-/g,"").indexOf(z)!==-1)return j=$[q],delete $[q],te.pssh=new Uint8Array(y),te.keyId=U,j=$[z]=j.then(function(){return E.generateRequestWithPreferredKeySession(ne,P,y,"encrypted-event-key-match")}),"break"},Q=0;Q<X.length;Q++){var J=Y(Q);if(J!=="continue"&&J==="break")break}j||(j=$[z]=this.getKeySystemSelectionPromise([B]).then(function(Z){var ee,ne=Z.keySystem,te=Z.mediaKeys;E.throwIfDestroyed();var q=new I.LevelKey("ISO-23001-7",z,(ee=(0,R.keySystemDomainToKeySystemFormat)(ne))!=null?ee:"");return q.pssh=new Uint8Array(y),q.keyId=U,E.attemptSetMediaKeys(ne,te).then(function(){E.throwIfDestroyed();var re=E.createMediaKeySessionContext({decryptdata:q,keySystem:ne,mediaKeys:te});return E.generateRequestWithPreferredKeySession(re,P,y,"encrypted-event-no-match")})})),j.catch(function(Z){return E.handleError(Z)})}}},n._onWaitingForKey=function(r){this.log('"'+r.type+'" event')},n.attemptSetMediaKeys=function(r,E){var P=this,y=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+r+'"');var U=Promise.all(y).then(function(){if(!P.media)throw new Error("Attempted to set mediaKeys without media element attached");return P.media.setMediaKeys(E)});return this.setMediaKeysQueue.push(U),U.then(function(){P.log('Media-keys set for "'+r+'"'),y.push(U),P.setMediaKeysQueue=P.setMediaKeysQueue.filter(function(B){return y.indexOf(B)===-1})})},n.generateRequestWithPreferredKeySession=function(r,E,P,y){var U,B,F=this,H=(U=this.config.drmSystems)===null||U===void 0||(B=U[r.keySystem])===null||B===void 0?void 0:B.generateRequest;if(H)try{var G=H.call(this.hls,E,P,r);if(!G)throw new Error("Invalid response from configured generateRequest filter");E=G.initDataType,P=r.decryptdata.pssh=G.initData?new Uint8Array(G.initData):null}catch(j){var V;if(this.warn(j.message),(V=this.hls)!==null&&V!==void 0&&V.config.debug)throw j}if(P===null)return this.log('Skipping key-session request for "'+y+'" (no initData)'),Promise.resolve(r);var z=this.getKeyIdString(r.decryptdata);this.log('Generating key-session request for "'+y+'": '+z+" (init data type: "+E+" length: "+(P?P.byteLength:null)+")");var $=new(h());r.mediaKeysSession.onmessage=function(j){var Y=r.mediaKeysSession;if(!Y){$.emit("error",new Error("invalid state"));return}var Q=j.messageType,J=j.message;F.log('"'+Q+'" message event for session "'+Y.sessionId+'" message size: '+J.byteLength),Q==="license-request"||Q==="license-renewal"?F.renewLicense(r,J).catch(function(Z){F.handleError(Z),$.emit("error",Z)}):Q==="license-release"?r.keySystem===R.KeySystems.FAIRPLAY&&(F.updateKeySession(r,(0,W.strToUtf8array)("acknowledged")),F.removeSession(r)):F.warn('unhandled media key message type "'+Q+'"')},r.mediaKeysSession.onkeystatuseschange=function(j){var Y=r.mediaKeysSession;if(!Y){$.emit("error",new Error("invalid state"));return}F.onKeyStatusChange(r);var Q=r.keyStatus;$.emit("keyStatus",Q),Q==="expired"&&(F.warn(r.keySystem+" expired for key "+z),F.renewKeySession(r))};var X=new Promise(function(j,Y){$.on("error",Y),$.on("keyStatus",function(Q){Q.startsWith("usable")?j():Q==="output-restricted"?Y(new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):Q==="internal-error"?Y(new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+Q+'"')):Q==="expired"?Y(new Error("key expired while generating request")):F.warn('unhandled key status change "'+Q+'"')})});return r.mediaKeysSession.generateRequest(E,P).then(function(){var j;F.log('Request generated for key-session "'+((j=r.mediaKeysSession)===null||j===void 0?void 0:j.sessionId)+'" keyId: '+z)}).catch(function(j){throw new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:j,fatal:!1},"Error generating key-session request: "+j)}).then(function(){return X}).catch(function(j){throw $.removeAllListeners(),F.removeSession(r),j}).then(function(){return $.removeAllListeners(),r})},n.onKeyStatusChange=function(r){var E=this;r.mediaKeysSession.keyStatuses.forEach(function(P,y){E.log('key status change "'+P+'" for keyStatuses keyId: '+b.default.hexDump("buffer"in y?new Uint8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y))+" session keyId: "+b.default.hexDump(new Uint8Array(r.decryptdata.keyId||[]))+" uri: "+r.decryptdata.uri),r.keyStatus=P})},n.fetchServerCertificate=function(r){var E=this;return new Promise(function(P,y){var U=E.getServerCertificateUrl(r);if(!U)return P();E.log('Fetching serverCertificate for "'+r+'"');var B=new XMLHttpRequest;B.open("GET",U,!0),B.responseType="arraybuffer",B.onreadystatechange=function(){B.readyState===XMLHttpRequest.DONE&&(B.status===200?P(B.response):y(new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:B},'"'+r+'" certificate request XHR failed ('+U+"). Status: "+B.status+" ("+B.statusText+")")))},B.send()})},n.setMediaKeysServerCertificate=function(r,E,P){var y=this;return new Promise(function(U,B){r.setServerCertificate(P).then(function(F){y.log("setServerCertificate "+(F?"success":"not supported by CDM")+" ("+(P==null?void 0:P.byteLength)+') on "'+E+'"'),U(r)}).catch(function(F){B(new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:F,fatal:!0},F.message))})})},n.renewLicense=function(r,E){var P=this;return this.requestLicense(r,new Uint8Array(E)).then(function(y){return P.updateKeySession(r,new Uint8Array(y)).catch(function(U){throw new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:U,fatal:!0},U.message)})})},n.setupLicenseXHR=function(r,E,P,y){var U=this,B=this.config.licenseXhrSetup;return B?Promise.resolve().then(function(){if(!P.decryptdata)throw new Error("Key removed");return B.call(U.hls,r,E,P,y)}).catch(function(F){if(!P.decryptdata)throw F;return r.open("POST",E,!0),B.call(U.hls,r,E,P,y)}).then(function(F){r.readyState||r.open("POST",E,!0);var H=F||y;return{xhr:r,licenseChallenge:H}}):(r.open("POST",E,!0),Promise.resolve({xhr:r,licenseChallenge:y}))},n.requestLicense=function(r,E){var P=this;return new Promise(function(y,U){var B=P.getLicenseServerUrl(r.keySystem);P.log("Sending license request to URL: "+B);var F=new XMLHttpRequest;F.responseType="arraybuffer",F.onreadystatechange=function(){if(!P.hls||!r.mediaKeysSession)return U(new Error("invalid state"));if(F.readyState===4)if(F.status===200){P._requestLicenseFailureCount=0;var H=F.response;P.log("License received "+(H instanceof ArrayBuffer?H.byteLength:H));var G=P.config.licenseResponseCallback;if(G)try{H=G.call(P.hls,F,B,r)}catch(z){P.error(z)}y(H)}else if(P._requestLicenseFailureCount++,P._requestLicenseFailureCount>m||F.status>=400&&F.status<500)U(new _({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:F},"License Request XHR failed ("+B+"). Status: "+F.status+" ("+F.statusText+")"));else{var V=m-P._requestLicenseFailureCount+1;P.warn("Retrying license request, "+V+" attempts left"),P.requestLicense(r,E).then(y,U)}},r.licenseXhr&&r.licenseXhr.readyState!==XMLHttpRequest.DONE&&r.licenseXhr.abort(),r.licenseXhr=F,P.setupLicenseXHR(F,B,r,E).then(function(H){var G=H.xhr,V=H.licenseChallenge;G.send(V)})})},n.onMediaAttached=function(r,E){if(!!this.config.emeEnabled){var P=E.media;this.media=P,P.addEventListener("encrypted",this.onMediaEncrypted),P.addEventListener("waitingforkey",this.onWaitingForKey)}},n.onMediaDetached=function(){var r=this,E=this.media,P=this.mediaKeySessions;E&&(E.removeEventListener("encrypted",this.onMediaEncrypted),E.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},I.LevelKey.clearKeyUriToKeyIdMap();var y=P.length;o.CDMCleanupPromise=Promise.all(P.map(function(U){return r.removeSession(U)}).concat(E==null?void 0:E.setMediaKeys(null).catch(function(U){r.log("Could not clear media keys: "+U+". media.src: "+(E==null?void 0:E.src))}))).then(function(){y&&(r.log("finished closing key sessions and clearing media keys"),P.length=0)}).catch(function(U){r.log("Could not close sessions and clear media keys: "+U+". media.src: "+(E==null?void 0:E.src))})},n.onManifestLoaded=function(r,E){var P=E.sessionKeys;if(!(!P||!this.config.emeEnabled)&&!this.keyFormatPromise){var y=P.reduce(function(U,B){return U.indexOf(B.keyFormat)===-1&&U.push(B.keyFormat),U},[]);this.log("Selecting key-system from session-keys "+y.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(y)}},n.removeSession=function(r){var E=this,P=r.mediaKeysSession,y=r.licenseXhr;if(P){this.log("Remove licenses and keys and close session "+P.sessionId),P.onmessage=null,P.onkeystatuseschange=null,y&&y.readyState!==XMLHttpRequest.DONE&&y.abort(),r.mediaKeysSession=r.decryptdata=r.licenseXhr=void 0;var U=this.mediaKeySessions.indexOf(r);return U>-1&&this.mediaKeySessions.splice(U,1),P.remove().catch(function(B){E.log("Could not remove session: "+B)}).then(function(){return P.close()}).catch(function(B){E.log("Could not close session: "+B)})}},o}();c.CDMCleanupPromise=void 0;var _=function(o){D(n,o);function n(g,r){var E;return E=o.call(this,r)||this,E.data=void 0,E.data=g,g.err=g.error,E}return n}(T(Error));const u=c},"./src/controller/fps-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>R});var w=v("./src/events.ts"),S=v("./src/utils/logger.ts"),k=function(){function W(I){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=I,this.registerListeners()}var C=W.prototype;return C.setStreamController=function(b){this.streamController=b},C.registerListeners=function(){this.hls.on(w.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},C.unregisterListeners=function(){this.hls.off(w.Events.MEDIA_ATTACHING,this.onMediaAttaching)},C.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},C.onMediaAttaching=function(b,L){var A=this.hls.config;if(A.capLevelOnFPSDrop){var h=L.media instanceof self.HTMLVideoElement?L.media:null;this.media=h,h&&typeof h.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),A.fpsDroppedMonitoringPeriod)}},C.checkFPS=function(b,L,A){var h=performance.now();if(L){if(this.lastTime){var D=h-this.lastTime,T=A-this.lastDroppedFrames,d=L-this.lastDecodedFrames,f=1e3*T/D,i=this.hls;if(i.trigger(w.Events.FPS_DROP,{currentDropped:T,currentDecoded:d,totalDroppedFrames:A}),f>0&&T>i.config.fpsDroppedMonitoringThreshold*d){var l=i.currentLevel;S.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+l),l>0&&(i.autoLevelCapping===-1||i.autoLevelCapping>=l)&&(l=l-1,i.trigger(w.Events.FPS_DROP_LEVEL_CAPPING,{level:l,droppedLevel:i.currentLevel}),i.autoLevelCapping=l,this.streamController.nextLevelSwitch())}}this.lastTime=h,this.lastDroppedFrames=A,this.lastDecodedFrames=L}},C.checkFPSInterval=function(){var b=this.media;if(b)if(this.isVideoPlaybackQualityAvailable){var L=b.getVideoPlaybackQuality();this.checkFPS(b,L.totalVideoFrames,L.droppedVideoFrames)}else this.checkFPS(b,b.webkitDecodedFrameCount,b.webkitDroppedFrameCount)},W}();const R=k},"./src/controller/fragment-finders.ts":(N,O,v)=>{v.r(O),v.d(O,{findFragWithCC:()=>I,findFragmentByPDT:()=>k,findFragmentByPTS:()=>R,fragmentWithinToleranceTest:()=>W,pdtWithinToleranceTest:()=>C});var w=v("./src/polyfills/number.ts"),S=v("./src/utils/binary-search.ts");function k(b,L,A){if(L===null||!Array.isArray(b)||!b.length||!(0,w.isFiniteNumber)(L))return null;var h=b[0].programDateTime;if(L<(h||0))return null;var D=b[b.length-1].endProgramDateTime;if(L>=(D||0))return null;A=A||0;for(var T=0;T<b.length;++T){var d=b[T];if(C(L,A,d))return d}return null}function R(b,L,A,h){A===void 0&&(A=0),h===void 0&&(h=0);var D=null;if(b?D=L[b.sn-L[0].sn+1]||null:A===0&&L[0].start===0&&(D=L[0]),D&&W(A,h,D)===0)return D;var T=S.default.search(L,W.bind(null,A,h));return T&&(T!==b||!D)?T:D}function W(b,L,A){if(b===void 0&&(b=0),L===void 0&&(L=0),A.start<=b&&A.start+A.duration>b)return 0;var h=Math.min(L,A.duration+(A.deltaPTS?A.deltaPTS:0));return A.start+A.duration-h<=b?1:A.start-h>b&&A.start?-1:0}function C(b,L,A){var h=Math.min(L,A.duration+(A.deltaPTS?A.deltaPTS:0))*1e3,D=A.endProgramDateTime||0;return D-h>b}function I(b,L){return S.default.search(b,function(A){return A.cc<L?1:A.cc>L?-1:0})}},"./src/controller/fragment-tracker.ts":(N,O,v)=>{v.r(O),v.d(O,{FragmentState:()=>k,FragmentTracker:()=>R});var w=v("./src/events.ts"),S=v("./src/types/loader.ts"),k;(function(I){I.NOT_LOADED="NOT_LOADED",I.APPENDING="APPENDING",I.PARTIAL="PARTIAL",I.OK="OK"})(k||(k={}));var R=function(){function I(L){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=L,this._registerListeners()}var b=I.prototype;return b._registerListeners=function(){var A=this.hls;A.on(w.Events.BUFFER_APPENDED,this.onBufferAppended,this),A.on(w.Events.FRAG_BUFFERED,this.onFragBuffered,this),A.on(w.Events.FRAG_LOADED,this.onFragLoaded,this)},b._unregisterListeners=function(){var A=this.hls;A.off(w.Events.BUFFER_APPENDED,this.onBufferAppended,this),A.off(w.Events.FRAG_BUFFERED,this.onFragBuffered,this),A.off(w.Events.FRAG_LOADED,this.onFragLoaded,this)},b.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},b.getAppendedFrag=function(A,h){if(h===S.PlaylistLevelType.MAIN){var D=this.activeFragment,T=this.activeParts;if(!D)return null;if(T)for(var d=T.length;d--;){var f=T[d],i=f?f.end:D.appendedPTS;if(f.start<=A&&i!==void 0&&A<=i)return d>9&&(this.activeParts=T.slice(d-9)),f}else if(D.start<=A&&D.appendedPTS!==void 0&&A<=D.appendedPTS)return D}return this.getBufferedFrag(A,h)},b.getBufferedFrag=function(A,h){for(var D=this.fragments,T=Object.keys(D),d=T.length;d--;){var f=D[T[d]];if((f==null?void 0:f.body.type)===h&&f.buffered){var i=f.body;if(i.start<=A&&A<=i.end)return i}}return null},b.detectEvictedFragments=function(A,h,D){var T=this;this.timeRanges&&(this.timeRanges[A]=h),Object.keys(this.fragments).forEach(function(d){var f=T.fragments[d];if(!!f){if(!f.buffered&&!f.loaded){f.body.type===D&&T.removeFragment(f.body);return}var i=f.range[A];!i||i.time.some(function(l){var p=!T.isTimeBuffered(l.startPTS,l.endPTS,h);return p&&T.removeFragment(f.body),p})}})},b.detectPartialFragments=function(A){var h=this,D=this.timeRanges,T=A.frag,d=A.part;if(!(!D||T.sn==="initSegment")){var f=C(T),i=this.fragments[f];!i||(Object.keys(D).forEach(function(l){var p=T.elementaryStreams[l];if(!!p){var m=D[l],s=d!==null||p.partial===!0;i.range[l]=h.getBufferedTimes(T,d,s,m)}}),i.loaded=null,Object.keys(i.range).length?(i.buffered=!0,i.body.endList&&(this.endListFragments[i.body.type]=i)):this.removeFragment(i.body))}},b.fragBuffered=function(A){var h=C(A),D=this.fragments[h];D&&(D.loaded=null,D.buffered=!0)},b.getBufferedTimes=function(A,h,D,T){for(var d={time:[],partial:D},f=h?h.start:A.start,i=h?h.end:A.end,l=A.minEndPTS||i,p=A.maxStartPTS||f,m=0;m<T.length;m++){var s=T.start(m)-this.bufferPadding,c=T.end(m)+this.bufferPadding;if(p>=s&&l<=c){d.time.push({startPTS:Math.max(f,T.start(m)),endPTS:Math.min(i,T.end(m))});break}else if(f<c&&i>s)d.partial=!0,d.time.push({startPTS:Math.max(f,T.start(m)),endPTS:Math.min(i,T.end(m))});else if(i<=s)break}return d},b.getPartialFragment=function(A){var h=null,D,T,d,f=0,i=this.bufferPadding,l=this.fragments;return Object.keys(l).forEach(function(p){var m=l[p];!m||W(m)&&(T=m.body.start-i,d=m.body.end+i,A>=T&&A<=d&&(D=Math.min(A-T,d-A),f<=D&&(h=m.body,f=D)))}),h},b.isEndListAppended=function(A){var h=this.endListFragments[A];return h!==void 0&&(h.buffered||W(h))},b.getState=function(A){var h=C(A),D=this.fragments[h];return D?D.buffered?W(D)?k.PARTIAL:k.OK:k.APPENDING:k.NOT_LOADED},b.isTimeBuffered=function(A,h,D){for(var T,d,f=0;f<D.length;f++){if(T=D.start(f)-this.bufferPadding,d=D.end(f)+this.bufferPadding,A>=T&&h<=d)return!0;if(h<=T)return!1}return!1},b.onFragLoaded=function(A,h){var D=h.frag,T=h.part;if(!(D.sn==="initSegment"||D.bitrateTest||T)){var d=C(D);this.fragments[d]={body:D,loaded:h,buffered:!1,range:Object.create(null)}}},b.onBufferAppended=function(A,h){var D=this,T=h.frag,d=h.part,f=h.timeRanges;if(T.type===S.PlaylistLevelType.MAIN)if(this.activeFragment!==T&&(this.activeFragment=T,T.appendedPTS=void 0),d){var i=this.activeParts;i||(this.activeParts=i=[]),i.push(d)}else this.activeParts=null;this.timeRanges=f,Object.keys(f).forEach(function(l){var p=f[l];if(D.detectEvictedFragments(l,p),!d&&T.type===S.PlaylistLevelType.MAIN){var m=T.elementaryStreams[l];if(!m)return;for(var s=0;s<p.length;s++){var c=p.end(s);c<=m.endPTS&&c>m.startPTS?T.appendedPTS=Math.max(c,T.appendedPTS||0):T.appendedPTS=m.endPTS}}})},b.onFragBuffered=function(A,h){this.detectPartialFragments(h)},b.hasFragment=function(A){var h=C(A);return!!this.fragments[h]},b.removeFragmentsInRange=function(A,h,D){var T=this;Object.keys(this.fragments).forEach(function(d){var f=T.fragments[d];if(!!f&&f.buffered){var i=f.body;i.type===D&&i.start<h&&i.end>A&&T.removeFragment(i)}})},b.removeFragment=function(A){var h=C(A);A.stats.loaded=0,A.clearElementaryStreamInfo(),A.appendedPTS=void 0,delete this.fragments[h],A.endList&&delete this.endListFragments[A.type]},b.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},I}();function W(I){var b,L;return I.buffered&&(((b=I.range.video)===null||b===void 0?void 0:b.partial)||((L=I.range.audio)===null||L===void 0?void 0:L.partial))}function C(I){return I.type+"_"+I.level+"_"+I.urlId+"_"+I.sn}},"./src/controller/gap-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{MAX_START_GAP_JUMP:()=>C,SKIP_BUFFER_HOLE_STEP_SECONDS:()=>I,SKIP_BUFFER_RANGE_START:()=>b,STALL_MINIMUM_DURATION_MS:()=>W,default:()=>L});var w=v("./src/utils/buffer-helper.ts"),S=v("./src/errors.ts"),k=v("./src/events.ts"),R=v("./src/utils/logger.ts"),W=250,C=2,I=.1,b=.05,L=function(){function A(D,T,d,f){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=D,this.media=T,this.fragmentTracker=d,this.hls=f}var h=A.prototype;return h.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},h.poll=function(T,d){var f=this.config,i=this.media,l=this.stalled;if(i!==null){var p=i.currentTime,m=i.seeking,s=this.seeking&&!m,c=!this.seeking&&m;if(this.seeking=m,p!==T){if(this.moved=!0,l!==null){if(this.stallReported){var _=self.performance.now()-l;R.logger.warn("playback not stuck anymore @"+p+", after "+Math.round(_)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((c||s)&&(this.stalled=null),!(i.paused&&!m||i.ended||i.playbackRate===0||!w.BufferHelper.getBuffered(i).length)){var u=w.BufferHelper.bufferInfo(i,p,0),o=u.len>0,n=u.nextStart||0;if(!(!o&&!n)){if(m){var g=u.len>C,r=!n||d&&d.start<=p||n-p>C&&!this.fragmentTracker.getPartialFragment(p);if(g||r)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var E,P=Math.max(n,u.start||0)-p,y=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,U=y==null||(E=y.details)===null||E===void 0?void 0:E.live,B=U?y.details.targetduration*2:C;if(P>0&&P<=B){this._trySkipBufferHole(null);return}}var F=self.performance.now();if(l===null){this.stalled=F;return}var H=F-l;if(!(!m&&H>=W&&(this._reportStall(u),!this.media))){var G=w.BufferHelper.bufferInfo(i,p,f.maxBufferHole);this._tryFixBufferStall(G,H)}}}}},h._tryFixBufferStall=function(T,d){var f=this.config,i=this.fragmentTracker,l=this.media;if(l!==null){var p=l.currentTime,m=i.getPartialFragment(p);if(m){var s=this._trySkipBufferHole(m);if(s||!this.media)return}T.len>f.maxBufferHole&&d>f.highBufferWatchdogPeriod*1e3&&(R.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},h._reportStall=function(T){var d=this.hls,f=this.media,i=this.stallReported;!i&&f&&(this.stallReported=!0,R.logger.warn("Playback stalling at @"+f.currentTime+" due to low buffer ("+JSON.stringify(T)+")"),d.trigger(k.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:T.len}))},h._trySkipBufferHole=function(T){var d=this.config,f=this.hls,i=this.media;if(i===null)return 0;for(var l=i.currentTime,p=0,m=w.BufferHelper.getBuffered(i),s=0;s<m.length;s++){var c=m.start(s);if(l+d.maxBufferHole>=p&&l<c){var _=Math.max(c+b,i.currentTime+I);return R.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+_),this.moved=!0,this.stalled=null,i.currentTime=_,T&&f.trigger(k.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+_,frag:T}),_}p=m.end(s)}return 0},h._tryNudgeBuffer=function(){var T=this.config,d=this.hls,f=this.media,i=this.nudgeRetry;if(f!==null){var l=f.currentTime;if(this.nudgeRetry++,i<T.nudgeMaxRetry){var p=l+(i+1)*T.nudgeOffset;R.logger.warn("Nudging 'currentTime' from "+l+" to "+p),f.currentTime=p,d.trigger(k.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else R.logger.error("Playhead still not moving while enough data buffered @"+l+" after "+T.nudgeMaxRetry+" nudges"),d.trigger(k.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},A}()},"./src/controller/id3-track-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>T});var w=v("./src/polyfills/number.ts"),S=v("./src/events.ts"),k=v("./src/utils/texttrack-utils.ts"),R=v("./src/demux/id3.ts"),W=v("./src/loader/date-range.ts"),C=v("./src/types/demuxer.ts"),I=.25;function b(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var L=function(){var d=b();try{new d(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function A(d,f){return d.getTime()/1e3-f}function h(d){return Uint8Array.from(d.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var D=function(){function d(i){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=i,this._registerListeners()}var f=d.prototype;return f.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},f._registerListeners=function(){var l=this.hls;l.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),l.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),l.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},f._unregisterListeners=function(){var l=this.hls;l.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),l.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),l.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},f.onMediaAttached=function(l,p){this.media=p.media},f.onMediaDetaching=function(){!this.id3Track||((0,k.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},f.onManifestLoading=function(){this.dateRangeCuesAppended={}},f.createTrack=function(l){var p=this.getID3Track(l.textTracks);return p.mode="hidden",p},f.getID3Track=function(l){if(!!this.media){for(var p=0;p<l.length;p++){var m=l[p];if(m.kind==="metadata"&&m.label==="id3")return(0,k.sendAddTrackEvent)(m,this.media),m}return this.media.addTextTrack("metadata","id3")}},f.onFragParsingMetadata=function(l,p){if(!!this.media){var m=this.hls.config,s=m.enableEmsgMetadataCues,c=m.enableID3MetadataCues;if(!(!s&&!c)){var _=p.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var u=b(),o=0;o<_.length;o++){var n=_[o].type;if(!(n===C.MetadataSchema.emsg&&!s||!c)){var g=R.getID3Frames(_[o].data);if(g){var r=_[o].pts,E=r+_[o].duration;E>L&&(E=L);var P=E-r;P<=0&&(E=r+I);for(var y=0;y<g.length;y++){var U=g[y];if(!R.isTimeStampFrame(U)){this.updateId3CueEnds(r);var B=new u(r,E,"");B.value=U,n&&(B.type=n),this.id3Track.addCue(B)}}}}}}}},f.updateId3CueEnds=function(l){var p,m=(p=this.id3Track)===null||p===void 0?void 0:p.cues;if(m)for(var s=m.length;s--;){var c=m[s];c.startTime<l&&c.endTime===L&&(c.endTime=l)}},f.onBufferFlushing=function(l,p){var m=p.startOffset,s=p.endOffset,c=p.type,_=this.id3Track,u=this.hls;if(!!u){var o=u.config,n=o.enableEmsgMetadataCues,g=o.enableID3MetadataCues;if(_&&(n||g)){var r;c==="audio"?r=function(P){return P.type===C.MetadataSchema.audioId3&&g}:c==="video"?r=function(P){return P.type===C.MetadataSchema.emsg&&n}:r=function(P){return P.type===C.MetadataSchema.audioId3&&g||P.type===C.MetadataSchema.emsg&&n},(0,k.removeCuesInRange)(_,m,s,r)}}},f.onLevelUpdated=function(l,p){var m=this,s=p.details;if(!(!this.media||!s.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var c=this.dateRangeCuesAppended,_=this.id3Track,u=s.dateRanges,o=Object.keys(u);if(_)for(var n=Object.keys(c).filter(function(F){return!o.includes(F)}),g=function(H){var G=n[H];Object.keys(c[G].cues).forEach(function(V){_.removeCue(c[G].cues[V])}),delete c[G]},r=n.length;r--;)g(r);var E=s.fragments[s.fragments.length-1];if(!(o.length===0||!(0,w.isFiniteNumber)(E==null?void 0:E.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var P=E.programDateTime/1e3-E.start,y=b(),U=function(H){var G=o[H],V=u[G],z=c[G],$=(z==null?void 0:z.cues)||{},X=(z==null?void 0:z.durationKnown)||!1,j=A(V.startDate,P),Y=L,Q=V.endDate;if(Q)Y=A(Q,P),X=!0;else if(V.endOnNext&&!X){var J=o.reduce(function(re,se){var ie=u[se];return ie.class===V.class&&ie.id!==se&&ie.startDate>V.startDate&&re.push(ie),re},[]).sort(function(re,se){return re.startDate.getTime()-se.startDate.getTime()})[0];J&&(Y=A(J.startDate,P),X=!0)}for(var Z=Object.keys(V.attr),ee=0;ee<Z.length;ee++){var ne=Z[ee];if(!(ne===W.DateRangeAttribute.ID||ne===W.DateRangeAttribute.CLASS||ne===W.DateRangeAttribute.START_DATE||ne===W.DateRangeAttribute.DURATION||ne===W.DateRangeAttribute.END_DATE||ne===W.DateRangeAttribute.END_ON_NEXT)){var te=$[ne];if(te)X&&!z.durationKnown&&(te.endTime=Y);else{var q=V.attr[ne];te=new y(j,Y,""),(ne===W.DateRangeAttribute.SCTE35_OUT||ne===W.DateRangeAttribute.SCTE35_IN)&&(q=h(q)),te.value={key:ne,data:q},te.type=C.MetadataSchema.dateRange,m.id3Track.addCue(te),$[ne]=te}}}c[G]={cues:$,dateRange:V,durationKnown:X}},B=0;B<o.length;B++)U(B)}}},d}();const T=D},"./src/controller/latency-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>b});var w=v("./src/errors.ts"),S=v("./src/events.ts"),k=v("./src/utils/logger.ts");function R(L,A){for(var h=0;h<A.length;h++){var D=A[h];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(L,C(D.key),D)}}function W(L,A,h){return A&&R(L.prototype,A),h&&R(L,h),Object.defineProperty(L,"prototype",{writable:!1}),L}function C(L){var A=I(L,"string");return typeof A=="symbol"?A:String(A)}function I(L,A){if(typeof L!="object"||L===null)return L;var h=L[Symbol.toPrimitive];if(h!==void 0){var D=h.call(L,A||"default");if(typeof D!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(L)}var b=function(){function L(h){var D=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return D.timeupdate()},this.hls=h,this.config=h.config,this.registerListeners()}var A=L.prototype;return A.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},A.registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(S.Events.ERROR,this.onError,this)},A.unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(S.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(S.Events.ERROR,this.onError)},A.onMediaAttached=function(D,T){this.media=T.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},A.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},A.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},A.onLevelUpdated=function(D,T){var d=T.details;this.levelDetails=d,d.advanced&&this.timeupdate(),!d.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},A.onError=function(D,T){T.details===w.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,k.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},A.timeupdate=function(){var D=this.media,T=this.levelDetails;if(!(!D||!T)){this.currentTime=D.currentTime;var d=this.computeLatency();if(d!==null){this._latency=d;var f=this.config,i=f.lowLatencyMode,l=f.maxLiveSyncPlaybackRate;if(!(!i||l===1)){var p=this.targetLatency;if(p!==null){var m=d-p,s=Math.min(this.maxLatency,p+T.targetduration),c=m<s;if(T.live&&c&&m>.05&&this.forwardBufferLength>1){var _=Math.min(2,Math.max(1,l)),u=Math.round(2/(1+Math.exp(-.75*m-this.edgeStalled))*20)/20;D.playbackRate=Math.min(_,Math.max(1,u))}else D.playbackRate!==1&&D.playbackRate!==0&&(D.playbackRate=1)}}}}},A.estimateLiveEdge=function(){var D=this.levelDetails;return D===null?null:D.edge+D.age},A.computeLatency=function(){var D=this.estimateLiveEdge();return D===null?null:D-this.currentTime},W(L,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var D=this.config,T=this.levelDetails;return D.liveMaxLatencyDuration!==void 0?D.liveMaxLatencyDuration:T?D.liveMaxLatencyDurationCount*T.targetduration:0}},{key:"targetLatency",get:function(){var D=this.levelDetails;if(D===null)return null;var T=D.holdBack,d=D.partHoldBack,f=D.targetduration,i=this.config,l=i.liveSyncDuration,p=i.liveSyncDurationCount,m=i.lowLatencyMode,s=this.hls.userConfig,c=m&&d||T;(s.liveSyncDuration||s.liveSyncDurationCount||c===0)&&(c=l!==void 0?l:p*f);var _=f,u=1;return c+Math.min(this.stallCount*u,_)}},{key:"liveSyncPosition",get:function(){var D=this.estimateLiveEdge(),T=this.targetLatency,d=this.levelDetails;if(D===null||T===null||d===null)return null;var f=d.edge,i=D-T-this.edgeStalled,l=f-d.totalduration,p=f-(this.config.lowLatencyMode&&d.partTarget||d.targetduration);return Math.min(Math.max(l,i),p)}},{key:"drift",get:function(){var D=this.levelDetails;return D===null?1:D.drift}},{key:"edgeStalled",get:function(){var D=this.levelDetails;if(D===null)return 0;var T=(this.config.lowLatencyMode&&D.partTarget||D.targetduration)*3;return Math.max(D.age-T,0)}},{key:"forwardBufferLength",get:function(){var D=this.media,T=this.levelDetails;if(!D||!T)return 0;var d=D.buffered.length;return(d?D.buffered.end(d-1):T.edge)-this.currentTime}}]),L}()},"./src/controller/level-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>i});var w=v("./src/types/level.ts"),S=v("./src/events.ts"),k=v("./src/errors.ts"),R=v("./src/utils/codecs.ts"),W=v("./src/controller/level-helper.ts"),C=v("./src/controller/base-playlist-controller.ts"),I=v("./src/types/loader.ts");function b(){return b=Object.assign?Object.assign.bind():function(l){for(var p=1;p<arguments.length;p++){var m=arguments[p];for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&(l[s]=m[s])}return l},b.apply(this,arguments)}function L(l,p){for(var m=0;m<p.length;m++){var s=p[m];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(l,h(s.key),s)}}function A(l,p,m){return p&&L(l.prototype,p),m&&L(l,m),Object.defineProperty(l,"prototype",{writable:!1}),l}function h(l){var p=D(l,"string");return typeof p=="symbol"?p:String(p)}function D(l,p){if(typeof l!="object"||l===null)return l;var m=l[Symbol.toPrimitive];if(m!==void 0){var s=m.call(l,p||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(l)}function T(l,p){l.prototype=Object.create(p.prototype),l.prototype.constructor=l,d(l,p)}function d(l,p){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},d(l,p)}var f=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i=function(l){T(p,l);function p(s){var c;return c=l.call(this,s,"[level-controller]")||this,c._levels=[],c._firstLevel=-1,c._startLevel=void 0,c.currentLevelIndex=-1,c.manualLevelIndex=-1,c.onParsedComplete=void 0,c._registerListeners(),c}var m=p.prototype;return m._registerListeners=function(){var c=this.hls;c.on(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),c.on(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(S.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),c.on(S.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(S.Events.ERROR,this.onError,this)},m._unregisterListeners=function(){var c=this.hls;c.off(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),c.off(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(S.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),c.off(S.Events.FRAG_LOADED,this.onFragLoaded,this),c.off(S.Events.ERROR,this.onError,this)},m.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,l.prototype.destroy.call(this)},m.startLoad=function(){var c=this._levels;c.forEach(function(_){_.loadError=0}),l.prototype.startLoad.call(this)},m.onManifestLoaded=function(c,_){var u=[],o=[],n=[],g,r={},E,P=!1,y=!1,U=!1;if(_.levels.forEach(function(G){var V=G.attrs;P=P||!!(G.width&&G.height),y=y||!!G.videoCodec,U=U||!!G.audioCodec,f&&G.audioCodec&&G.audioCodec.indexOf("mp4a.40.34")!==-1&&(G.audioCodec=void 0);var z=G.bitrate+"-"+G.attrs.RESOLUTION+"-"+G.attrs.CODECS;E=r[z],E?E.url.push(G.url):(E=new w.Level(G),r[z]=E,u.push(E)),V&&(V.AUDIO&&(0,W.addGroupId)(E,"audio",V.AUDIO),V.SUBTITLES&&(0,W.addGroupId)(E,"text",V.SUBTITLES))}),(P||y)&&U&&(u=u.filter(function(G){var V=G.videoCodec,z=G.width,$=G.height;return!!V||!!(z&&$)})),u=u.filter(function(G){var V=G.audioCodec,z=G.videoCodec;return(!V||(0,R.isCodecSupportedInMp4)(V,"audio"))&&(!z||(0,R.isCodecSupportedInMp4)(z,"video"))}),_.audioTracks&&(o=_.audioTracks.filter(function(G){return!G.audioCodec||(0,R.isCodecSupportedInMp4)(G.audioCodec,"audio")}),(0,W.assignTrackIdsByGroup)(o)),_.subtitles&&(n=_.subtitles,(0,W.assignTrackIdsByGroup)(n)),u.length>0){g=u[0].bitrate,u.sort(function(G,V){return G.attrs["HDCP-LEVEL"]!==V.attrs["HDCP-LEVEL"]?(G.attrs["HDCP-LEVEL"]||"")>(V.attrs["HDCP-LEVEL"]||"")?1:-1:G.bitrate!==V.bitrate?G.bitrate-V.bitrate:G.attrs.SCORE!==V.attrs.SCORE?G.attrs.decimalFloatingPoint("SCORE")-V.attrs.decimalFloatingPoint("SCORE"):P&&G.height!==V.height?G.height-V.height:0}),this._levels=u;for(var B=0;B<u.length;B++)if(u[B].bitrate===g){this._firstLevel=B,this.log("manifest loaded, "+u.length+" level(s) found, first bitrate: "+g);break}var F=U&&!y,H={levels:u,audioTracks:o,subtitleTracks:n,sessionData:_.sessionData,sessionKeys:_.sessionKeys,firstLevel:this._firstLevel,stats:_.stats,audio:U,video:y,altAudio:!F&&o.some(function(G){return!!G.url})};this.hls.trigger(S.Events.MANIFEST_PARSED,H),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(S.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:_.url,reason:"no level with compatible codecs found in manifest"})},m.onError=function(c,_){var u,o;if(l.prototype.onError.call(this,c,_),!_.fatal){var n=_.context,g=this._levels[this.currentLevelIndex];if(n&&(n.type===I.PlaylistContextType.AUDIO_TRACK&&g.audioGroupIds&&n.groupId===g.audioGroupIds[g.urlId]||n.type===I.PlaylistContextType.SUBTITLE_TRACK&&g.textGroupIds&&n.groupId===g.textGroupIds[g.urlId])){this.redundantFailover(this.currentLevelIndex);return}var r=!1,E=!0,P;switch(_.details){case k.ErrorDetails.FRAG_LOAD_ERROR:case k.ErrorDetails.FRAG_LOAD_TIMEOUT:case k.ErrorDetails.KEY_LOAD_ERROR:case k.ErrorDetails.KEY_LOAD_TIMEOUT:if(_.frag){var y=_.frag.type===I.PlaylistLevelType.MAIN?_.frag.level:this.currentLevelIndex,U=this._levels[y];U?(U.fragmentError++,U.fragmentError>this.hls.config.fragLoadingMaxRetry&&(P=y)):P=y}break;case k.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{var B=g.attrs["HDCP-LEVEL"];B&&(this.hls.maxHdcpLevel=w.HdcpLevels[w.HdcpLevels.indexOf(B)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'))}case k.ErrorDetails.FRAG_PARSING_ERROR:case k.ErrorDetails.KEY_SYSTEM_NO_SESSION:P=((u=_.frag)===null||u===void 0?void 0:u.type)===I.PlaylistLevelType.MAIN?_.frag.level:this.currentLevelIndex,_.levelRetry=!1;break;case k.ErrorDetails.LEVEL_LOAD_ERROR:case k.ErrorDetails.LEVEL_LOAD_TIMEOUT:n&&(n.deliveryDirectives&&(E=!1),P=n.level),r=!0;break;case k.ErrorDetails.REMUX_ALLOC_ERROR:P=(o=_.level)!=null?o:this.currentLevelIndex,r=!0;break}P!==void 0&&this.recoverLevel(_,P,r,E)}},m.recoverLevel=function(c,_,u,o){var n=c.details,g=this._levels[_];if(g.loadError++,u){var r=this.retryLoadingOrFail(c);if(r)c.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(o){var E=g.url.length;if(E>1&&g.loadError<E)c.levelRetry=!0,this.redundantFailover(_);else if(this.manualLevelIndex===-1){for(var P=-1,y=this._levels,U=y.length;U--;){var B=(U+this.currentLevelIndex)%y.length;if(B!==this.currentLevelIndex&&y[B].loadError===0){P=B;break}}P>-1&&this.currentLevelIndex!==P?(this.warn(n+": switch to "+P),c.levelRetry=!0,this.hls.nextAutoLevel=P):c.levelRetry===!1&&(c.fatal=!0)}}},m.redundantFailover=function(c){var _=this._levels[c],u=_.url.length;if(u>1){var o=(_.urlId+1)%u;this.warn("Switching to redundant URL-id "+o),this._levels.forEach(function(n){n.urlId=o}),this.level=c}},m.onFragLoaded=function(c,_){var u=_.frag;if(u!==void 0&&u.type===I.PlaylistLevelType.MAIN){var o=this._levels[u.level];o!==void 0&&(o.fragmentError=0,o.loadError=0)}},m.onLevelLoaded=function(c,_){var u,o=_.level,n=_.details,g=this._levels[o];if(!g){var r;this.warn("Invalid level index "+o),(r=_.deliveryDirectives)!==null&&r!==void 0&&r.skip&&(n.deltaUpdateFailed=!0);return}o===this.currentLevelIndex?(g.fragmentError===0&&(g.loadError=0,this.retryCount=0),this.playlistLoaded(o,_,g.details)):(u=_.deliveryDirectives)!==null&&u!==void 0&&u.skip&&(n.deltaUpdateFailed=!0)},m.onAudioTrackSwitched=function(c,_){var u=this.hls.levels[this.currentLevelIndex];if(!!u&&u.audioGroupIds){for(var o=-1,n=this.hls.audioTracks[_.id].groupId,g=0;g<u.audioGroupIds.length;g++)if(u.audioGroupIds[g]===n){o=g;break}o!==u.urlId&&(u.urlId=o,this.startLoad())}},m.loadPlaylist=function(c){l.prototype.loadPlaylist.call(this);var _=this.currentLevelIndex,u=this._levels[_];if(this.canLoad&&u&&u.url.length>0){var o=u.urlId,n=u.url[o];if(c)try{n=c.addDirectives(n)}catch(g){this.warn("Could not construct new URL with HLS Delivery Directives: "+g)}this.log("Attempt loading level index "+_+((c==null?void 0:c.msn)!==void 0?" at sn "+c.msn+" part "+c.part:"")+" with URL-id "+o+" "+n),this.clearTimer(),this.hls.trigger(S.Events.LEVEL_LOADING,{url:n,level:_,id:o,deliveryDirectives:c||null})}},m.removeLevel=function(c,_){var u=function(g,r){return r!==_},o=this._levels.filter(function(n,g){return g!==c?!0:n.url.length>1&&_!==void 0?(n.url=n.url.filter(u),n.audioGroupIds&&(n.audioGroupIds=n.audioGroupIds.filter(u)),n.textGroupIds&&(n.textGroupIds=n.textGroupIds.filter(u)),n.urlId=0,!0):!1}).map(function(n,g){var r=n.details;return r!=null&&r.fragments&&r.fragments.forEach(function(E){E.level=g}),n});this._levels=o,this.hls.trigger(S.Events.LEVELS_UPDATED,{levels:o})},A(p,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(c){var _,u=this._levels;if(u.length!==0&&!(this.currentLevelIndex===c&&(_=u[c])!==null&&_!==void 0&&_.details)){if(c<0||c>=u.length){var o=c<0;if(this.hls.trigger(S.Events.ERROR,{type:k.ErrorTypes.OTHER_ERROR,details:k.ErrorDetails.LEVEL_SWITCH_ERROR,level:c,fatal:o,reason:"invalid level idx"}),o)return;c=Math.min(c,u.length-1)}this.clearTimer();var n=this.currentLevelIndex,g=u[n],r=u[c];this.log("switching to level "+c+" from "+n),this.currentLevelIndex=c;var E=b({},r,{level:c,maxBitrate:r.maxBitrate,uri:r.uri,urlId:r.urlId});delete E._urlId,this.hls.trigger(S.Events.LEVEL_SWITCHING,E);var P=r.details;if(!P||P.live){var y=this.switchParams(r.uri,g==null?void 0:g.details);this.loadPlaylist(y)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(c){this.manualLevelIndex=c,this._startLevel===void 0&&(this._startLevel=c),c!==-1&&(this.level=c)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(c){this._firstLevel=c}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var c=this.hls.config.startLevel;return c!==void 0?c:this._firstLevel}else return this._startLevel},set:function(c){this._startLevel=c}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(c){this.level=c,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=c)}}]),p}(C.default)},"./src/controller/level-helper.ts":(N,O,v)=>{v.r(O),v.d(O,{addGroupId:()=>W,addSliding:()=>f,adjustSliding:()=>d,assignTrackIdsByGroup:()=>C,computeReloadInterval:()=>i,getFragmentWithSN:()=>l,getPartWith:()=>p,mapFragmentIntersection:()=>T,mapPartIntersection:()=>D,mergeDetails:()=>A,updateFragPTSDTS:()=>L,updatePTS:()=>I});var w=v("./src/polyfills/number.ts"),S=v("./src/utils/logger.ts"),k=v("./src/loader/date-range.ts");function R(){return R=Object.assign?Object.assign.bind():function(m){for(var s=1;s<arguments.length;s++){var c=arguments[s];for(var _ in c)Object.prototype.hasOwnProperty.call(c,_)&&(m[_]=c[_])}return m},R.apply(this,arguments)}function W(m,s,c){switch(s){case"audio":m.audioGroupIds||(m.audioGroupIds=[]),m.audioGroupIds.push(c);break;case"text":m.textGroupIds||(m.textGroupIds=[]),m.textGroupIds.push(c);break}}function C(m){var s={};m.forEach(function(c){var _=c.groupId||"";c.id=s[_]=s[_]||0,s[_]++})}function I(m,s,c){var _=m[s],u=m[c];b(_,u)}function b(m,s){var c=s.startPTS;if((0,w.isFiniteNumber)(c)){var _=0,u;s.sn>m.sn?(_=c-m.start,u=m):(_=m.start-c,u=s),u.duration!==_&&(u.duration=_)}else if(s.sn>m.sn){var o=m.cc===s.cc;o&&m.minEndPTS?s.start=m.start+(m.minEndPTS-m.start):s.start=m.start+m.duration}else s.start=Math.max(m.start-s.duration,0)}function L(m,s,c,_,u,o){var n=_-c;n<=0&&(S.logger.warn("Fragment should have a positive duration",s),_=c+s.duration,o=u+s.duration);var g=c,r=_,E=s.startPTS,P=s.endPTS;if((0,w.isFiniteNumber)(E)){var y=Math.abs(E-c);(0,w.isFiniteNumber)(s.deltaPTS)?s.deltaPTS=Math.max(y,s.deltaPTS):s.deltaPTS=y,g=Math.max(c,E),c=Math.min(c,E),u=Math.min(u,s.startDTS),r=Math.min(_,P),_=Math.max(_,P),o=Math.max(o,s.endDTS)}s.duration=_-c;var U=c-s.start;s.start=s.startPTS=c,s.maxStartPTS=g,s.startDTS=u,s.endPTS=_,s.minEndPTS=r,s.endDTS=o;var B=s.sn;if(!m||B<m.startSN||B>m.endSN)return 0;var F,H=B-m.startSN,G=m.fragments;for(G[H]=s,F=H;F>0;F--)b(G[F],G[F-1]);for(F=H;F<G.length-1;F++)b(G[F],G[F+1]);return m.fragmentHint&&b(G[G.length-1],m.fragmentHint),m.PTSKnown=m.alignedSliding=!0,U}function A(m,s){for(var c=null,_=m.fragments,u=_.length-1;u>=0;u--){var o=_[u].initSegment;if(o){c=o;break}}m.fragmentHint&&delete m.fragmentHint.endPTS;var n=0,g;if(T(m,s,function(F,H){F.relurl&&(n=F.cc-H.cc),(0,w.isFiniteNumber)(F.startPTS)&&(0,w.isFiniteNumber)(F.endPTS)&&(H.start=H.startPTS=F.startPTS,H.startDTS=F.startDTS,H.appendedPTS=F.appendedPTS,H.maxStartPTS=F.maxStartPTS,H.endPTS=F.endPTS,H.endDTS=F.endDTS,H.minEndPTS=F.minEndPTS,H.duration=F.endPTS-F.startPTS,H.duration&&(g=H),s.PTSKnown=s.alignedSliding=!0),H.elementaryStreams=F.elementaryStreams,H.loader=F.loader,H.stats=F.stats,H.urlId=F.urlId,F.initSegment&&(H.initSegment=F.initSegment,c=F.initSegment)}),c){var r=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;r.forEach(function(F){var H;(!F.initSegment||F.initSegment.relurl===((H=c)===null||H===void 0?void 0:H.relurl))&&(F.initSegment=c)})}if(s.skippedSegments)if(s.deltaUpdateFailed=s.fragments.some(function(F){return!F}),s.deltaUpdateFailed){S.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var E=s.skippedSegments;E--;)s.fragments.shift();s.startSN=s.fragments[0].sn,s.startCC=s.fragments[0].cc}else s.canSkipDateRanges&&(s.dateRanges=h(m.dateRanges,s.dateRanges,s.recentlyRemovedDateranges));var P=s.fragments;if(n){S.logger.warn("discontinuity sliding from playlist, take drift into account");for(var y=0;y<P.length;y++)P[y].cc+=n}s.skippedSegments&&(s.startCC=s.fragments[0].cc),D(m.partList,s.partList,function(F,H){H.elementaryStreams=F.elementaryStreams,H.stats=F.stats}),g?L(s,g,g.startPTS,g.endPTS,g.startDTS,g.endDTS):d(m,s),P.length&&(s.totalduration=s.edge-P[0].start),s.driftStartTime=m.driftStartTime,s.driftStart=m.driftStart;var U=s.advancedDateTime;if(s.advanced&&U){var B=s.edge;s.driftStart||(s.driftStartTime=U,s.driftStart=B),s.driftEndTime=U,s.driftEnd=B}else s.driftEndTime=m.driftEndTime,s.driftEnd=m.driftEnd,s.advancedDateTime=m.advancedDateTime}function h(m,s,c){var _=R({},m);return c&&c.forEach(function(u){delete _[u]}),Object.keys(s).forEach(function(u){var o=new k.DateRange(s[u].attr,_[u]);o.isValid?_[u]=o:S.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(s[u].attr)+'"')}),_}function D(m,s,c){if(m&&s)for(var _=0,u=0,o=m.length;u<=o;u++){var n=m[u],g=s[u+_];n&&g&&n.index===g.index&&n.fragment.sn===g.fragment.sn?c(n,g):_--}}function T(m,s,c){for(var _=s.skippedSegments,u=Math.max(m.startSN,s.startSN)-s.startSN,o=(m.fragmentHint?1:0)+(_?s.endSN:Math.min(m.endSN,s.endSN))-s.startSN,n=s.startSN-m.startSN,g=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments,r=m.fragmentHint?m.fragments.concat(m.fragmentHint):m.fragments,E=u;E<=o;E++){var P=r[n+E],y=g[E];_&&!y&&E<_&&(y=s.fragments[E]=P),P&&y&&c(P,y)}}function d(m,s){var c=s.startSN+s.skippedSegments-m.startSN,_=m.fragments;c<0||c>=_.length||f(s,_[c].start)}function f(m,s){if(s){for(var c=m.fragments,_=m.skippedSegments;_<c.length;_++)c[_].start+=s;m.fragmentHint&&(m.fragmentHint.start+=s)}}function i(m,s){s===void 0&&(s=1/0);var c=1e3*m.targetduration;if(m.updated){var _=m.fragments,u=4;if(_.length&&c*u>s){var o=_[_.length-1].duration*1e3;o<c&&(c=o)}}else c/=2;return Math.round(c)}function l(m,s,c){if(!m||!m.details)return null;var _=m.details,u=_.fragments[s-_.startSN];return u||(u=_.fragmentHint,u&&u.sn===s)?u:s<_.startSN&&c&&c.sn===s?c:null}function p(m,s,c){if(!m||!m.details)return null;var _=m.details.partList;if(_)for(var u=_.length;u--;){var o=_[u];if(o.index===c&&o.fragment.sn===s)return o}return null}},"./src/controller/stream-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>s});var w=v("./src/polyfills/number.ts"),S=v("./src/controller/base-stream-controller.ts"),k=v("./src/is-supported.ts"),R=v("./src/events.ts"),W=v("./src/utils/buffer-helper.ts"),C=v("./src/controller/fragment-tracker.ts"),I=v("./src/types/loader.ts"),b=v("./src/loader/fragment.ts"),L=v("./src/demux/transmuxer-interface.ts"),A=v("./src/types/transmuxer.ts"),h=v("./src/controller/gap-controller.ts"),D=v("./src/errors.ts");function T(c,_){for(var u=0;u<_.length;u++){var o=_[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(c,f(o.key),o)}}function d(c,_,u){return _&&T(c.prototype,_),u&&T(c,u),Object.defineProperty(c,"prototype",{writable:!1}),c}function f(c){var _=i(c,"string");return typeof _=="symbol"?_:String(_)}function i(c,_){if(typeof c!="object"||c===null)return c;var u=c[Symbol.toPrimitive];if(u!==void 0){var o=u.call(c,_||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(c)}function l(c,_){c.prototype=Object.create(_.prototype),c.prototype.constructor=c,p(c,_)}function p(c,_){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,n){return o.__proto__=n,o},p(c,_)}var m=100,s=function(c){l(_,c);function _(o,n,g){var r;return r=c.call(this,o,n,g,"[stream-controller]")||this,r.audioCodecSwap=!1,r.gapController=null,r.level=-1,r._forceStartLoad=!1,r.altAudio=!1,r.audioOnly=!1,r.fragPlaying=null,r.onvplaying=null,r.onvseeked=null,r.fragLastKbps=0,r.couldBacktrack=!1,r.backtrackFragment=null,r.audioCodecSwitch=!1,r.videoBuffer=null,r._registerListeners(),r}var u=_.prototype;return u._registerListeners=function(){var n=this.hls;n.on(R.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(R.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(R.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(R.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(R.Events.LEVEL_LOADING,this.onLevelLoading,this),n.on(R.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.on(R.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),n.on(R.Events.ERROR,this.onError,this),n.on(R.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.on(R.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),n.on(R.Events.BUFFER_CREATED,this.onBufferCreated,this),n.on(R.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.on(R.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),n.on(R.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u._unregisterListeners=function(){var n=this.hls;n.off(R.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(R.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(R.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(R.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(R.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.off(R.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),n.off(R.Events.ERROR,this.onError,this),n.off(R.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.off(R.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),n.off(R.Events.BUFFER_CREATED,this.onBufferCreated,this),n.off(R.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.off(R.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),n.off(R.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},u.startLoad=function(n){if(this.levels){var g=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(m),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var E=r.startLevel;E===-1&&(r.config.testBandwidth&&this.levels.length>1?(E=0,this.bitrateTest=!0):E=r.nextAutoLevel),this.level=r.nextLoadLevel=E,this.loadedmetadata=!1}g>0&&n===-1&&(this.log("Override startPosition with lastCurrentTime @"+g.toFixed(3)),n=g),this.state=S.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()}else this._forceStartLoad=!0,this.state=S.State.STOPPED},u.stopLoad=function(){this._forceStartLoad=!1,c.prototype.stopLoad.call(this)},u.doTick=function(){switch(this.state){case S.State.IDLE:this.doTickIdle();break;case S.State.WAITING_LEVEL:{var n,g=this.levels,r=this.level,E=g==null||(n=g[r])===null||n===void 0?void 0:n.details;if(E&&(!E.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(E))break;this.state=S.State.IDLE;break}break}case S.State.FRAG_LOADING_WAITING_RETRY:{var P,y=self.performance.now(),U=this.retryDate;(!U||y>=U||(P=this.media)!==null&&P!==void 0&&P.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=S.State.IDLE)}break}this.onTickEnd()},u.onTickEnd=function(){c.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},u.doTickIdle=function(){var n=this.hls,g=this.levelLastLoaded,r=this.levels,E=this.media,P=n.config,y=n.nextLoadLevel;if(!(g===null||!E&&(this.startFragRequested||!P.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!r||!r[y])){var U=r[y],B=this.getMainFwdBufferInfo();if(B!==null){var F=this.getLevelDetails();if(F&&this._streamEnded(B,F)){var H={};this.altAudio&&(H.type="video"),this.hls.trigger(R.Events.BUFFER_EOS,H),this.state=S.State.ENDED;return}this.level=n.nextLoadLevel=y;var G=U.details;if(!G||this.state===S.State.WAITING_LEVEL||G.live&&this.levelLastLoaded!==y){this.level=y,this.state=S.State.WAITING_LEVEL;return}var V=B.len,z=this.getMaxBufferLength(U.maxBitrate);if(!(V>=z)){this.backtrackFragment&&this.backtrackFragment.start>B.end&&(this.backtrackFragment=null);var $=this.backtrackFragment?this.backtrackFragment.start:B.end,X=this.getNextFragment($,G);if(this.couldBacktrack&&!this.fragPrevious&&X&&X.sn!=="initSegment"&&this.fragmentTracker.getState(X)!==C.FragmentState.OK){var j,Y=((j=this.backtrackFragment)!=null?j:X).sn,Q=Y-G.startSN,J=G.fragments[Q-1];J&&X.cc===J.cc&&(X=J,this.fragmentTracker.removeFragment(J))}else this.backtrackFragment&&B.len&&(this.backtrackFragment=null);if(X&&this.fragmentTracker.getState(X)===C.FragmentState.OK&&this.nextLoadPosition>$){var Z=this.audioOnly&&!this.altAudio?b.ElementaryStreamTypes.AUDIO:b.ElementaryStreamTypes.VIDEO,ee=(Z===b.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;ee&&this.afterBufferFlushed(ee,Z,I.PlaylistLevelType.MAIN),X=this.getNextFragment(this.nextLoadPosition,G)}!X||(X.initSegment&&!X.initSegment.data&&!this.bitrateTest&&(X=X.initSegment),this.loadFragment(X,G,$))}}}},u.loadFragment=function(n,g,r){var E,P=this.fragmentTracker.getState(n);this.fragCurrent=n,P===C.FragmentState.NOT_LOADED?n.sn==="initSegment"?this._loadInitSegment(n,g):this.bitrateTest?(this.log("Fragment "+n.sn+" of level "+n.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(n,g)):(this.startFragRequested=!0,c.prototype.loadFragment.call(this,n,g,r)):P===C.FragmentState.APPENDING?this.reduceMaxBufferLength(n.duration)&&this.fragmentTracker.removeFragment(n):((E=this.media)===null||E===void 0?void 0:E.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},u.getAppendedFrag=function(n){var g=this.fragmentTracker.getAppendedFrag(n,I.PlaylistLevelType.MAIN);return g&&"fragment"in g?g.fragment:g},u.getBufferedFrag=function(n){return this.fragmentTracker.getBufferedFrag(n,I.PlaylistLevelType.MAIN)},u.followingBufferedFrag=function(n){return n?this.getBufferedFrag(n.end+.5):null},u.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},u.nextLevelSwitch=function(){var n=this.levels,g=this.media;if(g!=null&&g.readyState){var r,E=this.getAppendedFrag(g.currentTime);if(E&&E.start>1&&this.flushMainBuffer(0,E.start-1),!g.paused&&n){var P=this.hls.nextLoadLevel,y=n[P],U=this.fragLastKbps;U&&this.fragCurrent?r=this.fragCurrent.duration*y.maxBitrate/(1e3*U)+1:r=0}else r=0;var B=this.getBufferedFrag(g.currentTime+r);if(B){var F=this.followingBufferedFrag(B);if(F){this.abortCurrentFrag();var H=F.maxStartPTS?F.maxStartPTS:F.start,G=F.duration,V=Math.max(B.end,H+Math.min(Math.max(G-this.config.maxFragLookUpTolerance,G*.5),G*.75));this.flushMainBuffer(V,Number.POSITIVE_INFINITY)}}}},u.abortCurrentFrag=function(){var n=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,n&&n.abortRequests(),this.state){case S.State.KEY_LOADING:case S.State.FRAG_LOADING:case S.State.FRAG_LOADING_WAITING_RETRY:case S.State.PARSING:case S.State.PARSED:this.state=S.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},u.flushMainBuffer=function(n,g){c.prototype.flushMainBuffer.call(this,n,g,this.altAudio?"video":null)},u.onMediaAttached=function(n,g){c.prototype.onMediaAttached.call(this,n,g);var r=g.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new h.default(this.config,r,this.fragmentTracker,this.hls)},u.onMediaDetaching=function(){var n=this.media;n&&this.onvplaying&&this.onvseeked&&(n.removeEventListener("playing",this.onvplaying),n.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),c.prototype.onMediaDetaching.call(this)},u.onMediaPlaying=function(){this.tick()},u.onMediaSeeked=function(){var n=this.media,g=n?n.currentTime:null;(0,w.isFiniteNumber)(g)&&this.log("Media seeked to "+g.toFixed(3)),this.tick()},u.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(R.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},u.onManifestParsed=function(n,g){var r=!1,E=!1,P;g.levels.forEach(function(y){P=y.audioCodec,P&&(P.indexOf("mp4a.40.2")!==-1&&(r=!0),P.indexOf("mp4a.40.5")!==-1&&(E=!0))}),this.audioCodecSwitch=r&&E&&!(0,k.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=g.levels,this.startFragRequested=!1},u.onLevelLoading=function(n,g){var r=this.levels;if(!(!r||this.state!==S.State.IDLE)){var E=r[g.level];(!E.details||E.details.live&&this.levelLastLoaded!==g.level||this.waitForCdnTuneIn(E.details))&&(this.state=S.State.WAITING_LEVEL)}},u.onLevelLoaded=function(n,g){var r,E=this.levels,P=g.level,y=g.details,U=y.totalduration;if(!E){this.warn("Levels were reset while loading level "+P);return}this.log("Level "+P+" loaded ["+y.startSN+","+y.endSN+"], cc ["+y.startCC+", "+y.endCC+"] duration:"+U);var B=this.fragCurrent;B&&(this.state===S.State.FRAG_LOADING||this.state===S.State.FRAG_LOADING_WAITING_RETRY)&&B.level!==g.level&&B.loader&&(this.state=S.State.IDLE,this.backtrackFragment=null,B.abortRequests());var F=E[P],H=0;if(y.live||(r=F.details)!==null&&r!==void 0&&r.live){if(y.fragments[0]||(y.deltaUpdateFailed=!0),y.deltaUpdateFailed)return;H=this.alignPlaylists(y,F.details)}if(F.details=y,this.levelLastLoaded=P,this.hls.trigger(R.Events.LEVEL_UPDATED,{details:y,level:P}),this.state===S.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(y))return;this.state=S.State.IDLE}this.startFragRequested?y.live&&this.synchronizeToLiveEdge(y):this.setStartPosition(y,H),this.tick()},u._handleFragmentLoadProgress=function(n){var g,r=n.frag,E=n.part,P=n.payload,y=this.levels;if(!y){this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered");return}var U=y[r.level],B=U.details;if(!B){this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset");return}var F=U.videoCodec,H=B.PTSKnown||!B.live,G=(g=r.initSegment)===null||g===void 0?void 0:g.data,V=this._getAudioCodec(U),z=this.transmuxer=this.transmuxer||new L.default(this.hls,I.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),$=E?E.index:-1,X=$!==-1,j=new A.ChunkMetadata(r.level,r.sn,r.stats.chunkCount,P.byteLength,$,X),Y=this.initPTS[r.cc];z.push(P,G,V,F,r,E,B.totalduration,H,j,Y)},u.onAudioTrackSwitching=function(n,g){var r=this.altAudio,E=!!g.url,P=g.id;if(!E){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var y=this.fragCurrent;y&&(this.log("Switching to main audio track, cancel main fragment load"),y.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var U=this.hls;r&&U.trigger(R.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),U.trigger(R.Events.AUDIO_TRACK_SWITCHED,{id:P})}},u.onAudioTrackSwitched=function(n,g){var r=g.id,E=!!this.hls.audioTracks[r].url;if(E){var P=this.videoBuffer;P&&this.mediaBuffer!==P&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=P)}this.altAudio=E,this.tick()},u.onBufferCreated=function(n,g){var r=g.tracks,E,P,y=!1;for(var U in r){var B=r[U];if(B.id==="main"){if(P=U,E=B,U==="video"){var F=r[U];F&&(this.videoBuffer=F.buffer)}}else y=!0}y&&E?(this.log("Alternate track found, use "+P+".buffered to schedule main fragment loading"),this.mediaBuffer=E.buffer):this.mediaBuffer=this.media},u.onFragBuffered=function(n,g){var r=g.frag,E=g.part;if(!(r&&r.type!==I.PlaylistLevelType.MAIN)){if(this.fragContextChanged(r)){this.warn("Fragment "+r.sn+(E?" p: "+E.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),this.state===S.State.PARSED&&(this.state=S.State.IDLE);return}var P=E?E.stats:r.stats;this.fragLastKbps=Math.round(8*P.total/(P.buffering.end-P.loading.first)),r.sn!=="initSegment"&&(this.fragPrevious=r),this.fragBufferedComplete(r,E)}},u.onError=function(n,g){if(g.type===D.ErrorTypes.KEY_SYSTEM_ERROR){this.onFragmentOrKeyLoadError(I.PlaylistLevelType.MAIN,g);return}switch(g.details){case D.ErrorDetails.FRAG_LOAD_ERROR:case D.ErrorDetails.FRAG_LOAD_TIMEOUT:case D.ErrorDetails.FRAG_PARSING_ERROR:case D.ErrorDetails.KEY_LOAD_ERROR:case D.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.MAIN,g);break;case D.ErrorDetails.LEVEL_LOAD_ERROR:case D.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==S.State.ERROR&&(g.fatal?(this.warn(""+g.details),this.state=S.State.ERROR):!g.levelRetry&&this.state===S.State.WAITING_LEVEL&&(this.state=S.State.IDLE));break;case D.ErrorDetails.BUFFER_FULL_ERROR:if(g.parent==="main"&&(this.state===S.State.PARSING||this.state===S.State.PARSED)){var r=!0,E=this.getFwdBufferInfo(this.media,I.PlaylistLevelType.MAIN);E&&E.len>.5&&(r=!this.reduceMaxBufferLength(E.len)),r&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},u.checkBuffer=function(){var n=this.media,g=this.gapController;if(!(!n||!g||!n.readyState)){if(this.loadedmetadata||!W.BufferHelper.getBuffered(n).length){var r=this.state!==S.State.IDLE?this.fragCurrent:null;g.poll(this.lastCurrentTime,r)}this.lastCurrentTime=n.currentTime}},u.onFragLoadEmergencyAborted=function(){this.state=S.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},u.onBufferFlushed=function(n,g){var r=g.type;if(r!==b.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var E=(r===b.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(E,r,I.PlaylistLevelType.MAIN)}},u.onLevelsUpdated=function(n,g){this.levels=g.levels},u.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},u.seekToStartPos=function(){var n=this.media;if(!!n){var g=n.currentTime,r=this.startPosition;if(r>=0&&g<r){if(n.seeking){this.log("could not seek to "+r+", already seeking at "+g);return}var E=W.BufferHelper.getBuffered(n),P=E.length?E.start(0):0,y=P-r;y>0&&(y<this.config.maxBufferHole||y<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+y+" to match buffer start"),r+=y,this.startPosition=r),this.log("seek to target start position "+r+" from current time "+g),n.currentTime=r}}},u._getAudioCodec=function(n){var g=this.config.defaultAudioCodec||n.audioCodec;return this.audioCodecSwap&&g&&(this.log("Swapping audio codec"),g.indexOf("mp4a.40.5")!==-1?g="mp4a.40.2":g="mp4a.40.5"),g},u._loadBitrateTestFrag=function(n,g){var r=this;n.bitrateTest=!0,this._doFragLoad(n,g).then(function(E){var P=r.hls;if(!(!E||r.fragContextChanged(n))){r.fragLoadError=0,r.state=S.State.IDLE,r.startFragRequested=!1,r.bitrateTest=!1;var y=n.stats;y.parsing.start=y.parsing.end=y.buffering.start=y.buffering.end=self.performance.now(),P.trigger(R.Events.FRAG_LOADED,E),n.bitrateTest=!1}})},u._handleTransmuxComplete=function(n){var g,r="main",E=this.hls,P=n.remuxResult,y=n.chunkMeta,U=this.getCurrentContext(y);if(!U){this.warn("The loading context changed while buffering fragment "+y.sn+" of level "+y.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(y.level);return}var B=U.frag,F=U.part,H=U.level,G=P.video,V=P.text,z=P.id3,$=P.initSegment,X=H.details,j=this.altAudio?void 0:P.audio;if(!this.fragContextChanged(B)){if(this.state=S.State.PARSING,$){$.tracks&&(this._bufferInitSegment(H,$.tracks,B,y),E.trigger(R.Events.FRAG_PARSING_INIT_SEGMENT,{frag:B,id:r,tracks:$.tracks}));var Y=$.initPTS,Q=$.timescale;(0,w.isFiniteNumber)(Y)&&(this.initPTS[B.cc]=Y,E.trigger(R.Events.INIT_PTS_FOUND,{frag:B,id:r,initPTS:Y,timescale:Q}))}if(G&&P.independent!==!1){if(X){var J=G.startPTS,Z=G.endPTS,ee=G.startDTS,ne=G.endDTS;if(F)F.elementaryStreams[G.type]={startPTS:J,endPTS:Z,startDTS:ee,endDTS:ne};else if(G.firstKeyFrame&&G.independent&&y.id===1&&(this.couldBacktrack=!0),G.dropped&&G.independent){var te=this.getMainFwdBufferInfo(),q=(te?te.end:this.getLoadPosition())+this.config.maxBufferHole,re=G.firstKeyFramePTS?G.firstKeyFramePTS:J;if(q<re-this.config.maxBufferHole){this.backtrack(B);return}B.setElementaryStreamInfo(G.type,B.start,Z,B.start,ne,!0)}B.setElementaryStreamInfo(G.type,J,Z,ee,ne),this.backtrackFragment&&(this.backtrackFragment=B),this.bufferFragmentData(G,B,F,y)}}else if(P.independent===!1){this.backtrack(B);return}if(j){var se=j.startPTS,ie=j.endPTS,ae=j.startDTS,oe=j.endDTS;F&&(F.elementaryStreams[b.ElementaryStreamTypes.AUDIO]={startPTS:se,endPTS:ie,startDTS:ae,endDTS:oe}),B.setElementaryStreamInfo(b.ElementaryStreamTypes.AUDIO,se,ie,ae,oe),this.bufferFragmentData(j,B,F,y)}if(X&&z!==null&&z!==void 0&&(g=z.samples)!==null&&g!==void 0&&g.length){var le={id:r,frag:B,details:X,samples:z.samples};E.trigger(R.Events.FRAG_PARSING_METADATA,le)}if(X&&V){var ue={id:r,frag:B,details:X,samples:V.samples};E.trigger(R.Events.FRAG_PARSING_USERDATA,ue)}}},u._bufferInitSegment=function(n,g,r,E){var P=this;if(this.state===S.State.PARSING){this.audioOnly=!!g.audio&&!g.video,this.altAudio&&!this.audioOnly&&delete g.audio;var y=g.audio,U=g.video,B=g.audiovideo;if(y){var F=n.audioCodec,H=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(F&&(F.indexOf("mp4a.40.5")!==-1?F="mp4a.40.2":F="mp4a.40.5"),y.metadata.channelCount!==1&&H.indexOf("firefox")===-1&&(F="mp4a.40.5")),H.indexOf("android")!==-1&&y.container!=="audio/mpeg"&&(F="mp4a.40.2",this.log("Android: force audio codec to "+F)),n.audioCodec&&n.audioCodec!==F&&this.log('Swapping manifest audio codec "'+n.audioCodec+'" for "'+F+'"'),y.levelCodec=F,y.id="main",this.log("Init audio buffer, container:"+y.container+", codecs[selected/level/parsed]=["+(F||"")+"/"+(n.audioCodec||"")+"/"+y.codec+"]")}U&&(U.levelCodec=n.videoCodec,U.id="main",this.log("Init video buffer, container:"+U.container+", codecs[level/parsed]=["+(n.videoCodec||"")+"/"+U.codec+"]")),B&&this.log("Init audiovideo buffer, container:"+B.container+", codecs[level/parsed]=["+(n.attrs.CODECS||"")+"/"+B.codec+"]"),this.hls.trigger(R.Events.BUFFER_CODECS,g),Object.keys(g).forEach(function(G){var V=g[G],z=V.initSegment;z!=null&&z.byteLength&&P.hls.trigger(R.Events.BUFFER_APPENDING,{type:G,data:z,frag:r,part:null,chunkMeta:E,parent:r.type})}),this.tick()}},u.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,I.PlaylistLevelType.MAIN)},u.backtrack=function(n){this.couldBacktrack=!0,this.backtrackFragment=n,this.resetTransmuxer(),this.flushBufferGap(n),this.fragmentTracker.removeFragment(n),this.fragPrevious=null,this.nextLoadPosition=n.start,this.state=S.State.IDLE},u.checkFragmentChanged=function(){var n=this.media,g=null;if(n&&n.readyState>1&&n.seeking===!1){var r=n.currentTime;if(W.BufferHelper.isBuffered(n,r)?g=this.getAppendedFrag(r):W.BufferHelper.isBuffered(n,r+.1)&&(g=this.getAppendedFrag(r+.1)),g){this.backtrackFragment=null;var E=this.fragPlaying,P=g.level;(!E||g.sn!==E.sn||E.level!==P||g.urlId!==E.urlId)&&(this.fragPlaying=g,this.hls.trigger(R.Events.FRAG_CHANGED,{frag:g}),(!E||E.level!==P)&&this.hls.trigger(R.Events.LEVEL_SWITCHED,{level:P}))}}},d(_,[{key:"nextLevel",get:function(){var n=this.nextBufferedFrag;return n?n.level:-1}},{key:"currentFrag",get:function(){var n=this.media;return n?this.fragPlaying||this.getAppendedFrag(n.currentTime):null}},{key:"currentProgramDateTime",get:function(){var n=this.media;if(n){var g=n.currentTime,r=this.currentFrag;if(r&&(0,w.isFiniteNumber)(g)&&(0,w.isFiniteNumber)(r.programDateTime)){var E=r.programDateTime+(g-r.start)*1e3;return new Date(E)}}return null}},{key:"currentLevel",get:function(){var n=this.currentFrag;return n?n.level:-1}},{key:"nextBufferedFrag",get:function(){var n=this.currentFrag;return n?this.followingBufferedFrag(n):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),_}(S.default)},"./src/controller/subtitle-stream-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{SubtitleStreamController:()=>l});var w=v("./src/events.ts"),S=v("./src/utils/buffer-helper.ts"),k=v("./src/controller/fragment-finders.ts"),R=v("./src/utils/discontinuities.ts"),W=v("./src/controller/level-helper.ts"),C=v("./src/controller/fragment-tracker.ts"),I=v("./src/controller/base-stream-controller.ts"),b=v("./src/types/loader.ts"),L=v("./src/types/level.ts");function A(m,s){for(var c=0;c<s.length;c++){var _=s[c];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,D(_.key),_)}}function h(m,s,c){return s&&A(m.prototype,s),c&&A(m,c),Object.defineProperty(m,"prototype",{writable:!1}),m}function D(m){var s=T(m,"string");return typeof s=="symbol"?s:String(s)}function T(m,s){if(typeof m!="object"||m===null)return m;var c=m[Symbol.toPrimitive];if(c!==void 0){var _=c.call(m,s||"default");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(m)}function d(m,s){m.prototype=Object.create(s.prototype),m.prototype.constructor=m,f(m,s)}function f(m,s){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,u){return _.__proto__=u,_},f(m,s)}var i=500,l=function(m){d(s,m);function s(_,u,o){var n;return n=m.call(this,_,u,o,"[subtitle-stream-controller]")||this,n.levels=[],n.currentTrackId=-1,n.tracksBuffered=[],n.mainDetails=null,n._registerListeners(),n}var c=s.prototype;return c.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},c._registerListeners=function(){var u=this.hls;u.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.on(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.on(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.on(w.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.on(w.Events.ERROR,this.onError,this),u.on(w.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),u.on(w.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),u.on(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),u.on(w.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),u.on(w.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.on(w.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c._unregisterListeners=function(){var u=this.hls;u.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.off(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(w.Events.LEVEL_LOADED,this.onLevelLoaded,this),u.off(w.Events.ERROR,this.onError,this),u.off(w.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),u.off(w.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),u.off(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),u.off(w.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),u.off(w.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.off(w.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c.startLoad=function(u){this.stopLoad(),this.state=I.State.IDLE,this.setInterval(i),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=u,this.tick()},c.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},c.onLevelLoaded=function(u,o){this.mainDetails=o.details},c.onSubtitleFragProcessed=function(u,o){var n=o.frag,g=o.success;if(this.fragPrevious=n,this.state=I.State.IDLE,!!g){var r=this.tracksBuffered[this.currentTrackId];if(!!r){for(var E,P=n.start,y=0;y<r.length;y++)if(P>=r[y].start&&P<=r[y].end){E=r[y];break}var U=n.start+n.duration;E?E.end=U:(E={start:P,end:U},r.push(E)),this.fragmentTracker.fragBuffered(n)}}},c.onBufferFlushing=function(u,o){var n=o.startOffset,g=o.endOffset;if(n===0&&g!==Number.POSITIVE_INFINITY){var r=this.currentTrackId,E=this.levels;if(!E.length||!E[r]||!E[r].details)return;var P=E[r].details,y=P.targetduration,U=g-y;if(U<=0)return;o.endOffsetSubtitles=Math.max(0,U),this.tracksBuffered.forEach(function(B){for(var F=0;F<B.length;){if(B[F].end<=U){B.shift();continue}else if(B[F].start<U)B[F].start=U;else break;F++}}),this.fragmentTracker.removeFragmentsInRange(n,U,b.PlaylistLevelType.SUBTITLE)}},c.onFragBuffered=function(u,o){if(!this.loadedmetadata&&o.frag.type===b.PlaylistLevelType.MAIN){var n;(n=this.media)!==null&&n!==void 0&&n.buffered.length&&(this.loadedmetadata=!0)}},c.onError=function(u,o){var n=o.frag;!n||n.type!==b.PlaylistLevelType.SUBTITLE||(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=I.State.IDLE)},c.onSubtitleTracksUpdated=function(u,o){var n=this,g=o.subtitleTracks;this.tracksBuffered=[],this.levels=g.map(function(r){return new L.Level(r)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(r){n.tracksBuffered[r.id]=[]}),this.mediaBuffer=null},c.onSubtitleTrackSwitch=function(u,o){if(this.currentTrackId=o.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(i)},c.onSubtitleTrackLoaded=function(u,o){var n,g=o.details,r=o.id,E=this.currentTrackId,P=this.levels;if(!!P.length){var y=P[E];if(!(r>=P.length||r!==E||!y)){this.mediaBuffer=this.mediaBufferTimeRanges;var U=0;if(g.live||(n=y.details)!==null&&n!==void 0&&n.live){var B=this.mainDetails;if(g.deltaUpdateFailed||!B)return;var F=B.fragments[0];y.details?(U=this.alignPlaylists(g,y.details),U===0&&F&&(U=F.start,(0,W.addSliding)(g,U))):g.hasProgramDateTime&&B.hasProgramDateTime?((0,R.alignMediaPlaylistByPDT)(g,B),U=g.fragments[0].start):F&&(U=F.start,(0,W.addSliding)(g,U))}if(y.details=g,this.levelLastLoaded=r,!this.startFragRequested&&(this.mainDetails||!g.live)&&this.setStartPosition(y.details,U),this.tick(),g.live&&!this.fragCurrent&&this.media&&this.state===I.State.IDLE){var H=(0,k.findFragmentByPTS)(null,g.fragments,this.media.currentTime,0);H||(this.warn("Subtitle playlist not aligned with playback"),y.details=void 0)}}}},c._handleFragmentLoadComplete=function(u){var o=this,n=u.frag,g=u.payload,r=n.decryptdata,E=this.hls;if(!this.fragContextChanged(n)&&g&&g.byteLength>0&&r&&r.key&&r.iv&&r.method==="AES-128"){var P=performance.now();this.decrypter.decrypt(new Uint8Array(g),r.key.buffer,r.iv.buffer).then(function(y){var U=performance.now();E.trigger(w.Events.FRAG_DECRYPTED,{frag:n,payload:y,stats:{tstart:P,tdecrypt:U}})}).catch(function(y){o.warn(y.name+": "+y.message),o.state=I.State.IDLE})}},c.doTick=function(){if(!this.media){this.state=I.State.IDLE;return}if(this.state===I.State.IDLE){var u=this.currentTrackId,o=this.levels;if(!o.length||!o[u]||!o[u].details)return;var n=o[u].details,g=n.targetduration,r=this.config,E=this.getLoadPosition(),P=S.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],E-g,r.maxBufferHole),y=P.end,U=P.len,B=this.getFwdBufferInfo(this.media,b.PlaylistLevelType.MAIN),F=this.getMaxBufferLength(B==null?void 0:B.len)+g;if(U>F)return;console.assert(n,"Subtitle track details are defined on idle subtitle stream controller tick");var H=n.fragments,G=H.length,V=n.edge,z=null,$=this.fragPrevious;if(y<V){var X=r.maxFragLookUpTolerance;z=(0,k.findFragmentByPTS)($,H,Math.max(H[0].start,y),X),!z&&$&&$.start<H[0].start&&(z=H[0])}else z=H[G-1];if(!z)return;z=this.mapToInitFragWhenRequired(z),this.fragmentTracker.getState(z)===C.FragmentState.NOT_LOADED&&this.loadFragment(z,n,y)}},c.getMaxBufferLength=function(u){var o=m.prototype.getMaxBufferLength.call(this);return u?Math.max(o,u):o},c.loadFragment=function(u,o,n){this.fragCurrent=u,u.sn==="initSegment"?this._loadInitSegment(u,o):(this.startFragRequested=!0,m.prototype.loadFragment.call(this,u,o,n))},h(s,[{key:"mediaBufferTimeRanges",get:function(){return new p(this.tracksBuffered[this.currentTrackId]||[])}}]),s}(I.default),p=function(s){this.buffered=void 0;var c=function(u,o,n){if(o=o>>>0,o>n-1)throw new DOMException("Failed to execute '"+u+"' on 'TimeRanges': The index provided ("+o+") is greater than the maximum bound ("+n+")");return s[o][u]};this.buffered={get length(){return s.length},end:function(u){return c("end",u,s.length)},start:function(u){return c("start",u,s.length)}}}},"./src/controller/subtitle-track-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>T});var w=v("./src/events.ts"),S=v("./src/utils/texttrack-utils.ts"),k=v("./src/controller/base-playlist-controller.ts"),R=v("./src/types/loader.ts");function W(d,f){for(var i=0;i<f.length;i++){var l=f[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,I(l.key),l)}}function C(d,f,i){return f&&W(d.prototype,f),i&&W(d,i),Object.defineProperty(d,"prototype",{writable:!1}),d}function I(d){var f=b(d,"string");return typeof f=="symbol"?f:String(f)}function b(d,f){if(typeof d!="object"||d===null)return d;var i=d[Symbol.toPrimitive];if(i!==void 0){var l=i.call(d,f||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(d)}function L(d,f){d.prototype=Object.create(f.prototype),d.prototype.constructor=d,A(d,f)}function A(d,f){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,p){return l.__proto__=p,l},A(d,f)}var h=function(d){L(f,d);function f(l){var p;return p=d.call(this,l,"[subtitle-track-controller]")||this,p.media=null,p.tracks=[],p.groupId=null,p.tracksInGroup=[],p.trackId=-1,p.selectDefaultTrack=!0,p.queuedDefaultTrack=-1,p.trackChangeListener=function(){return p.onTextTracksChanged()},p.asyncPollTrackChange=function(){return p.pollTrackChange(0)},p.useTextTrackPolling=!1,p.subtitlePollingInterval=-1,p._subtitleDisplay=!0,p.registerListeners(),p}var i=f.prototype;return i.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,d.prototype.destroy.call(this)},i.registerListeners=function(){var p=this.hls;p.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.on(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.on(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.on(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.on(w.Events.LEVEL_LOADING,this.onLevelLoading,this),p.on(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),p.on(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),p.on(w.Events.ERROR,this.onError,this)},i.unregisterListeners=function(){var p=this.hls;p.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.off(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.off(w.Events.LEVEL_LOADING,this.onLevelLoading,this),p.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),p.off(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),p.off(w.Events.ERROR,this.onError,this)},i.onMediaAttached=function(p,m){this.media=m.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},i.pollTrackChange=function(p){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,p)},i.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var p=D(this.media.textTracks);p.forEach(function(m){(0,S.clearCurrentCues)(m)}),this.subtitleTrack=-1,this.media=null}},i.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},i.onManifestParsed=function(p,m){this.tracks=m.subtitleTracks},i.onSubtitleTrackLoaded=function(p,m){var s=m.id,c=m.details,_=this.trackId,u=this.tracksInGroup[_];if(!u){this.warn("Invalid subtitle track id "+s);return}var o=u.details;u.details=m.details,this.log("subtitle track "+s+" loaded ["+c.startSN+"-"+c.endSN+"]"),s===this.trackId&&(this.retryCount=0,this.playlistLoaded(s,m,o))},i.onLevelLoading=function(p,m){this.switchLevel(m.level)},i.onLevelSwitching=function(p,m){this.switchLevel(m.level)},i.switchLevel=function(p){var m=this.hls.levels[p];if(!!(m!=null&&m.textGroupIds)){var s=m.textGroupIds[m.urlId];if(this.groupId!==s){var c=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,_=this.tracks.filter(function(n){return!s||n.groupId===s});this.tracksInGroup=_;var u=this.findTrackId(c==null?void 0:c.name)||this.findTrackId();this.groupId=s;var o={subtitleTracks:_};this.log("Updating subtitle tracks, "+_.length+' track(s) found in "'+s+'" group-id'),this.hls.trigger(w.Events.SUBTITLE_TRACKS_UPDATED,o),u!==-1&&this.setSubtitleTrack(u,c)}}},i.findTrackId=function(p){for(var m=this.tracksInGroup,s=0;s<m.length;s++){var c=m[s];if((!this.selectDefaultTrack||c.default)&&(!p||p===c.name))return c.id}return-1},i.onError=function(p,m){d.prototype.onError.call(this,p,m),!(m.fatal||!m.context)&&m.context.type===R.PlaylistContextType.SUBTITLE_TRACK&&m.context.id===this.trackId&&m.context.groupId===this.groupId&&this.retryLoadingOrFail(m)},i.loadPlaylist=function(p){d.prototype.loadPlaylist.call(this);var m=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(m)){var s=m.id,c=m.groupId,_=m.url;if(p)try{_=p.addDirectives(_)}catch(u){this.warn("Could not construct new URL with HLS Delivery Directives: "+u)}this.log("Loading subtitle playlist for id "+s),this.hls.trigger(w.Events.SUBTITLE_TRACK_LOADING,{url:_,id:s,groupId:c,deliveryDirectives:p||null})}},i.toggleTrackModes=function(p){var m=this,s=this.media,c=this.trackId;if(!!s){var _=D(s.textTracks),u=_.filter(function(g){return g.groupId===m.groupId});if(p===-1)[].slice.call(_).forEach(function(g){g.mode="disabled"});else{var o=u[c];o&&(o.mode="disabled")}var n=u[p];n&&(n.mode=this.subtitleDisplay?"showing":"hidden")}},i.setSubtitleTrack=function(p,m){var s,c=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=p;return}if(this.trackId!==p&&this.toggleTrackModes(p),!(this.trackId===p&&(p===-1||(s=c[p])!==null&&s!==void 0&&s.details)||p<-1||p>=c.length)){this.clearTimer();var _=c[p];if(this.log("Switching to subtitle track "+p),this.trackId=p,_){var u=_.id,o=_.groupId,n=o===void 0?"":o,g=_.name,r=_.type,E=_.url;this.hls.trigger(w.Events.SUBTITLE_TRACK_SWITCH,{id:u,groupId:n,name:g,type:r,url:E});var P=this.switchParams(_.url,m==null?void 0:m.details);this.loadPlaylist(P)}else this.hls.trigger(w.Events.SUBTITLE_TRACK_SWITCH,{id:p})}},i.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var p=-1,m=D(this.media.textTracks),s=0;s<m.length;s++)if(m[s].mode==="hidden")p=s;else if(m[s].mode==="showing"){p=s;break}this.subtitleTrack!==p&&(this.subtitleTrack=p)}},C(f,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(p){this._subtitleDisplay=p,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(p){this.selectDefaultTrack=!1;var m=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(p,m)}}]),f}(k.default);function D(d){for(var f=[],i=0;i<d.length;i++){var l=d[i];l.kind==="subtitles"&&l.label&&f.push(d[i])}return f}const T=h},"./src/controller/timeline-controller.ts":(N,O,v)=>{v.r(O),v.d(O,{TimelineController:()=>h});var w=v("./src/polyfills/number.ts"),S=v("./src/events.ts"),k=v("./src/utils/cea-608-parser.ts"),R=v("./src/utils/output-filter.ts"),W=v("./src/utils/webvtt-parser.ts"),C=v("./src/utils/texttrack-utils.ts"),I=v("./src/utils/imsc1-ttml-parser.ts"),b=v("./src/utils/mp4-tools.ts"),L=v("./src/types/loader.ts"),A=v("./src/utils/logger.ts"),h=function(){function f(l){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=d(),this.captionsProperties=void 0,this.hls=l,this.config=l.config,this.Cues=l.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var p=new R.default(this,"textTrack1"),m=new R.default(this,"textTrack2"),s=new R.default(this,"textTrack3"),c=new R.default(this,"textTrack4");this.cea608Parser1=new k.default(1,p,m),this.cea608Parser2=new k.default(3,s,c)}l.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),l.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.on(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),l.on(S.Events.FRAG_LOADING,this.onFragLoading,this),l.on(S.Events.FRAG_LOADED,this.onFragLoaded,this),l.on(S.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),l.on(S.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),l.on(S.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.on(S.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),l.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var i=f.prototype;return i.destroy=function(){var p=this.hls;p.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),p.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),p.off(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),p.off(S.Events.FRAG_LOADING,this.onFragLoading,this),p.off(S.Events.FRAG_LOADED,this.onFragLoaded,this),p.off(S.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),p.off(S.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),p.off(S.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),p.off(S.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),p.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},i.addCues=function(p,m,s,c,_){for(var u=!1,o=_.length;o--;){var n=_[o],g=T(n[0],n[1],m,s);if(g>=0&&(n[0]=Math.min(n[0],m),n[1]=Math.max(n[1],s),u=!0,g/(s-m)>.5))return}if(u||_.push([m,s]),this.config.renderTextTracksNatively){var r=this.captionsTracks[p];this.Cues.newCue(r,m,s,c)}else{var E=this.Cues.newCue(null,m,s,c);this.hls.trigger(S.Events.CUES_PARSED,{type:"captions",cues:E,track:p})}},i.onInitPtsFound=function(p,m){var s=this,c=m.frag,_=m.id,u=m.initPTS,o=m.timescale,n=this.unparsedVttFrags;_==="main"&&(this.initPTS[c.cc]=u,this.timescale[c.cc]=o),n.length&&(this.unparsedVttFrags=[],n.forEach(function(g){s.onFragLoaded(S.Events.FRAG_LOADED,g)}))},i.getExistingTrack=function(p){var m=this.media;if(m)for(var s=0;s<m.textTracks.length;s++){var c=m.textTracks[s];if(c[p])return c}return null},i.createCaptionsTrack=function(p){this.config.renderTextTracksNatively?this.createNativeTrack(p):this.createNonNativeTrack(p)},i.createNativeTrack=function(p){if(!this.captionsTracks[p]){var m=this.captionsProperties,s=this.captionsTracks,c=this.media,_=m[p],u=_.label,o=_.languageCode,n=this.getExistingTrack(p);if(n)s[p]=n,(0,C.clearCurrentCues)(s[p]),(0,C.sendAddTrackEvent)(s[p],c);else{var g=this.createTextTrack("captions",u,o);g&&(g[p]=!0,s[p]=g)}}},i.createNonNativeTrack=function(p){if(!this.nonNativeCaptionsTracks[p]){var m=this.captionsProperties[p];if(!!m){var s=m.label,c={_id:p,label:s,kind:"captions",default:m.media?!!m.media.default:!1,closedCaptions:m.media};this.nonNativeCaptionsTracks[p]=c,this.hls.trigger(S.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[c]})}}},i.createTextTrack=function(p,m,s){var c=this.media;if(!!c)return c.addTextTrack(p,m,s)},i.onMediaAttaching=function(p,m){this.media=m.media,this._cleanTracks()},i.onMediaDetaching=function(){var p=this.captionsTracks;Object.keys(p).forEach(function(m){(0,C.clearCurrentCues)(p[m]),delete p[m]}),this.nonNativeCaptionsTracks={}},i.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=d(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},i._cleanTracks=function(){var p=this.media;if(!!p){var m=p.textTracks;if(m)for(var s=0;s<m.length;s++)(0,C.clearCurrentCues)(m[s])}},i.onSubtitleTracksUpdated=function(p,m){var s=this;this.textTracks=[];var c=m.subtitleTracks||[],_=c.some(function(g){return g.textCodec===I.IMSC1_CODEC});if(this.config.enableWebVTT||_&&this.config.enableIMSC1){var u=this.tracks&&c&&this.tracks.length===c.length;if(this.tracks=c||[],this.config.renderTextTracksNatively){var o=this.media?this.media.textTracks:[];this.tracks.forEach(function(g,r){var E;if(r<o.length){for(var P=null,y=0;y<o.length;y++)if(D(o[y],g)){P=o[y];break}P&&(E=P)}if(E)(0,C.clearCurrentCues)(E);else{var U=s._captionsOrSubtitlesFromCharacteristics(g);E=s.createTextTrack(U,g.name,g.lang),E&&(E.mode="disabled")}E&&(E.groupId=g.groupId,s.textTracks.push(E))})}else if(!u&&this.tracks&&this.tracks.length){var n=this.tracks.map(function(g){return{label:g.name,kind:g.type.toLowerCase(),default:g.default,subtitleTrack:g}});this.hls.trigger(S.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:n})}}},i._captionsOrSubtitlesFromCharacteristics=function(p){var m;if((m=p.attrs)!==null&&m!==void 0&&m.CHARACTERISTICS){var s=/transcribes-spoken-dialog/gi.test(p.attrs.CHARACTERISTICS),c=/describes-music-and-sound/gi.test(p.attrs.CHARACTERISTICS);if(s&&c)return"captions"}return"subtitles"},i.onManifestLoaded=function(p,m){var s=this;this.config.enableCEA708Captions&&m.captions&&m.captions.forEach(function(c){var _=/(?:CC|SERVICE)([1-4])/.exec(c.instreamId);if(!!_){var u="textTrack"+_[1],o=s.captionsProperties[u];!o||(o.label=c.name,c.lang&&(o.languageCode=c.lang),o.media=c)}})},i.closedCaptionsForLevel=function(p){var m=this.hls.levels[p.level];return m==null?void 0:m.attrs["CLOSED-CAPTIONS"]},i.onFragLoading=function(p,m){var s=this.cea608Parser1,c=this.cea608Parser2,_=this.lastSn,u=this.lastPartIndex;if(!(!this.enabled||!(s&&c))&&m.frag.type===L.PlaylistLevelType.MAIN){var o,n,g=m.frag.sn,r=(o=m==null||(n=m.part)===null||n===void 0?void 0:n.index)!=null?o:-1;g===_+1||g===_&&r===u+1||(s.reset(),c.reset()),this.lastSn=g,this.lastPartIndex=r}},i.onFragLoaded=function(p,m){var s=m.frag,c=m.payload,_=this.initPTS,u=this.unparsedVttFrags;if(s.type===L.PlaylistLevelType.SUBTITLE)if(c.byteLength){if(!(0,w.isFiniteNumber)(_[s.cc])){u.push(m),_.length&&this.hls.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Missing initial subtitle PTS")});return}var o=s.decryptdata,n="stats"in m;if(o==null||!o.encrypted||n){var g=this.tracks[s.level],r=this.vttCCs;r[s.cc]||(r[s.cc]={start:s.start,prevCC:this.prevCC,new:!0},this.prevCC=s.cc),g&&g.textCodec===I.IMSC1_CODEC?this._parseIMSC1(s,c):this._parseVTTs(s,c,r)}}else this.hls.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Empty subtitle payload")})},i._parseIMSC1=function(p,m){var s=this,c=this.hls;(0,I.parseIMSC1)(m,this.initPTS[p.cc],this.timescale[p.cc],function(_){s._appendCues(_,p.level),c.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:p})},function(_){A.logger.log("Failed to parse IMSC1: "+_),c.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:p,error:_})})},i._parseVTTs=function(p,m,s){var c,_=this,u=this.hls,o=(c=p.initSegment)!==null&&c!==void 0&&c.data?(0,b.appendUint8Array)(p.initSegment.data,new Uint8Array(m)):m;(0,W.parseWebVTT)(o,this.initPTS[p.cc],this.timescale[p.cc],s,p.cc,p.start,function(n){_._appendCues(n,p.level),u.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:p})},function(n){_._fallbackToIMSC1(p,m),A.logger.log("Failed to parse VTT cue: "+n),u.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:p,error:n})})},i._fallbackToIMSC1=function(p,m){var s=this,c=this.tracks[p.level];c.textCodec||(0,I.parseIMSC1)(m,this.initPTS[p.cc],this.timescale[p.cc],function(){c.textCodec=I.IMSC1_CODEC,s._parseIMSC1(p,m)},function(){c.textCodec="wvtt"})},i._appendCues=function(p,m){var s=this.hls;if(this.config.renderTextTracksNatively){var c=this.textTracks[m];if(!c||c.mode==="disabled")return;p.forEach(function(o){return(0,C.addCueToTrack)(c,o)})}else{var _=this.tracks[m];if(!_)return;var u=_.default?"default":"subtitles"+m;s.trigger(S.Events.CUES_PARSED,{type:"subtitles",cues:p,track:u})}},i.onFragDecrypted=function(p,m){var s=m.frag;if(s.type===L.PlaylistLevelType.SUBTITLE){if(!(0,w.isFiniteNumber)(this.initPTS[s.cc])){this.unparsedVttFrags.push(m);return}this.onFragLoaded(S.Events.FRAG_LOADED,m)}},i.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},i.onFragParsingUserdata=function(p,m){var s=this.cea608Parser1,c=this.cea608Parser2;if(!(!this.enabled||!(s&&c))){var _=m.frag,u=m.samples;if(!(_.type===L.PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(_)==="NONE"))for(var o=0;o<u.length;o++){var n=u[o].bytes;if(n){var g=this.extractCea608Data(n);s.addData(u[o].pts,g[0]),c.addData(u[o].pts,g[1])}}}},i.onBufferFlushing=function(p,m){var s=m.startOffset,c=m.endOffset,_=m.endOffsetSubtitles,u=m.type,o=this.media;if(!(!o||o.currentTime<c)){if(!u||u==="video"){var n=this.captionsTracks;Object.keys(n).forEach(function(r){return(0,C.removeCuesInRange)(n[r],s,c)})}if(this.config.renderTextTracksNatively&&s===0&&_!==void 0){var g=this.textTracks;Object.keys(g).forEach(function(r){return(0,C.removeCuesInRange)(g[r],s,_)})}}},i.extractCea608Data=function(p){for(var m=[[],[]],s=p[0]&31,c=2,_=0;_<s;_++){var u=p[c++],o=127&p[c++],n=127&p[c++];if(!(o===0&&n===0)){var g=(4&u)!==0;if(g){var r=3&u;(r===0||r===1)&&(m[r].push(o),m[r].push(n))}}}return m},f}();function D(f,i){return f&&f.label===i.name&&!(f.textTrack1||f.textTrack2)}function T(f,i,l,p){return Math.min(i,p)-Math.max(f,l)}function d(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}},"./src/crypt/aes-crypto.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>w});var w=function(){function S(R,W){this.subtle=void 0,this.aesIV=void 0,this.subtle=R,this.aesIV=W}var k=S.prototype;return k.decrypt=function(W,C){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},C,W)},S}()},"./src/crypt/aes-decryptor.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>k,removePadding:()=>S});var w=v("./src/utils/typed-array.ts");function S(R){var W=R.byteLength,C=W&&new DataView(R.buffer).getUint8(W-1);return C?(0,w.sliceUint8)(R,0,W-C):R}var k=function(){function R(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var W=R.prototype;return W.uint8ArrayToUint32Array_=function(I){for(var b=new DataView(I),L=new Uint32Array(4),A=0;A<4;A++)L[A]=b.getUint32(A*4);return L},W.initTable=function(){var I=this.sBox,b=this.invSBox,L=this.subMix,A=L[0],h=L[1],D=L[2],T=L[3],d=this.invSubMix,f=d[0],i=d[1],l=d[2],p=d[3],m=new Uint32Array(256),s=0,c=0,_=0;for(_=0;_<256;_++)_<128?m[_]=_<<1:m[_]=_<<1^283;for(_=0;_<256;_++){var u=c^c<<1^c<<2^c<<3^c<<4;u=u>>>8^u&255^99,I[s]=u,b[u]=s;var o=m[s],n=m[o],g=m[n],r=m[u]*257^u*16843008;A[s]=r<<24|r>>>8,h[s]=r<<16|r>>>16,D[s]=r<<8|r>>>24,T[s]=r,r=g*16843009^n*65537^o*257^s*16843008,f[u]=r<<24|r>>>8,i[u]=r<<16|r>>>16,l[u]=r<<8|r>>>24,p[u]=r,s?(s=o^m[m[m[g^o]]],c^=m[m[c]]):s=c=1}},W.expandKey=function(I){for(var b=this.uint8ArrayToUint32Array_(I),L=!0,A=0;A<b.length&&L;)L=b[A]===this.key[A],A++;if(!L){this.key=b;var h=this.keySize=b.length;if(h!==4&&h!==6&&h!==8)throw new Error("Invalid aes key size="+h);var D=this.ksRows=(h+6+1)*4,T,d,f=this.keySchedule=new Uint32Array(D),i=this.invKeySchedule=new Uint32Array(D),l=this.sBox,p=this.rcon,m=this.invSubMix,s=m[0],c=m[1],_=m[2],u=m[3],o,n;for(T=0;T<D;T++){if(T<h){o=f[T]=b[T];continue}n=o,T%h===0?(n=n<<8|n>>>24,n=l[n>>>24]<<24|l[n>>>16&255]<<16|l[n>>>8&255]<<8|l[n&255],n^=p[T/h|0]<<24):h>6&&T%h===4&&(n=l[n>>>24]<<24|l[n>>>16&255]<<16|l[n>>>8&255]<<8|l[n&255]),f[T]=o=(f[T-h]^n)>>>0}for(d=0;d<D;d++)T=D-d,d&3?n=f[T]:n=f[T-4],d<4||T<=4?i[d]=n:i[d]=s[l[n>>>24]]^c[l[n>>>16&255]]^_[l[n>>>8&255]]^u[l[n&255]],i[d]=i[d]>>>0}},W.networkToHostOrderSwap=function(I){return I<<24|(I&65280)<<8|(I&16711680)>>8|I>>>24},W.decrypt=function(I,b,L){for(var A=this.keySize+6,h=this.invKeySchedule,D=this.invSBox,T=this.invSubMix,d=T[0],f=T[1],i=T[2],l=T[3],p=this.uint8ArrayToUint32Array_(L),m=p[0],s=p[1],c=p[2],_=p[3],u=new Int32Array(I),o=new Int32Array(u.length),n,g,r,E,P,y,U,B,F,H,G,V,z,$,X=this.networkToHostOrderSwap;b<u.length;){for(F=X(u[b]),H=X(u[b+1]),G=X(u[b+2]),V=X(u[b+3]),P=F^h[0],y=V^h[1],U=G^h[2],B=H^h[3],z=4,$=1;$<A;$++)n=d[P>>>24]^f[y>>16&255]^i[U>>8&255]^l[B&255]^h[z],g=d[y>>>24]^f[U>>16&255]^i[B>>8&255]^l[P&255]^h[z+1],r=d[U>>>24]^f[B>>16&255]^i[P>>8&255]^l[y&255]^h[z+2],E=d[B>>>24]^f[P>>16&255]^i[y>>8&255]^l[U&255]^h[z+3],P=n,y=g,U=r,B=E,z=z+4;n=D[P>>>24]<<24^D[y>>16&255]<<16^D[U>>8&255]<<8^D[B&255]^h[z],g=D[y>>>24]<<24^D[U>>16&255]<<16^D[B>>8&255]<<8^D[P&255]^h[z+1],r=D[U>>>24]<<24^D[B>>16&255]<<16^D[P>>8&255]<<8^D[y&255]^h[z+2],E=D[B>>>24]<<24^D[P>>16&255]<<16^D[y>>8&255]<<8^D[U&255]^h[z+3],o[b]=X(n^m),o[b+1]=X(E^s),o[b+2]=X(r^c),o[b+3]=X(g^_),m=F,s=H,c=G,_=V,b=b+4}return o.buffer},R}()},"./src/crypt/decrypter.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>b});var w=v("./src/crypt/aes-crypto.ts"),S=v("./src/crypt/fast-aes-key.ts"),k=v("./src/crypt/aes-decryptor.ts"),R=v("./src/utils/logger.ts"),W=v("./src/utils/mp4-tools.ts"),C=v("./src/utils/typed-array.ts"),I=16,b=function(){function L(h,D){var T=D===void 0?{}:D,d=T.removePKCS7Padding,f=d===void 0?!0:d;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=h.enableSoftwareAES,this.removePKCS7Padding=f,f)try{var i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}var A=L.prototype;return A.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},A.isSync=function(){return this.useSoftware},A.flush=function(){var D=this.currentResult,T=this.remainderData;if(!D||T)return this.reset(),null;var d=new Uint8Array(D);return this.reset(),this.removePKCS7Padding?(0,k.removePadding)(d):d},A.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},A.decrypt=function(D,T,d){var f=this;return this.useSoftware?new Promise(function(i,l){f.softwareDecrypt(new Uint8Array(D),T,d);var p=f.flush();p?i(p.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(D),T,d)},A.softwareDecrypt=function(D,T,d){var f=this.currentIV,i=this.currentResult,l=this.remainderData;this.logOnce("JS AES decrypt"),l&&(D=(0,W.appendUint8Array)(l,D),this.remainderData=null);var p=this.getValidChunk(D);if(!p.length)return null;f&&(d=f);var m=this.softwareDecrypter;m||(m=this.softwareDecrypter=new k.default),m.expandKey(T);var s=i;return this.currentResult=m.decrypt(p.buffer,0,d),this.currentIV=(0,C.sliceUint8)(p,-16).buffer,s||null},A.webCryptoDecrypt=function(D,T,d){var f=this,i=this.subtle;return(this.key!==T||!this.fastAesKey)&&(this.key=T,this.fastAesKey=new S.default(i,T)),this.fastAesKey.expandKey().then(function(l){if(!i)return Promise.reject(new Error("web crypto not initialized"));f.logOnce("WebCrypto AES decrypt");var p=new w.default(i,new Uint8Array(d));return p.decrypt(D.buffer,l)}).catch(function(l){return R.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+l.name+": "+l.message),f.onWebCryptoError(D,T,d)})},A.onWebCryptoError=function(D,T,d){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(D,T,d);var f=this.flush();if(f)return f.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},A.getValidChunk=function(D){var T=D,d=D.length-D.length%I;return d!==D.length&&(T=(0,C.sliceUint8)(D,0,d),this.remainderData=(0,C.sliceUint8)(D,d)),T},A.logOnce=function(D){!this.logEnabled||(R.logger.log("[decrypter]: "+D),this.logEnabled=!1)},L}()},"./src/crypt/fast-aes-key.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>w});var w=function(){function S(R,W){this.subtle=void 0,this.key=void 0,this.subtle=R,this.key=W}var k=S.prototype;return k.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},S}()},"./src/demux/aacdemuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>b});var w=v("./src/demux/base-audio-demuxer.ts"),S=v("./src/demux/adts.ts"),k=v("./src/utils/logger.ts"),R=v("./src/demux/id3.ts");function W(L,A){L.prototype=Object.create(A.prototype),L.prototype.constructor=L,C(L,A)}function C(L,A){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,T){return D.__proto__=T,D},C(L,A)}var I=function(L){W(A,L);function A(D,T){var d;return d=L.call(this)||this,d.observer=void 0,d.config=void 0,d.observer=D,d.config=T,d}var h=A.prototype;return h.resetInitSegment=function(T,d,f,i){L.prototype.resetInitSegment.call(this,T,d,f,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:d,duration:i,inputTimeScale:9e4,dropped:0}},A.probe=function(T){if(!T)return!1;for(var d=R.getID3Data(T,0)||[],f=d.length,i=T.length;f<i;f++)if(S.probe(T,f))return k.logger.log("ADTS sync word found !"),!0;return!1},h.canParse=function(T,d){return S.canParse(T,d)},h.appendFrame=function(T,d,f){S.initTrackConfig(T,this.observer,d,f,T.manifestCodec);var i=S.appendFrame(T,d,f,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i},A}(w.default);const b=I},"./src/demux/adts.ts":(N,O,v)=>{v.r(O),v.d(O,{appendFrame:()=>f,canGetFrameLength:()=>b,canParse:()=>A,getAudioConfig:()=>R,getFrameDuration:()=>T,getFullFrameLength:()=>I,getHeaderLength:()=>C,initTrackConfig:()=>D,isHeader:()=>L,isHeaderPattern:()=>W,parseFrameHeader:()=>d,probe:()=>h});var w=v("./src/utils/logger.ts"),S=v("./src/errors.ts"),k=v("./src/events.ts");function R(i,l,p,m){var s,c,_,u,o=navigator.userAgent.toLowerCase(),n=m,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=((l[p+2]&192)>>>6)+1;var r=(l[p+2]&60)>>>2;if(r>g.length-1){i.trigger(k.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+r});return}return _=(l[p+2]&1)<<2,_|=(l[p+3]&192)>>>6,w.logger.log("manifest codec:"+m+", ADTS type:"+s+", samplingIndex:"+r),/firefox/i.test(o)?r>=6?(s=5,u=new Array(4),c=r-3):(s=2,u=new Array(2),c=r):o.indexOf("android")!==-1?(s=2,u=new Array(2),c=r):(s=5,u=new Array(4),m&&(m.indexOf("mp4a.40.29")!==-1||m.indexOf("mp4a.40.5")!==-1)||!m&&r>=6?c=r-3:((m&&m.indexOf("mp4a.40.2")!==-1&&(r>=6&&_===1||/vivaldi/i.test(o))||!m&&_===1)&&(s=2,u=new Array(2)),c=r)),u[0]=s<<3,u[0]|=(r&14)>>1,u[1]|=(r&1)<<7,u[1]|=_<<3,s===5&&(u[1]|=(c&14)>>1,u[2]=(c&1)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:g[r],channelCount:_,codec:"mp4a.40."+s,manifestCodec:n}}function W(i,l){return i[l]===255&&(i[l+1]&246)===240}function C(i,l){return i[l+1]&1?7:9}function I(i,l){return(i[l+3]&3)<<11|i[l+4]<<3|(i[l+5]&224)>>>5}function b(i,l){return l+5<i.length}function L(i,l){return l+1<i.length&&W(i,l)}function A(i,l){return b(i,l)&&W(i,l)&&I(i,l)<=i.length-l}function h(i,l){if(L(i,l)){var p=C(i,l);if(l+p>=i.length)return!1;var m=I(i,l);if(m<=p)return!1;var s=l+m;return s===i.length||L(i,s)}return!1}function D(i,l,p,m,s){if(!i.samplerate){var c=R(l,p,m,s);if(!c)return;i.config=c.config,i.samplerate=c.samplerate,i.channelCount=c.channelCount,i.codec=c.codec,i.manifestCodec=c.manifestCodec,w.logger.log("parsed codec:"+i.codec+", rate:"+c.samplerate+", channels:"+c.channelCount)}}function T(i){return 9216e4/i}function d(i,l){var p=C(i,l);if(l+p<=i.length){var m=I(i,l)-p;if(m>0)return{headerLength:p,frameLength:m}}}function f(i,l,p,m,s){var c=T(i.samplerate),_=m+s*c,u=d(l,p),o;if(u){var n=u.frameLength,g=u.headerLength,r=g+n,E=Math.max(0,p+r-l.length);E?(o=new Uint8Array(r-g),o.set(l.subarray(p+g,l.length),0)):o=l.subarray(p+g,p+r);var P={unit:o,pts:_};return E||i.samples.push(P),{sample:P,length:r,missing:E}}var y=l.length-p;o=new Uint8Array(y),o.set(l.subarray(p,l.length),0);var U={unit:o,pts:_};return{sample:U,length:y,missing:-1}}},"./src/demux/base-audio-demuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>L,initPTSFn:()=>b});var w=v("./src/polyfills/number.ts"),S=v("./src/demux/id3.ts"),k=v("./src/types/demuxer.ts"),R=v("./src/demux/dummy-demuxed-track.ts"),W=v("./src/utils/mp4-tools.ts"),C=v("./src/utils/typed-array.ts"),I=function(){function A(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var h=A.prototype;return h.resetInitSegment=function(T,d,f,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},h.resetTimeStamp=function(T){this.initPTS=T,this.resetContiguity()},h.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},h.canParse=function(T,d){return!1},h.appendFrame=function(T,d,f){},h.demux=function(T,d){this.cachedData&&(T=(0,W.appendUint8Array)(this.cachedData,T),this.cachedData=null);var f=S.getID3Data(T,0),i=f?f.length:0,l,p=this._audioTrack,m=this._id3Track,s=f?S.getTimeStamp(f):void 0,c=T.length;for((this.basePTS===null||this.frameIndex===0&&(0,w.isFiniteNumber)(s))&&(this.basePTS=b(s,d,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),f&&f.length>0&&m.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:f,type:k.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});i<c;){if(this.canParse(T,i)){var _=this.appendFrame(p,T,i);_?(this.frameIndex++,this.lastPTS=_.sample.pts,i+=_.length,l=i):i=c}else S.canParse(T,i)?(f=S.getID3Data(T,i),m.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:f,type:k.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),i+=f.length,l=i):i++;if(i===c&&l!==c){var u=(0,C.sliceUint8)(T,l);this.cachedData?this.cachedData=(0,W.appendUint8Array)(this.cachedData,u):this.cachedData=u}}return{audioTrack:p,videoTrack:(0,R.dummyTrack)(),id3Track:m,textTrack:(0,R.dummyTrack)()}},h.demuxSampleAes=function(T,d,f){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},h.flush=function(T){var d=this.cachedData;return d&&(this.cachedData=null,this.demux(d,0)),{audioTrack:this._audioTrack,videoTrack:(0,R.dummyTrack)(),id3Track:this._id3Track,textTrack:(0,R.dummyTrack)()}},h.destroy=function(){},A}(),b=function(h,D,T){return(0,w.isFiniteNumber)(h)?h*90:D*9e4+(T||0)};const L=I},"./src/demux/chunk-cache.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>w});var w=function(){function k(){this.chunks=[],this.dataLength=0}var R=k.prototype;return R.push=function(C){this.chunks.push(C),this.dataLength+=C.length},R.flush=function(){var C=this.chunks,I=this.dataLength,b;if(C.length)C.length===1?b=C[0]:b=S(C,I);else return new Uint8Array(0);return this.reset(),b},R.reset=function(){this.chunks.length=0,this.dataLength=0},k}();function S(k,R){for(var W=new Uint8Array(R),C=0,I=0;I<k.length;I++){var b=k[I];W.set(b,C),C+=b.length}return W}},"./src/demux/dummy-demuxed-track.ts":(N,O,v)=>{v.r(O),v.d(O,{dummyTrack:()=>w});function w(S,k){return S===void 0&&(S=""),k===void 0&&(k=9e4),{type:S,id:-1,pid:-1,inputTimeScale:k,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>k});var w=v("./src/utils/logger.ts"),S=function(){function R(C){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=C,this.bytesAvailable=C.byteLength,this.word=0,this.bitsAvailable=0}var W=R.prototype;return W.loadWord=function(){var I=this.data,b=this.bytesAvailable,L=I.byteLength-b,A=new Uint8Array(4),h=Math.min(4,b);if(h===0)throw new Error("no bytes available");A.set(I.subarray(L,L+h)),this.word=new DataView(A.buffer).getUint32(0),this.bitsAvailable=h*8,this.bytesAvailable-=h},W.skipBits=function(I){var b;I=Math.min(I,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>I?(this.word<<=I,this.bitsAvailable-=I):(I-=this.bitsAvailable,b=I>>3,I-=b<<3,this.bytesAvailable-=b,this.loadWord(),this.word<<=I,this.bitsAvailable-=I)},W.readBits=function(I){var b=Math.min(this.bitsAvailable,I),L=this.word>>>32-b;if(I>32&&w.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=b,this.bitsAvailable>0)this.word<<=b;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return b=I-b,b>0&&this.bitsAvailable?L<<b|this.readBits(b):L},W.skipLZ=function(){var I;for(I=0;I<this.bitsAvailable;++I)if((this.word&2147483648>>>I)!==0)return this.word<<=I,this.bitsAvailable-=I,I;return this.loadWord(),I+this.skipLZ()},W.skipUEG=function(){this.skipBits(1+this.skipLZ())},W.skipEG=function(){this.skipBits(1+this.skipLZ())},W.readUEG=function(){var I=this.skipLZ();return this.readBits(I+1)-1},W.readEG=function(){var I=this.readUEG();return 1&I?1+I>>>1:-1*(I>>>1)},W.readBoolean=function(){return this.readBits(1)===1},W.readUByte=function(){return this.readBits(8)},W.readUShort=function(){return this.readBits(16)},W.readUInt=function(){return this.readBits(32)},W.skipScalingList=function(I){for(var b=8,L=8,A,h=0;h<I;h++)L!==0&&(A=this.readEG(),L=(b+A+256)%256),b=L===0?b:L},W.readSPS=function(){var I=0,b=0,L=0,A=0,h,D,T,d=this.readUByte.bind(this),f=this.readBits.bind(this),i=this.readUEG.bind(this),l=this.readBoolean.bind(this),p=this.skipBits.bind(this),m=this.skipEG.bind(this),s=this.skipUEG.bind(this),c=this.skipScalingList.bind(this);d();var _=d();if(f(5),p(3),d(),s(),_===100||_===110||_===122||_===244||_===44||_===83||_===86||_===118||_===128){var u=i();if(u===3&&p(1),s(),s(),p(1),l())for(D=u!==3?8:12,T=0;T<D;T++)l()&&(T<6?c(16):c(64))}s();var o=i();if(o===0)i();else if(o===1)for(p(1),m(),m(),h=i(),T=0;T<h;T++)m();s(),p(1);var n=i(),g=i(),r=f(1);r===0&&p(1),p(1),l()&&(I=i(),b=i(),L=i(),A=i());var E=[1,1];if(l()&&l()){var P=d();switch(P){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:{E=[d()<<8|d(),d()<<8|d()];break}}}return{width:Math.ceil((n+1)*16-I*2-b*2),height:(2-r)*(g+1)*16-(r?2:4)*(L+A),pixelRatio:E}},W.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},R}();const k=S},"./src/demux/id3.ts":(N,O,v)=>{v.r(O),v.d(O,{canParse:()=>W,decodeFrame:()=>A,getID3Data:()=>k,getID3Frames:()=>L,getTimeStamp:()=>C,isFooter:()=>S,isHeader:()=>w,isTimeStampFrame:()=>I,testables:()=>i,utf8ArrayToStr:()=>f});var w=function(s,c){return c+10<=s.length&&s[c]===73&&s[c+1]===68&&s[c+2]===51&&s[c+3]<255&&s[c+4]<255&&s[c+6]<128&&s[c+7]<128&&s[c+8]<128&&s[c+9]<128},S=function(s,c){return c+10<=s.length&&s[c]===51&&s[c+1]===68&&s[c+2]===73&&s[c+3]<255&&s[c+4]<255&&s[c+6]<128&&s[c+7]<128&&s[c+8]<128&&s[c+9]<128},k=function(s,c){for(var _=c,u=0;w(s,c);){u+=10;var o=R(s,c+6);u+=o,S(s,c+10)&&(u+=10),c+=u}if(u>0)return s.subarray(_,_+u)},R=function(s,c){var _=0;return _=(s[c]&127)<<21,_|=(s[c+1]&127)<<14,_|=(s[c+2]&127)<<7,_|=s[c+3]&127,_},W=function(s,c){return w(s,c)&&R(s,c+6)+10<=s.length-c},C=function(s){for(var c=L(s),_=0;_<c.length;_++){var u=c[_];if(I(u))return d(u)}},I=function(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"},b=function(s){var c=String.fromCharCode(s[0],s[1],s[2],s[3]),_=R(s,4),u=10;return{type:c,size:_,data:s.subarray(u,u+_)}},L=function(s){for(var c=0,_=[];w(s,c);){var u=R(s,c+6);c+=10;for(var o=c+u;c+8<o;){var n=b(s.subarray(c)),g=A(n);g&&_.push(g),c+=n.size+10}S(s,c)&&(c+=10)}return _},A=function(s){return s.type==="PRIV"?h(s):s.type[0]==="W"?T(s):D(s)},h=function(s){if(!(s.size<2)){var c=f(s.data,!0),_=new Uint8Array(s.data.subarray(c.length+1));return{key:s.type,info:c,data:_.buffer}}},D=function(s){if(!(s.size<2)){if(s.type==="TXXX"){var c=1,_=f(s.data.subarray(c),!0);c+=_.length+1;var u=f(s.data.subarray(c));return{key:s.type,info:_,data:u}}var o=f(s.data.subarray(1));return{key:s.type,data:o}}},T=function(s){if(s.type==="WXXX"){if(s.size<2)return;var c=1,_=f(s.data.subarray(c),!0);c+=_.length+1;var u=f(s.data.subarray(c));return{key:s.type,info:_,data:u}}var o=f(s.data);return{key:s.type,data:o}},d=function(s){if(s.data.byteLength===8){var c=new Uint8Array(s.data),_=c[3]&1,u=(c[4]<<23)+(c[5]<<15)+(c[6]<<7)+c[7];return u/=45,_&&(u+=4772185884e-2),Math.round(u)}},f=function(s,c){c===void 0&&(c=!1);var _=p();if(_){var u=_.decode(s);if(c){var o=u.indexOf("\0");return o!==-1?u.substring(0,o):u}return u.replace(/\0/g,"")}for(var n=s.length,g,r,E,P="",y=0;y<n;){if(g=s[y++],g===0&&c)return P;if(g===0||g===3)continue;switch(g>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:P+=String.fromCharCode(g);break;case 12:case 13:r=s[y++],P+=String.fromCharCode((g&31)<<6|r&63);break;case 14:r=s[y++],E=s[y++],P+=String.fromCharCode((g&15)<<12|(r&63)<<6|(E&63)<<0);break}}return P},i={decodeTextFrame:D},l;function p(){return!l&&typeof self.TextDecoder!="undefined"&&(l=new self.TextDecoder("utf-8")),l}},"./src/demux/mp3demuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>b});var w=v("./src/demux/base-audio-demuxer.ts"),S=v("./src/demux/id3.ts"),k=v("./src/utils/logger.ts"),R=v("./src/demux/mpegaudio.ts");function W(L,A){L.prototype=Object.create(A.prototype),L.prototype.constructor=L,C(L,A)}function C(L,A){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,T){return D.__proto__=T,D},C(L,A)}var I=function(L){W(A,L);function A(){return L.apply(this,arguments)||this}var h=A.prototype;return h.resetInitSegment=function(T,d,f,i){L.prototype.resetInitSegment.call(this,T,d,f,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:d,duration:i,inputTimeScale:9e4,dropped:0}},A.probe=function(T){if(!T)return!1;for(var d=S.getID3Data(T,0)||[],f=d.length,i=T.length;f<i;f++)if(R.probe(T,f))return k.logger.log("MPEG Audio sync word found !"),!0;return!1},h.canParse=function(T,d){return R.canParse(T,d)},h.appendFrame=function(T,d,f){if(this.basePTS!==null)return R.appendFrame(T,d,f,this.basePTS,this.frameIndex)},A}(w.default);const b=I},"./src/demux/mp4demuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>I});var w=v("./src/polyfills/number.ts"),S=v("./src/types/demuxer.ts"),k=v("./src/utils/mp4-tools.ts"),R=v("./src/demux/dummy-demuxed-track.ts"),W=/\/emsg[-/]ID3/i,C=function(){function b(A,h){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=h}var L=b.prototype;return L.resetTimeStamp=function(){},L.resetInitSegment=function(h,D,T,d){var f=this.videoTrack=(0,R.dummyTrack)("video",1),i=this.audioTrack=(0,R.dummyTrack)("audio",1),l=this.txtTrack=(0,R.dummyTrack)("text",1);if(this.id3Track=(0,R.dummyTrack)("id3",1),this.timeOffset=0,!(!h||!h.byteLength)){var p=(0,k.parseInitSegment)(h);if(p.video){var m=p.video,s=m.id,c=m.timescale,_=m.codec;f.id=s,f.timescale=l.timescale=c,f.codec=_}if(p.audio){var u=p.audio,o=u.id,n=u.timescale,g=u.codec;i.id=o,i.timescale=n,i.codec=g}l.id=k.RemuxerTrackIdConfig.text,f.sampleDuration=0,f.duration=i.duration=d}},L.resetContiguity=function(){},b.probe=function(h){return h=h.length>16384?h.subarray(0,16384):h,(0,k.findBox)(h,["moof"]).length>0},L.demux=function(h,D){this.timeOffset=D;var T=h,d=this.videoTrack,f=this.txtTrack;if(this.config.progressive){this.remainderData&&(T=(0,k.appendUint8Array)(this.remainderData,h));var i=(0,k.segmentValidRange)(T);this.remainderData=i.remainder,d.samples=i.valid||new Uint8Array}else d.samples=T;var l=this.extractID3Track(d,D);return f.samples=(0,k.parseSamples)(D,d),{videoTrack:d,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}},L.flush=function(){var h=this.timeOffset,D=this.videoTrack,T=this.txtTrack;D.samples=this.remainderData||new Uint8Array,this.remainderData=null;var d=this.extractID3Track(D,this.timeOffset);return T.samples=(0,k.parseSamples)(h,D),{videoTrack:D,audioTrack:(0,R.dummyTrack)(),id3Track:d,textTrack:(0,R.dummyTrack)()}},L.extractID3Track=function(h,D){var T=this.id3Track;if(h.samples.length){var d=(0,k.findBox)(h.samples,["emsg"]);d&&d.forEach(function(f){var i=(0,k.parseEmsg)(f);if(W.test(i.schemeIdUri)){var l=(0,w.isFiniteNumber)(i.presentationTime)?i.presentationTime/i.timeScale:D+i.presentationTimeDelta/i.timeScale,p=i.eventDuration===4294967295?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;p<=.001&&(p=Number.POSITIVE_INFINITY);var m=i.payload;T.samples.push({data:m,len:m.byteLength,dts:l,pts:l,type:S.MetadataSchema.emsg,duration:p})}})}return T},L.demuxSampleAes=function(h,D,T){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},L.destroy=function(){},b}();const I=C},"./src/demux/mpegaudio.ts":(N,O,v)=>{v.r(O),v.d(O,{appendFrame:()=>C,canParse:()=>A,isHeader:()=>L,isHeaderPattern:()=>b,parseHeader:()=>I,probe:()=>h});var w=null,S=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],k=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],R=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],W=[0,1,1,4];function C(D,T,d,f,i){if(!(d+24>T.length)){var l=I(T,d);if(l&&d+l.frameLength<=T.length){var p=l.samplesPerFrame*9e4/l.sampleRate,m=f+i*p,s={unit:T.subarray(d,d+l.frameLength),pts:m,dts:m};return D.config=[],D.channelCount=l.channelCount,D.samplerate=l.sampleRate,D.samples.push(s),{sample:s,length:l.frameLength,missing:0}}}}function I(D,T){var d=D[T+1]>>3&3,f=D[T+1]>>1&3,i=D[T+2]>>4&15,l=D[T+2]>>2&3;if(d!==1&&i!==0&&i!==15&&l!==3){var p=D[T+2]>>1&1,m=D[T+3]>>6,s=d===3?3-f:f===3?3:4,c=S[s*14+i-1]*1e3,_=d===3?0:d===2?1:2,u=k[_*3+l],o=m===3?1:2,n=R[d][f],g=W[f],r=n*8*g,E=Math.floor(n*c/u+p)*g;if(w===null){var P=navigator.userAgent||"",y=P.match(/Chrome\/(\d+)/i);w=y?parseInt(y[1]):0}var U=!!w&&w<=87;return U&&f===2&&c>=224e3&&m===0&&(D[T+3]=D[T+3]|128),{sampleRate:u,channelCount:o,frameLength:E,samplesPerFrame:r}}}function b(D,T){return D[T]===255&&(D[T+1]&224)===224&&(D[T+1]&6)!==0}function L(D,T){return T+1<D.length&&b(D,T)}function A(D,T){var d=4;return b(D,T)&&d<=D.length-T}function h(D,T){if(T+1<D.length&&b(D,T)){var d=4,f=I(D,T),i=d;f!=null&&f.frameLength&&(i=f.frameLength);var l=T+i;return l===D.length||L(D,l)}return!1}},"./src/demux/sample-aes.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>R});var w=v("./src/crypt/decrypter.ts"),S=v("./src/utils/mp4-tools.ts"),k=function(){function W(I,b,L){this.keyData=void 0,this.decrypter=void 0,this.keyData=L,this.decrypter=new w.default(b,{removePKCS7Padding:!1})}var C=W.prototype;return C.decryptBuffer=function(b){return this.decrypter.decrypt(b,this.keyData.key.buffer,this.keyData.iv.buffer)},C.decryptAacSample=function(b,L,A){var h=this,D=b[L].unit;if(!(D.length<=16)){var T=D.subarray(16,D.length-D.length%16),d=T.buffer.slice(T.byteOffset,T.byteOffset+T.length);this.decryptBuffer(d).then(function(f){var i=new Uint8Array(f);D.set(i,16),h.decrypter.isSync()||h.decryptAacSamples(b,L+1,A)})}},C.decryptAacSamples=function(b,L,A){for(;;L++){if(L>=b.length){A();return}if(!(b[L].unit.length<32)&&(this.decryptAacSample(b,L,A),!this.decrypter.isSync()))return}},C.getAvcEncryptedData=function(b){for(var L=Math.floor((b.length-48)/160)*16+16,A=new Int8Array(L),h=0,D=32;D<b.length-16;D+=160,h+=16)A.set(b.subarray(D,D+16),h);return A},C.getAvcDecryptedUnit=function(b,L){for(var A=new Uint8Array(L),h=0,D=32;D<b.length-16;D+=160,h+=16)b.set(A.subarray(h,h+16),D);return b},C.decryptAvcSample=function(b,L,A,h,D){var T=this,d=(0,S.discardEPB)(D.data),f=this.getAvcEncryptedData(d);this.decryptBuffer(f.buffer).then(function(i){D.data=T.getAvcDecryptedUnit(d,i),T.decrypter.isSync()||T.decryptAvcSamples(b,L,A+1,h)})},C.decryptAvcSamples=function(b,L,A,h){if(b instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;L++,A=0){if(L>=b.length){h();return}for(var D=b[L].units;!(A>=D.length);A++){var T=D[A];if(!(T.data.length<=48||T.type!==1&&T.type!==5)&&(this.decryptAvcSample(b,L,A,h,T),!this.decrypter.isSync()))return}}},W}();const R=k},"./src/demux/transmuxer-interface.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>L});var w=v("./src/demux/webworkify-webpack.js"),S=v("./src/events.ts"),k=v("./src/demux/transmuxer.ts"),R=v("./src/utils/logger.ts"),W=v("./src/errors.ts"),C=v("./src/utils/mediasource-helper.ts"),I=v("./node_modules/eventemitter3/index.js"),b=(0,C.getMediaSource)()||{isTypeSupported:function(){return!1}},L=function(){function A(D,T,d,f){var i=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var l=D.config;this.hls=D,this.id=T,this.useWorker=!!l.enableWorker,this.onTransmuxComplete=d,this.onFlush=f;var p=function(u,o){o=o||{},o.frag=i.frag,o.id=i.id,i.hls.trigger(u,o)};this.observer=new I.EventEmitter,this.observer.on(S.Events.FRAG_DECRYPTED,p),this.observer.on(S.Events.ERROR,p);var m={mp4:b.isTypeSupported("video/mp4"),mpeg:b.isTypeSupported("audio/mpeg"),mp3:b.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(this.useWorker&&typeof Worker!="undefined"){R.logger.log("demuxing in webworker");var c;try{c=this.worker=(0,w.default)("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),c.addEventListener("message",this.onwmsg),c.onerror=function(_){i.useWorker=!1,R.logger.warn("Exception in webworker, fallback to inline"),i.hls.trigger(S.Events.ERROR,{type:W.ErrorTypes.OTHER_ERROR,details:W.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(_.message+"  ("+_.filename+":"+_.lineno+")")})},c.postMessage({cmd:"init",typeSupported:m,vendor:s,id:T,config:JSON.stringify(l)})}catch(_){R.logger.warn("Error in worker:",_),R.logger.error("Error while initializing DemuxerWorker, fallback to inline"),c&&self.URL.revokeObjectURL(c.objectURL),this.transmuxer=new k.default(this.observer,m,l,s,T),this.worker=null}}else this.transmuxer=new k.default(this.observer,m,l,s,T)}var h=A.prototype;return h.destroy=function(){var T=this.worker;if(T)T.removeEventListener("message",this.onwmsg),T.terminate(),this.worker=null,this.onwmsg=void 0;else{var d=this.transmuxer;d&&(d.destroy(),this.transmuxer=null)}var f=this.observer;f&&f.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},h.push=function(T,d,f,i,l,p,m,s,c,_){var u,o,n=this;c.transmuxing.start=self.performance.now();var g=this.transmuxer,r=this.worker,E=p?p.start:l.start,P=l.decryptdata,y=this.frag,U=!(y&&l.cc===y.cc),B=!(y&&c.level===y.level),F=y?c.sn-y.sn:-1,H=this.part?c.part-this.part.index:-1,G=F===0&&c.id>1&&c.id===(y==null?void 0:y.stats.chunkCount),V=!B&&(F===1||F===0&&(H===1||G&&H<=0)),z=self.performance.now();(B||F||l.stats.parsing.start===0)&&(l.stats.parsing.start=z),p&&(H||!V)&&(p.stats.parsing.start=z);var $=!(y&&((u=l.initSegment)===null||u===void 0?void 0:u.url)===((o=y.initSegment)===null||o===void 0?void 0:o.url)),X=new k.TransmuxState(U,V,s,B,E,$);if(!V||U||$){R.logger.log("[transmuxer-interface, "+l.type+"]: Starting new transmux session for sn: "+c.sn+" p: "+c.part+" level: "+c.level+" id: "+c.id+`
        discontinuity: `+U+`
        trackSwitch: `+B+`
        contiguous: `+V+`
        accurateTimeOffset: `+s+`
        timeOffset: `+E+`
        initSegmentChange: `+$);var j=new k.TransmuxConfig(f,i,d,m,_);this.configureTransmuxer(j)}if(this.frag=l,this.part=p,r)r.postMessage({cmd:"demux",data:T,decryptdata:P,chunkMeta:c,state:X},T instanceof ArrayBuffer?[T]:[]);else if(g){var Y=g.push(T,P,c,X);(0,k.isPromise)(Y)?(g.async=!0,Y.then(function(Q){n.handleTransmuxComplete(Q)}).catch(function(Q){n.transmuxerError(Q,c,"transmuxer-interface push error")})):(g.async=!1,this.handleTransmuxComplete(Y))}},h.flush=function(T){var d=this;T.transmuxing.start=self.performance.now();var f=this.transmuxer,i=this.worker;if(i)i.postMessage({cmd:"flush",chunkMeta:T});else if(f){var l=f.flush(T),p=(0,k.isPromise)(l);p||f.async?((0,k.isPromise)(l)||(l=Promise.resolve(l)),l.then(function(m){d.handleFlushResult(m,T)}).catch(function(m){d.transmuxerError(m,T,"transmuxer-interface flush error")})):this.handleFlushResult(l,T)}},h.transmuxerError=function(T,d,f){!this.hls||this.hls.trigger(S.Events.ERROR,{type:W.ErrorTypes.MEDIA_ERROR,details:W.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:d,fatal:!1,error:T,err:T,reason:f})},h.handleFlushResult=function(T,d){var f=this;T.forEach(function(i){f.handleTransmuxComplete(i)}),this.onFlush(d)},h.onWorkerMessage=function(T){var d=T.data,f=this.hls;switch(d.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":R.logger[d.data.logType]&&R.logger[d.data.logType](d.data.message);break;default:{d.data=d.data||{},d.data.frag=this.frag,d.data.id=this.id,f.trigger(d.event,d.data);break}}},h.configureTransmuxer=function(T){var d=this.worker,f=this.transmuxer;d?d.postMessage({cmd:"configure",config:T}):f&&f.configure(T)},h.handleTransmuxComplete=function(T){T.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(T)},A}()},"./src/demux/transmuxer-worker.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>C});var w=v("./src/demux/transmuxer.ts"),S=v("./src/events.ts"),k=v("./src/utils/logger.ts"),R=v("./node_modules/eventemitter3/index.js"),W=v("./src/errors.ts");function C(h){var D=new R.EventEmitter,T=function(i,l){h.postMessage({event:i,data:l})};D.on(S.Events.FRAG_DECRYPTED,T),D.on(S.Events.ERROR,T);var d=function(){var i=function(m){var s=function(_){T("workerLog",{logType:m,message:_})};k.logger[m]=s};for(var l in k.logger)i(l)};h.addEventListener("message",function(f){var i=f.data;switch(i.cmd){case"init":{var l=JSON.parse(i.config);h.transmuxer=new w.default(D,i.typeSupported,l,i.vendor,i.id),(0,k.enableLogs)(l.debug,i.id),d(),T("init",null);break}case"configure":{h.transmuxer.configure(i.config);break}case"demux":{var p=h.transmuxer.push(i.data,i.decryptdata,i.chunkMeta,i.state);(0,w.isPromise)(p)?(h.transmuxer.async=!0,p.then(function(_){I(h,_)}).catch(function(_){T(S.Events.ERROR,{type:W.ErrorTypes.MEDIA_ERROR,details:W.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:i.chunkMeta,fatal:!1,error:_,err:_,reason:"transmuxer-worker push error"})})):(h.transmuxer.async=!1,I(h,p));break}case"flush":{var m=i.chunkMeta,s=h.transmuxer.flush(m),c=(0,w.isPromise)(s);c||h.transmuxer.async?((0,w.isPromise)(s)||(s=Promise.resolve(s)),s.then(function(_){L(h,_,m)}).catch(function(_){T(S.Events.ERROR,{type:W.ErrorTypes.MEDIA_ERROR,details:W.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:i.chunkMeta,fatal:!1,error:_,err:_,reason:"transmuxer-worker flush error"})})):L(h,s,m);break}}})}function I(h,D){if(A(D.remuxResult))return!1;var T=[],d=D.remuxResult,f=d.audio,i=d.video;return f&&b(T,f),i&&b(T,i),h.postMessage({event:"transmuxComplete",data:D},T),!0}function b(h,D){D.data1&&h.push(D.data1.buffer),D.data2&&h.push(D.data2.buffer)}function L(h,D,T){var d=D.reduce(function(f,i){return I(h,i)||f},!1);d||h.postMessage({event:"transmuxComplete",data:D[0]}),h.postMessage({event:"flush",data:T})}function A(h){return!h.audio&&!h.video&&!h.text&&!h.id3&&!h.initSegment}},"./src/demux/transmuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{TransmuxConfig:()=>l,TransmuxState:()=>p,default:()=>T,isPromise:()=>i});var w=v("./src/events.ts"),S=v("./src/errors.ts"),k=v("./src/crypt/decrypter.ts"),R=v("./src/demux/aacdemuxer.ts"),W=v("./src/demux/mp4demuxer.ts"),C=v("./src/demux/tsdemuxer.ts"),I=v("./src/demux/mp3demuxer.ts"),b=v("./src/remux/mp4-remuxer.ts"),L=v("./src/remux/passthrough-remuxer.ts"),A=v("./src/utils/logger.ts"),h;try{h=self.performance.now.bind(self.performance)}catch{A.logger.debug("Unable to use Performance API on this environment"),h=self.Date.now}var D=[{demux:W.default,remux:L.default},{demux:C.default,remux:b.default},{demux:R.default,remux:b.default},{demux:I.default,remux:b.default}],T=function(){function m(c,_,u,o,n){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=c,this.typeSupported=_,this.config=u,this.vendor=o,this.id=n}var s=m.prototype;return s.configure=function(_){this.transmuxConfig=_,this.decrypter&&this.decrypter.reset()},s.push=function(_,u,o,n){var g=this,r=o.transmuxing;r.executeStart=h();var E=new Uint8Array(_),P=this.currentTransmuxState,y=this.transmuxConfig;n&&(this.currentTransmuxState=n);var U=n||P,B=U.contiguous,F=U.discontinuity,H=U.trackSwitch,G=U.accurateTimeOffset,V=U.timeOffset,z=U.initSegmentChange,$=y.audioCodec,X=y.videoCodec,j=y.defaultInitPts,Y=y.duration,Q=y.initSegmentData,J=d(E,u);if(J&&J.method==="AES-128"){var Z=this.getDecrypter();if(Z.isSync()){var ee=Z.softwareDecrypt(E,J.key.buffer,J.iv.buffer),ne=o.part>-1;if(ne&&(ee=Z.flush()),!ee)return r.executeEnd=h(),f(o);E=new Uint8Array(ee)}else return this.decryptionPromise=Z.webCryptoDecrypt(E,J.key.buffer,J.iv.buffer).then(function(se){var ie=g.push(se,null,o);return g.decryptionPromise=null,ie}),this.decryptionPromise}var te=this.needsProbing(F,H);te&&this.configureTransmuxer(E),(F||H||z||te)&&this.resetInitSegment(Q,$,X,Y,u),(F||z||te)&&this.resetInitialTimestamp(j),B||this.resetContiguity();var q=this.transmux(E,J,V,G,o),re=this.currentTransmuxState;return re.contiguous=!0,re.discontinuity=!1,re.trackSwitch=!1,r.executeEnd=h(),q},s.flush=function(_){var u=this,o=_.transmuxing;o.executeStart=h();var n=this.decrypter,g=this.currentTransmuxState,r=this.decryptionPromise;if(r)return r.then(function(){return u.flush(_)});var E=[],P=g.timeOffset;if(n){var y=n.flush();y&&E.push(this.push(y,null,_))}var U=this.demuxer,B=this.remuxer;if(!U||!B)return this.observer.emit(w.Events.ERROR,w.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),o.executeEnd=h(),[f(_)];var F=U.flush(P);return i(F)?F.then(function(H){return u.flushRemux(E,H,_),E}):(this.flushRemux(E,F,_),E)},s.flushRemux=function(_,u,o){var n=u.audioTrack,g=u.videoTrack,r=u.id3Track,E=u.textTrack,P=this.currentTransmuxState,y=P.accurateTimeOffset,U=P.timeOffset;A.logger.log("[transmuxer.ts]: Flushed fragment "+o.sn+(o.part>-1?" p: "+o.part:"")+" of level "+o.level);var B=this.remuxer.remux(n,g,r,E,U,y,!0,this.id);_.push({remuxResult:B,chunkMeta:o}),o.transmuxing.executeEnd=h()},s.resetInitialTimestamp=function(_){var u=this.demuxer,o=this.remuxer;!u||!o||(u.resetTimeStamp(_),o.resetTimeStamp(_))},s.resetContiguity=function(){var _=this.demuxer,u=this.remuxer;!_||!u||(_.resetContiguity(),u.resetNextTimestamp())},s.resetInitSegment=function(_,u,o,n,g){var r=this.demuxer,E=this.remuxer;!r||!E||(r.resetInitSegment(_,u,o,n),E.resetInitSegment(_,u,o,g))},s.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},s.transmux=function(_,u,o,n,g){var r;return u&&u.method==="SAMPLE-AES"?r=this.transmuxSampleAes(_,u,o,n,g):r=this.transmuxUnencrypted(_,o,n,g),r},s.transmuxUnencrypted=function(_,u,o,n){var g=this.demuxer.demux(_,u,!1,!this.config.progressive),r=g.audioTrack,E=g.videoTrack,P=g.id3Track,y=g.textTrack,U=this.remuxer.remux(r,E,P,y,u,o,!1,this.id);return{remuxResult:U,chunkMeta:n}},s.transmuxSampleAes=function(_,u,o,n,g){var r=this;return this.demuxer.demuxSampleAes(_,u,o).then(function(E){var P=r.remuxer.remux(E.audioTrack,E.videoTrack,E.id3Track,E.textTrack,o,n,!1,r.id);return{remuxResult:P,chunkMeta:g}})},s.configureTransmuxer=function(_){for(var u=this.config,o=this.observer,n=this.typeSupported,g=this.vendor,r,E=0,P=D.length;E<P;E++)if(D[E].demux.probe(_)){r=D[E];break}r||(A.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),r={demux:W.default,remux:L.default});var y=this.demuxer,U=this.remuxer,B=r.remux,F=r.demux;(!U||!(U instanceof B))&&(this.remuxer=new B(o,u,n,g)),(!y||!(y instanceof F))&&(this.demuxer=new F(o,u,n),this.probe=F.probe)},s.needsProbing=function(_,u){return!this.demuxer||!this.remuxer||_||u},s.getDecrypter=function(){var _=this.decrypter;return _||(_=this.decrypter=new k.default(this.config)),_},m}();function d(m,s){var c=null;return m.byteLength>0&&s!=null&&s.key!=null&&s.iv!==null&&s.method!=null&&(c=s),c}var f=function(s){return{remuxResult:{},chunkMeta:s}};function i(m){return"then"in m&&m.then instanceof Function}var l=function(s,c,_,u,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=s,this.videoCodec=c,this.initSegmentData=_,this.duration=u,this.defaultInitPts=o},p=function(s,c,_,u,o,n){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=s,this.contiguous=c,this.accurateTimeOffset=_,this.trackSwitch=u,this.timeOffset=o,this.initSegmentChange=n}},"./src/demux/tsdemuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>m});var w=v("./src/demux/adts.ts"),S=v("./src/demux/mpegaudio.ts"),k=v("./src/demux/exp-golomb.ts"),R=v("./src/demux/sample-aes.ts"),W=v("./src/events.ts"),C=v("./src/utils/mp4-tools.ts"),I=v("./src/utils/logger.ts"),b=v("./src/errors.ts"),L=v("./src/types/demuxer.ts");function A(){return A=Object.assign?Object.assign.bind():function(s){for(var c=1;c<arguments.length;c++){var _=arguments[c];for(var u in _)Object.prototype.hasOwnProperty.call(_,u)&&(s[u]=_[u])}return s},A.apply(this,arguments)}var h=188,D=function(){function s(_,u,o){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=_,this.config=u,this.typeSupported=o}s.probe=function(u){var o=s.syncOffset(u);return o>0&&I.logger.warn("MPEG2-TS detected but first sync word found @ offset "+o),o!==-1},s.syncOffset=function(u){for(var o=Math.min(h*5,u.length-h)+1,n=0;n<o;){for(var g=!1,r=0;r<o&&u[r]===71;r+=h)if(!g&&d(u,r)===0&&(g=!0),g&&r+h>o)return n;n++}return-1},s.createTrack=function(u,o){return{container:u==="video"||u==="audio"?"video/mp2t":void 0,type:u,id:C.RemuxerTrackIdConfig[u],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:u==="audio"?o:void 0}};var c=s.prototype;return c.resetInitSegment=function(u,o,n,g){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=s.createTrack("video"),this._audioTrack=s.createTrack("audio",g),this._id3Track=s.createTrack("id3"),this._txtTrack=s.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=o,this.videoCodec=n,this._duration=g},c.resetTimeStamp=function(){},c.resetContiguity=function(){var u=this._audioTrack,o=this._avcTrack,n=this._id3Track;u&&(u.pesData=null),o&&(o.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},c.demux=function(u,o,n,g){n===void 0&&(n=!1),g===void 0&&(g=!1),n||(this.sampleAes=null);var r,E=this._avcTrack,P=this._audioTrack,y=this._id3Track,U=this._txtTrack,B=E.pid,F=E.pesData,H=P.pid,G=y.pid,V=P.pesData,z=y.pesData,$=null,X=this.pmtParsed,j=this._pmtId,Y=u.length;if(this.remainderData&&(u=(0,C.appendUint8Array)(this.remainderData,u),Y=u.length,this.remainderData=null),Y<h&&!g)return this.remainderData=u,{audioTrack:P,videoTrack:E,id3Track:y,textTrack:U};var Q=Math.max(0,s.syncOffset(u));Y-=(Y-Q)%h,Y<u.byteLength&&!g&&(this.remainderData=new Uint8Array(u.buffer,Y,u.buffer.byteLength-Y));for(var J=0,Z=Q;Z<Y;Z+=h)if(u[Z]===71){var ee=!!(u[Z+1]&64),ne=d(u,Z),te=(u[Z+3]&48)>>4,q=void 0;if(te>1){if(q=Z+5+u[Z+4],q===Z+h)continue}else q=Z+4;switch(ne){case B:ee&&(F&&(r=l(F))&&this.parseAVCPES(E,U,r,!1),F={data:[],size:0}),F&&(F.data.push(u.subarray(q,Z+h)),F.size+=Z+h-q);break;case H:if(ee){if(V&&(r=l(V)))switch(P.segmentCodec){case"aac":this.parseAACPES(P,r);break;case"mp3":this.parseMPEGPES(P,r);break}V={data:[],size:0}}V&&(V.data.push(u.subarray(q,Z+h)),V.size+=Z+h-q);break;case G:ee&&(z&&(r=l(z))&&this.parseID3PES(y,r),z={data:[],size:0}),z&&(z.data.push(u.subarray(q,Z+h)),z.size+=Z+h-q);break;case 0:ee&&(q+=u[q]+1),j=this._pmtId=f(u,q);break;case j:{ee&&(q+=u[q]+1);var re=i(u,q,this.typeSupported,n);B=re.avc,B>0&&(E.pid=B),H=re.audio,H>0&&(P.pid=H,P.segmentCodec=re.segmentCodec),G=re.id3,G>0&&(y.pid=G),$!==null&&!X&&(I.logger.log("unknown PID '"+$+"' in TS found"),$=null,Z=Q-188),X=this.pmtParsed=!0;break}case 17:case 8191:break;default:$=ne;break}}else J++;J>0&&this.observer.emit(W.Events.ERROR,W.Events.ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+J+" TS packet/s that do not start with 0x47"}),E.pesData=F,P.pesData=V,y.pesData=z;var se={audioTrack:P,videoTrack:E,id3Track:y,textTrack:U};return g&&this.extractRemainingSamples(se),se},c.flush=function(){var u=this.remainderData;this.remainderData=null;var o;return u?o=this.demux(u,-1,!1,!0):o={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(o),this.sampleAes?this.decrypt(o,this.sampleAes):o},c.extractRemainingSamples=function(u){var o=u.audioTrack,n=u.videoTrack,g=u.id3Track,r=u.textTrack,E=n.pesData,P=o.pesData,y=g.pesData,U;if(E&&(U=l(E))?(this.parseAVCPES(n,r,U,!0),n.pesData=null):n.pesData=E,P&&(U=l(P))){switch(o.segmentCodec){case"aac":this.parseAACPES(o,U);break;case"mp3":this.parseMPEGPES(o,U);break}o.pesData=null}else P!=null&&P.size&&I.logger.log("last AAC PES packet truncated,might overlap between fragments"),o.pesData=P;y&&(U=l(y))?(this.parseID3PES(g,U),g.pesData=null):g.pesData=y},c.demuxSampleAes=function(u,o,n){var g=this.demux(u,n,!0,!this.config.progressive),r=this.sampleAes=new R.default(this.observer,this.config,o);return this.decrypt(g,r)},c.decrypt=function(u,o){return new Promise(function(n){var g=u.audioTrack,r=u.videoTrack;g.samples&&g.segmentCodec==="aac"?o.decryptAacSamples(g.samples,0,function(){r.samples?o.decryptAvcSamples(r.samples,0,0,function(){n(u)}):n(u)}):r.samples&&o.decryptAvcSamples(r.samples,0,0,function(){n(u)})})},c.destroy=function(){this._duration=0},c.parseAVCPES=function(u,o,n,g){var r=this,E=this.parseAVCNALu(u,n.data),P=this.avcSample,y,U=!1;n.data=null,P&&E.length&&!u.audFound&&(p(P,u),P=this.avcSample=T(!1,n.pts,n.dts,"")),E.forEach(function(B){switch(B.type){case 1:{y=!0,P||(P=r.avcSample=T(!0,n.pts,n.dts,"")),P.frame=!0;var F=B.data;if(U&&F.length>4){var H=new k.default(F).readSliceType();(H===2||H===4||H===7||H===9)&&(P.key=!0)}break}case 5:y=!0,P||(P=r.avcSample=T(!0,n.pts,n.dts,"")),P.key=!0,P.frame=!0;break;case 6:{y=!0,(0,C.parseSEIMessageFromNALu)(B.data,1,n.pts,o.samples);break}case 7:if(y=!0,U=!0,!u.sps){var G=new k.default(B.data),V=G.readSPS();u.width=V.width,u.height=V.height,u.pixelRatio=V.pixelRatio,u.sps=[B.data],u.duration=r._duration;for(var z=B.data.subarray(1,4),$="avc1.",X=0;X<3;X++){var j=z[X].toString(16);j.length<2&&(j="0"+j),$+=j}u.codec=$}break;case 8:y=!0,u.pps||(u.pps=[B.data]);break;case 9:y=!1,u.audFound=!0,P&&p(P,u),P=r.avcSample=T(!1,n.pts,n.dts,"");break;case 12:y=!0;break;default:y=!1,P&&(P.debug+="unknown NAL "+B.type+" ");break}if(P&&y){var Y=P.units;Y.push(B)}}),g&&P&&(p(P,u),this.avcSample=null)},c.getLastNalUnit=function(u){var o,n=this.avcSample,g;if((!n||n.units.length===0)&&(n=u[u.length-1]),(o=n)!==null&&o!==void 0&&o.units){var r=n.units;g=r[r.length-1]}return g},c.parseAVCNALu=function(u,o){var n=o.byteLength,g=u.naluState||0,r=g,E=[],P=0,y,U,B,F=-1,H=0;for(g===-1&&(F=0,H=o[0]&31,g=0,P=1);P<n;){if(y=o[P++],!g){g=y?0:1;continue}if(g===1){g=y?0:2;continue}if(!y)g=3;else if(y===1){if(F>=0){var G={data:o.subarray(F,P-g-1),type:H};E.push(G)}else{var V=this.getLastNalUnit(u.samples);if(V&&(r&&P<=4-r&&V.state&&(V.data=V.data.subarray(0,V.data.byteLength-r)),U=P-g-1,U>0)){var z=new Uint8Array(V.data.byteLength+U);z.set(V.data,0),z.set(o.subarray(0,U),V.data.byteLength),V.data=z,V.state=0}}P<n?(B=o[P]&31,F=P,H=B,g=0):g=-1}else g=0}if(F>=0&&g>=0){var $={data:o.subarray(F,n),type:H,state:g};E.push($)}if(E.length===0){var X=this.getLastNalUnit(u.samples);if(X){var j=new Uint8Array(X.data.byteLength+o.byteLength);j.set(X.data,0),j.set(o,X.data.byteLength),X.data=j}}return u.naluState=g,E},c.parseAACPES=function(u,o){var n=0,g=this.aacOverFlow,r=o.data;if(g){this.aacOverFlow=null;var E=g.missing,P=g.sample.unit.byteLength;if(E===-1){var y=new Uint8Array(P+r.byteLength);y.set(g.sample.unit,0),y.set(r,P),r=y}else{var U=P-E;g.sample.unit.set(r.subarray(0,E),U),u.samples.push(g.sample),n=g.missing}}var B,F;for(B=n,F=r.length;B<F-1&&!w.isHeader(r,B);B++);if(B!==n){var H,G;if(B<F-1?(H="AAC PES did not start with ADTS header,offset:"+B,G=!1):(H="no ADTS header found in AAC PES",G=!0),I.logger.warn("parsing error:"+H),this.observer.emit(W.Events.ERROR,W.Events.ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.FRAG_PARSING_ERROR,fatal:G,reason:H}),G)return}w.initTrackConfig(u,this.observer,r,B,this.audioCodec);var V;if(o.pts!==void 0)V=o.pts;else if(g){var z=w.getFrameDuration(u.samplerate);V=g.sample.pts+z}else{I.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var $=0,X;B<F;)if(X=w.appendFrame(u,r,B,V,$),B+=X.length,X.missing){this.aacOverFlow=X;break}else for($++;B<F-1&&!w.isHeader(r,B);B++);},c.parseMPEGPES=function(u,o){var n=o.data,g=n.length,r=0,E=0,P=o.pts;if(P===void 0){I.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;E<g;)if(S.isHeader(n,E)){var y=S.appendFrame(u,n,E,P,r);if(y)E+=y.length,r++;else break}else E++},c.parseID3PES=function(u,o){if(o.pts===void 0){I.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var n=A({},o,{type:this._avcTrack?L.MetadataSchema.emsg:L.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});u.samples.push(n)},s}();function T(s,c,_,u){return{key:s,frame:!1,pts:c,dts:_,units:[],debug:u,length:0}}function d(s,c){return((s[c+1]&31)<<8)+s[c+2]}function f(s,c){return(s[c+10]&31)<<8|s[c+11]}function i(s,c,_,u){var o={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},n=(s[c+1]&15)<<8|s[c+2],g=c+3+n-4,r=(s[c+10]&15)<<8|s[c+11];for(c+=12+r;c<g;){var E=d(s,c);switch(s[c]){case 207:if(!u){I.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:o.audio===-1&&(o.audio=E);break;case 21:o.id3===-1&&(o.id3=E);break;case 219:if(!u){I.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:o.avc===-1&&(o.avc=E);break;case 3:case 4:_.mpeg!==!0&&_.mp3!==!0?I.logger.log("MPEG audio found, not supported in this browser"):o.audio===-1&&(o.audio=E,o.segmentCodec="mp3");break;case 36:I.logger.warn("Unsupported HEVC stream type found");break}c+=((s[c+3]&15)<<8|s[c+4])+5}return o}function l(s){var c=0,_,u,o,n,g,r=s.data;if(!s||s.size===0)return null;for(;r[0].length<19&&r.length>1;){var E=new Uint8Array(r[0].length+r[1].length);E.set(r[0]),E.set(r[1],r[0].length),r[0]=E,r.splice(1,1)}_=r[0];var P=(_[0]<<16)+(_[1]<<8)+_[2];if(P===1){if(u=(_[4]<<8)+_[5],u&&u>s.size-6)return null;var y=_[7];y&192&&(n=(_[9]&14)*536870912+(_[10]&255)*4194304+(_[11]&254)*16384+(_[12]&255)*128+(_[13]&254)/2,y&64?(g=(_[14]&14)*536870912+(_[15]&255)*4194304+(_[16]&254)*16384+(_[17]&255)*128+(_[18]&254)/2,n-g>54e5&&(I.logger.warn(Math.round((n-g)/9e4)+"s delta between PTS and DTS, align them"),n=g)):g=n),o=_[8];var U=o+9;if(s.size<=U)return null;s.size-=U;for(var B=new Uint8Array(s.size),F=0,H=r.length;F<H;F++){_=r[F];var G=_.byteLength;if(U)if(U>G){U-=G;continue}else _=_.subarray(U),G-=U,U=0;B.set(_,c),c+=G}return u&&(u-=o+3),{data:B,pts:n,dts:g,len:u}}return null}function p(s,c){if(s.units.length&&s.frame){if(s.pts===void 0){var _=c.samples,u=_.length;if(u){var o=_[u-1];s.pts=o.pts,s.dts=o.dts}else{c.dropped++;return}}c.samples.push(s)}s.debug.length&&I.logger.log(s.pts+"/"+s.dts+":"+s.debug)}const m=D},"./src/demux/webworkify-webpack.js":(N,O,v)=>{v.r(O),v.d(O,{default:()=>h});var w=function(){var T=ENTRY_MODULE,d={},f=function l(p){var m=d[p];if(m!==void 0)return m.exports;var s=d[p]={exports:{}};return T[p].call(s.exports,s,s.exports,l),s.exports};f.m=T,function(){f.n=function(l){var p=l&&l.__esModule?function(){return l.default}:function(){return l};return f.d(p,{a:p}),p}}(),function(){f.d=function(l,p){for(var m in p)f.o(p,m)&&!f.o(l,m)&&Object.defineProperty(l,m,{enumerable:!0,get:p[m]})}}(),function(){f.o=function(l,p){return Object.prototype.hasOwnProperty.call(l,p)}}(),function(){f.r=function(l){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})}}();var i=f(ENTRY_MODULE);return i.default||i},S=w.toString().split("ENTRY_MODULE"),k="[\\.|\\-|\\+|\\w|/|@]+",R="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+k+").*?\\)";function W(D){return(D+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function C(D){return!isNaN(1*D)}function I(D,T,d){var f={};f[d]=[];var i=T.toString().replace(/^"[^"]+"/,"function"),l=i.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||i.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!l)return f;for(var p=l[1],m=new RegExp("(\\\\n|\\W)"+W(p)+R,"g"),s;s=m.exec(i);)s[3]!=="dll-reference"&&f[d].push(s[3]);for(m=new RegExp("\\("+W(p)+'\\("(dll-reference\\s('+k+'))"\\)\\)'+R,"g");s=m.exec(i);)D[s[2]]||(f[d].push(s[1]),D[s[2]]=v(s[1]).m),f[s[2]]=f[s[2]]||[],f[s[2]].push(s[4]);for(var c=Object.keys(f),_=0;_<c.length;_++)for(var u=0;u<f[c[_]].length;u++)C(f[c[_]][u])&&(f[c[_]][u]=1*f[c[_]][u]);return f}function b(D){var T=Object.keys(D);return T.reduce(function(d,f){return d||D[f].length>0},!1)}function L(D,T){for(var d={main:[T]},f={main:[]},i={main:{}};b(d);)for(var l=Object.keys(d),p=0;p<l.length;p++){var m=l[p],s=d[m],c=s.pop();if(i[m]=i[m]||{},!(i[m][c]||!D[m][c])){i[m][c]=!0,f[m]=f[m]||[],f[m].push(c);for(var _=I(D,D[m][c],m),u=Object.keys(_),o=0;o<u.length;o++)d[u[o]]=d[u[o]]||[],d[u[o]]=d[u[o]].concat(_[u[o]])}}return f}function A(D,T,d,f){var i=D[f].map(function(l){return'"'+l+'": '+T[f][l].toString().replace(/^"[^"]+"/,"function")}).join(",");return S[0]+"{"+i+"}"+S[1]+'"'+d+'"'+S[2]}function h(D,T){T=T||{};var d={main:v.m},f=T.all?{main:Object.keys(d.main)}:L(d,D),i="";Object.keys(f).filter(function(c){return c!=="main"}).forEach(function(c){for(var _=0;f[c][_];)_++;f[c].push(_),d[c][_]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",i=i+("var "+c+" = ("+A(f,d,_,modules)+`)();
`)}),i=i+("new (("+A(f,d,D,"main")+")())(self);");var l=new window.Blob([i],{type:"text/javascript"}),p=window.URL||window.webkitURL||window.mozURL||window.msURL,m=p.createObjectURL(l),s=new window.Worker(m);return s.objectURL=m,s}},"./src/errors.ts":(N,O,v)=>{v.r(O),v.d(O,{ErrorDetails:()=>S,ErrorTypes:()=>w});var w;(function(k){k.NETWORK_ERROR="networkError",k.MEDIA_ERROR="mediaError",k.KEY_SYSTEM_ERROR="keySystemError",k.MUX_ERROR="muxError",k.OTHER_ERROR="otherError"})(w||(w={}));var S;(function(k){k.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",k.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",k.KEY_SYSTEM_NO_SESSION="keySystemNoSession",k.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",k.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",k.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",k.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",k.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",k.MANIFEST_LOAD_ERROR="manifestLoadError",k.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",k.MANIFEST_PARSING_ERROR="manifestParsingError",k.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",k.LEVEL_EMPTY_ERROR="levelEmptyError",k.LEVEL_LOAD_ERROR="levelLoadError",k.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",k.LEVEL_SWITCH_ERROR="levelSwitchError",k.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",k.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",k.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",k.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",k.FRAG_LOAD_ERROR="fragLoadError",k.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",k.FRAG_DECRYPT_ERROR="fragDecryptError",k.FRAG_PARSING_ERROR="fragParsingError",k.REMUX_ALLOC_ERROR="remuxAllocError",k.KEY_LOAD_ERROR="keyLoadError",k.KEY_LOAD_TIMEOUT="keyLoadTimeOut",k.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",k.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",k.BUFFER_APPEND_ERROR="bufferAppendError",k.BUFFER_APPENDING_ERROR="bufferAppendingError",k.BUFFER_STALLED_ERROR="bufferStalledError",k.BUFFER_FULL_ERROR="bufferFullError",k.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",k.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",k.INTERNAL_EXCEPTION="internalException",k.INTERNAL_ABORTED="aborted",k.UNKNOWN="unknown"})(S||(S={}))},"./src/events.ts":(N,O,v)=>{v.r(O),v.d(O,{Events:()=>w});var w;(function(S){S.MEDIA_ATTACHING="hlsMediaAttaching",S.MEDIA_ATTACHED="hlsMediaAttached",S.MEDIA_DETACHING="hlsMediaDetaching",S.MEDIA_DETACHED="hlsMediaDetached",S.BUFFER_RESET="hlsBufferReset",S.BUFFER_CODECS="hlsBufferCodecs",S.BUFFER_CREATED="hlsBufferCreated",S.BUFFER_APPENDING="hlsBufferAppending",S.BUFFER_APPENDED="hlsBufferAppended",S.BUFFER_EOS="hlsBufferEos",S.BUFFER_FLUSHING="hlsBufferFlushing",S.BUFFER_FLUSHED="hlsBufferFlushed",S.MANIFEST_LOADING="hlsManifestLoading",S.MANIFEST_LOADED="hlsManifestLoaded",S.MANIFEST_PARSED="hlsManifestParsed",S.LEVEL_SWITCHING="hlsLevelSwitching",S.LEVEL_SWITCHED="hlsLevelSwitched",S.LEVEL_LOADING="hlsLevelLoading",S.LEVEL_LOADED="hlsLevelLoaded",S.LEVEL_UPDATED="hlsLevelUpdated",S.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",S.LEVELS_UPDATED="hlsLevelsUpdated",S.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",S.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",S.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",S.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",S.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",S.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",S.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",S.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",S.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",S.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",S.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",S.CUES_PARSED="hlsCuesParsed",S.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",S.INIT_PTS_FOUND="hlsInitPtsFound",S.FRAG_LOADING="hlsFragLoading",S.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",S.FRAG_LOADED="hlsFragLoaded",S.FRAG_DECRYPTED="hlsFragDecrypted",S.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",S.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",S.FRAG_PARSING_METADATA="hlsFragParsingMetadata",S.FRAG_PARSED="hlsFragParsed",S.FRAG_BUFFERED="hlsFragBuffered",S.FRAG_CHANGED="hlsFragChanged",S.FPS_DROP="hlsFpsDrop",S.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",S.ERROR="hlsError",S.DESTROYING="hlsDestroying",S.KEY_LOADING="hlsKeyLoading",S.KEY_LOADED="hlsKeyLoaded",S.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",S.BACK_BUFFER_REACHED="hlsBackBufferReached"})(w||(w={}))},"./src/hls.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>s});var w=v("./node_modules/url-toolkit/src/url-toolkit.js"),S=v("./src/loader/playlist-loader.ts"),k=v("./src/controller/id3-track-controller.ts"),R=v("./src/controller/latency-controller.ts"),W=v("./src/controller/level-controller.ts"),C=v("./src/controller/fragment-tracker.ts"),I=v("./src/loader/key-loader.ts"),b=v("./src/controller/stream-controller.ts"),L=v("./src/is-supported.ts"),A=v("./src/utils/logger.ts"),h=v("./src/config.ts"),D=v("./node_modules/eventemitter3/index.js"),T=v("./src/events.ts"),d=v("./src/errors.ts"),f=v("./src/types/level.ts");function i(c,_){for(var u=0;u<_.length;u++){var o=_[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(c,p(o.key),o)}}function l(c,_,u){return _&&i(c.prototype,_),u&&i(c,u),Object.defineProperty(c,"prototype",{writable:!1}),c}function p(c){var _=m(c,"string");return typeof _=="symbol"?_:String(_)}function m(c,_){if(typeof c!="object"||c===null)return c;var u=c[Symbol.toPrimitive];if(u!==void 0){var o=u.call(c,_||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(c)}var s=function(){c.isSupported=function(){return(0,L.isSupported)()};function c(u){u===void 0&&(u={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new D.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var o=this.config=(0,h.mergeConfig)(c.DefaultConfig,u);this.userConfig=u,(0,A.enableLogs)(o.debug,"Hls instance"),this._autoLevelCapping=-1,o.progressive&&(0,h.enableStreamingMode)(o);var n=o.abrController,g=o.bufferController,r=o.capLevelController,E=o.fpsController,P=this.abrController=new n(this),y=this.bufferController=new g(this),U=this.capLevelController=new r(this),B=new E(this),F=new S.default(this),H=new k.default(this),G=this.levelController=new W.default(this),V=new C.FragmentTracker(this),z=new I.default(this.config),$=this.streamController=new b.default(this,V,z);U.setStreamController($),B.setStreamController($);var X=[F,G,$];this.networkControllers=X;var j=[P,y,U,B,H,V];this.audioTrackController=this.createController(o.audioTrackController,X);var Y=o.audioStreamController;Y&&X.push(new Y(this,V,z)),this.subtitleTrackController=this.createController(o.subtitleTrackController,X);var Q=o.subtitleStreamController;Q&&X.push(new Q(this,V,z)),this.createController(o.timelineController,j),z.emeController=this.emeController=this.createController(o.emeController,j),this.cmcdController=this.createController(o.cmcdController,j),this.latencyController=this.createController(R.default,j),this.coreComponents=j}var _=c.prototype;return _.createController=function(o,n){if(o){var g=new o(this);return n&&n.push(g),g}return null},_.on=function(o,n,g){g===void 0&&(g=this),this._emitter.on(o,n,g)},_.once=function(o,n,g){g===void 0&&(g=this),this._emitter.once(o,n,g)},_.removeAllListeners=function(o){this._emitter.removeAllListeners(o)},_.off=function(o,n,g,r){g===void 0&&(g=this),this._emitter.off(o,n,g,r)},_.listeners=function(o){return this._emitter.listeners(o)},_.emit=function(o,n,g){return this._emitter.emit(o,n,g)},_.trigger=function(o,n){if(this.config.debug)return this.emit(o,o,n);try{return this.emit(o,o,n)}catch(g){A.logger.error("An internal error happened while handling event "+o+'. Error message: "'+g.message+'". Here is a stacktrace:',g),this.trigger(T.Events.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:o,error:g})}return!1},_.listenerCount=function(o){return this._emitter.listenerCount(o)},_.destroy=function(){A.logger.log("destroy"),this.trigger(T.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(o){return o.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(o){return o.destroy()}),this.coreComponents.length=0},_.attachMedia=function(o){A.logger.log("attachMedia"),this._media=o,this.trigger(T.Events.MEDIA_ATTACHING,{media:o})},_.detachMedia=function(){A.logger.log("detachMedia"),this.trigger(T.Events.MEDIA_DETACHING,void 0),this._media=null},_.loadSource=function(o){this.stopLoad();var n=this.media,g=this.url,r=this.url=w.buildAbsoluteURL(self.location.href,o,{alwaysNormalize:!0});A.logger.log("loadSource:"+r),n&&g&&g!==r&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(n)),this.trigger(T.Events.MANIFEST_LOADING,{url:o})},_.startLoad=function(o){o===void 0&&(o=-1),A.logger.log("startLoad("+o+")"),this.networkControllers.forEach(function(n){n.startLoad(o)})},_.stopLoad=function(){A.logger.log("stopLoad"),this.networkControllers.forEach(function(o){o.stopLoad()})},_.swapAudioCodec=function(){A.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},_.recoverMediaError=function(){A.logger.log("recoverMediaError");var o=this._media;this.detachMedia(),o&&this.attachMedia(o)},_.removeLevel=function(o,n){n===void 0&&(n=0),this.levelController.removeLevel(o,n)},l(c,[{key:"levels",get:function(){var o=this.levelController.levels;return o||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(o){A.logger.log("set currentLevel:"+o),this.loadLevel=o,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(o){A.logger.log("set nextLevel:"+o),this.levelController.manualLevel=o,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(o){A.logger.log("set loadLevel:"+o),this.levelController.manualLevel=o}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(o){this.levelController.nextLoadLevel=o}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(o){A.logger.log("set firstLevel:"+o),this.levelController.firstLevel=o}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(o){A.logger.log("set startLevel:"+o),o!==-1&&(o=Math.max(o,this.minAutoLevel)),this.levelController.startLevel=o}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(o){var n=!!o;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(o){this._autoLevelCapping!==o&&(A.logger.log("set autoLevelCapping:"+o),this._autoLevelCapping=o)}},{key:"bandwidthEstimate",get:function(){var o=this.abrController.bwEstimator;return o?o.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(o){f.HdcpLevels.indexOf(o)>-1&&(this._maxHdcpLevel=o)}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var o=this.levels,n=this.config.minAutoBitrate;if(!o)return 0;for(var g=o.length,r=0;r<g;r++)if(o[r].maxBitrate>=n)return r;return 0}},{key:"maxAutoLevel",get:function(){var o=this.levels,n=this.autoLevelCapping,g=this.maxHdcpLevel,r;if(n===-1&&o&&o.length?r=o.length-1:r=n,g)for(var E=r;E--;){var P=o[E].attrs["HDCP-LEVEL"];if(P&&P<=g)return E}return r}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(o){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,o)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var o=this.audioTrackController;return o?o.audioTracks:[]}},{key:"audioTrack",get:function(){var o=this.audioTrackController;return o?o.audioTrack:-1},set:function(o){var n=this.audioTrackController;n&&(n.audioTrack=o)}},{key:"subtitleTracks",get:function(){var o=this.subtitleTrackController;return o?o.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var o=this.subtitleTrackController;return o?o.subtitleTrack:-1},set:function(o){var n=this.subtitleTrackController;n&&(n.subtitleTrack=o)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var o=this.subtitleTrackController;return o?o.subtitleDisplay:!1},set:function(o){var n=this.subtitleTrackController;n&&(n.subtitleDisplay=o)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(o){this.config.lowLatencyMode=o}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.3.3"}},{key:"Events",get:function(){return T.Events}},{key:"ErrorTypes",get:function(){return d.ErrorTypes}},{key:"ErrorDetails",get:function(){return d.ErrorDetails}},{key:"DefaultConfig",get:function(){return c.defaultConfig?c.defaultConfig:h.hlsDefaultConfig},set:function(o){c.defaultConfig=o}}]),c}();s.defaultConfig=void 0},"./src/is-supported.ts":(N,O,v)=>{v.r(O),v.d(O,{changeTypeSupported:()=>R,isSupported:()=>k});var w=v("./src/utils/mediasource-helper.ts");function S(){return self.SourceBuffer||self.WebKitSourceBuffer}function k(){var W=(0,w.getMediaSource)();if(!W)return!1;var C=S(),I=W&&typeof W.isTypeSupported=="function"&&W.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),b=!C||C.prototype&&typeof C.prototype.appendBuffer=="function"&&typeof C.prototype.remove=="function";return!!I&&!!b}function R(){var W,C=S();return typeof(C==null||(W=C.prototype)===null||W===void 0?void 0:W.changeType)=="function"}},"./src/loader/date-range.ts":(N,O,v)=>{v.r(O),v.d(O,{DateRange:()=>A,DateRangeAttribute:()=>L});var w=v("./src/polyfills/number.ts"),S=v("./src/utils/attr-list.ts"),k=v("./src/utils/logger.ts");function R(){return R=Object.assign?Object.assign.bind():function(h){for(var D=1;D<arguments.length;D++){var T=arguments[D];for(var d in T)Object.prototype.hasOwnProperty.call(T,d)&&(h[d]=T[d])}return h},R.apply(this,arguments)}function W(h,D){for(var T=0;T<D.length;T++){var d=D[T];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(h,I(d.key),d)}}function C(h,D,T){return D&&W(h.prototype,D),T&&W(h,T),Object.defineProperty(h,"prototype",{writable:!1}),h}function I(h){var D=b(h,"string");return typeof D=="symbol"?D:String(D)}function b(h,D){if(typeof h!="object"||h===null)return h;var T=h[Symbol.toPrimitive];if(T!==void 0){var d=T.call(h,D||"default");if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(h)}var L;(function(h){h.ID="ID",h.CLASS="CLASS",h.START_DATE="START-DATE",h.DURATION="DURATION",h.END_DATE="END-DATE",h.END_ON_NEXT="END-ON-NEXT",h.PLANNED_DURATION="PLANNED-DURATION",h.SCTE35_OUT="SCTE35-OUT",h.SCTE35_IN="SCTE35-IN"})(L||(L={}));var A=function(){function h(D,T){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,T){var d=T.attr;for(var f in d)if(Object.prototype.hasOwnProperty.call(D,f)&&D[f]!==d[f]){k.logger.warn('DATERANGE tag attribute: "'+f+'" does not match for tags with ID: "'+D.ID+'"'),this._badValueForSameId=f;break}D=R(new S.AttrList({}),d,D)}if(this.attr=D,this._startDate=new Date(D[L.START_DATE]),L.END_DATE in this.attr){var i=new Date(this.attr[L.END_DATE]);(0,w.isFiniteNumber)(i.getTime())&&(this._endDate=i)}}return C(h,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var T=this.duration;return T!==null?new Date(this._startDate.getTime()+T*1e3):null}},{key:"duration",get:function(){if(L.DURATION in this.attr){var T=this.attr.decimalFloatingPoint(L.DURATION);if((0,w.isFiniteNumber)(T))return T}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return L.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(L.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(L.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,w.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),h}()},"./src/loader/fragment-loader.ts":(N,O,v)=>{v.r(O),v.d(O,{LoadError:()=>T,default:()=>h});var w=v("./src/polyfills/number.ts"),S=v("./src/errors.ts");function k(d,f){d.prototype=Object.create(f.prototype),d.prototype.constructor=d,b(d,f)}function R(d){var f=typeof Map=="function"?new Map:void 0;return R=function(l){if(l===null||!I(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof f!="undefined"){if(f.has(l))return f.get(l);f.set(l,p)}function p(){return W(l,arguments,L(this).constructor)}return p.prototype=Object.create(l.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),b(p,l)},R(d)}function W(d,f,i){return C()?W=Reflect.construct.bind():W=function(p,m,s){var c=[null];c.push.apply(c,m);var _=Function.bind.apply(p,c),u=new _;return s&&b(u,s.prototype),u},W.apply(null,arguments)}function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I(d){return Function.toString.call(d).indexOf("[native code]")!==-1}function b(d,f){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,p){return l.__proto__=p,l},b(d,f)}function L(d){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},L(d)}var A=Math.pow(2,17),h=function(){function d(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}var f=d.prototype;return f.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},f.abort=function(){this.loader&&this.loader.abort()},f.load=function(l,p){var m=this,s=l.url;if(!s)return Promise.reject(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,networkDetails:null},"Fragment does not have a "+(s?"part list":"url")));this.abort();var c=this.config,_=c.fLoader,u=c.loader;return new Promise(function(o,n){m.loader&&m.loader.destroy();var g=m.loader=l.loader=_?new _(c):new u(c),r=D(l),E={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:l.sn==="initSegment"?1/0:A};l.stats=g.stats,g.load(r,E,{onSuccess:function(y,U,B,F){m.resetLoader(l,g);var H=y.data;B.resetIV&&l.decryptdata&&(l.decryptdata.iv=new Uint8Array(H.slice(0,16)),H=H.slice(16)),o({frag:l,part:null,payload:H,networkDetails:F})},onError:function(y,U,B){m.resetLoader(l,g),n(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,response:y,networkDetails:B}))},onAbort:function(y,U,B){m.resetLoader(l,g),n(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:l,networkDetails:B}))},onTimeout:function(y,U,B){m.resetLoader(l,g),n(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,networkDetails:B}))},onProgress:function(y,U,B,F){p&&p({frag:l,part:null,payload:B,networkDetails:F})}})})},f.loadPart=function(l,p,m){var s=this;this.abort();var c=this.config,_=c.fLoader,u=c.loader;return new Promise(function(o,n){s.loader&&s.loader.destroy();var g=s.loader=l.loader=_?new _(c):new u(c),r=D(l,p),E={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:A};p.stats=g.stats,g.load(r,E,{onSuccess:function(y,U,B,F){s.resetLoader(l,g),s.updateStatsFromPart(l,p);var H={frag:l,part:p,payload:y.data,networkDetails:F};m(H),o(H)},onError:function(y,U,B){s.resetLoader(l,g),n(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,part:p,response:y,networkDetails:B}))},onAbort:function(y,U,B){l.stats.aborted=p.stats.aborted,s.resetLoader(l,g),n(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:l,part:p,networkDetails:B}))},onTimeout:function(y,U,B){s.resetLoader(l,g),n(new T({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,part:p,networkDetails:B}))}})})},f.updateStatsFromPart=function(l,p){var m=l.stats,s=p.stats,c=s.total;if(m.loaded+=s.loaded,c){var _=Math.round(l.duration/p.duration),u=Math.min(Math.round(m.loaded/c),_),o=_-u,n=o*Math.round(m.loaded/u);m.total=m.loaded+n}else m.total=Math.max(m.loaded,m.total);var g=m.loading,r=s.loading;g.start?g.first+=r.first-r.start:(g.start=r.start,g.first=r.first),g.end=r.end},f.resetLoader=function(l,p){l.loader=null,this.loader===p&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),p.destroy()},d}();function D(d,f){f===void 0&&(f=null);var i=f||d,l={frag:d,part:f,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},p=i.byteRangeStartOffset,m=i.byteRangeEndOffset;if((0,w.isFiniteNumber)(p)&&(0,w.isFiniteNumber)(m)){var s,c=p,_=m;if(d.sn==="initSegment"&&((s=d.decryptdata)===null||s===void 0?void 0:s.method)==="AES-128"){var u=m-p;u%16&&(_=m+(16-u%16)),p!==0&&(l.resetIV=!0,c=p-16)}l.rangeStart=c,l.rangeEnd=_}return l}var T=function(d){k(f,d);function f(i){for(var l,p=arguments.length,m=new Array(p>1?p-1:0),s=1;s<p;s++)m[s-1]=arguments[s];return l=d.call.apply(d,[this].concat(m))||this,l.data=void 0,l.data=i,l}return f}(R(Error))},"./src/loader/fragment.ts":(N,O,v)=>{v.r(O),v.d(O,{BaseSegment:()=>h,ElementaryStreamTypes:()=>A,Fragment:()=>D,Part:()=>T});var w=v("./src/polyfills/number.ts"),S=v("./node_modules/url-toolkit/src/url-toolkit.js"),k=v("./src/loader/load-stats.ts");function R(d,f){d.prototype=Object.create(f.prototype),d.prototype.constructor=d,W(d,f)}function W(d,f){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,p){return l.__proto__=p,l},W(d,f)}function C(d,f){for(var i=0;i<f.length;i++){var l=f[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,b(l.key),l)}}function I(d,f,i){return f&&C(d.prototype,f),i&&C(d,i),Object.defineProperty(d,"prototype",{writable:!1}),d}function b(d){var f=L(d,"string");return typeof f=="symbol"?f:String(f)}function L(d,f){if(typeof d!="object"||d===null)return d;var i=d[Symbol.toPrimitive];if(i!==void 0){var l=i.call(d,f||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(d)}var A;(function(d){d.AUDIO="audio",d.VIDEO="video",d.AUDIOVIDEO="audiovideo"})(A||(A={}));var h=function(){function d(i){var l;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(l={},l[A.AUDIO]=null,l[A.VIDEO]=null,l[A.AUDIOVIDEO]=null,l),this.baseurl=i}var f=d.prototype;return f.setByteRange=function(l,p){var m=l.split("@",2),s=[];m.length===1?s[0]=p?p.byteRangeEndOffset:0:s[0]=parseInt(m[1]),s[1]=parseInt(m[0])+s[0],this._byteRange=s},I(d,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,S.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(l){this._url=l}}]),d}(),D=function(d){R(f,d);function f(l,p){var m;return m=d.call(this,p)||this,m._decryptdata=null,m.rawProgramDateTime=null,m.programDateTime=null,m.tagList=[],m.duration=0,m.sn=0,m.levelkeys=void 0,m.type=void 0,m.loader=null,m.keyLoader=null,m.level=-1,m.cc=0,m.startPTS=void 0,m.endPTS=void 0,m.appendedPTS=void 0,m.startDTS=void 0,m.endDTS=void 0,m.start=0,m.deltaPTS=void 0,m.maxStartPTS=void 0,m.minEndPTS=void 0,m.stats=new k.LoadStats,m.urlId=0,m.data=void 0,m.bitrateTest=!1,m.title=null,m.initSegment=null,m.endList=void 0,m.type=l,m}var i=f.prototype;return i.setKeyFormat=function(p){if(this.levelkeys){var m=this.levelkeys[p];m&&!this._decryptdata&&(this._decryptdata=m.getDecryptData(this.sn))}},i.abortRequests=function(){var p,m;(p=this.loader)===null||p===void 0||p.abort(),(m=this.keyLoader)===null||m===void 0||m.abort()},i.setElementaryStreamInfo=function(p,m,s,c,_,u){u===void 0&&(u=!1);var o=this.elementaryStreams,n=o[p];if(!n){o[p]={startPTS:m,endPTS:s,startDTS:c,endDTS:_,partial:u};return}n.startPTS=Math.min(n.startPTS,m),n.endPTS=Math.max(n.endPTS,s),n.startDTS=Math.min(n.startDTS,c),n.endDTS=Math.max(n.endDTS,_)},i.clearElementaryStreamInfo=function(){var p=this.elementaryStreams;p[A.AUDIO]=null,p[A.VIDEO]=null,p[A.AUDIOVIDEO]=null},I(f,[{key:"decryptdata",get:function(){var p=this.levelkeys;if(!p&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var m=this.levelkeys.identity;if(m)this._decryptdata=m.getDecryptData(this.sn);else{var s=Object.keys(this.levelkeys);if(s.length===1)return this._decryptdata=this.levelkeys[s[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,w.isFiniteNumber)(this.programDateTime))return null;var p=(0,w.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+p*1e3}},{key:"encrypted",get:function(){var p;if((p=this._decryptdata)!==null&&p!==void 0&&p.encrypted)return!0;if(this.levelkeys){var m=Object.keys(this.levelkeys),s=m.length;if(s>1||s===1&&this.levelkeys[m[0]].encrypted)return!0}return!1}}]),f}(h),T=function(d){R(f,d);function f(i,l,p,m,s){var c;c=d.call(this,p)||this,c.fragOffset=0,c.duration=0,c.gap=!1,c.independent=!1,c.relurl=void 0,c.fragment=void 0,c.index=void 0,c.stats=new k.LoadStats,c.duration=i.decimalFloatingPoint("DURATION"),c.gap=i.bool("GAP"),c.independent=i.bool("INDEPENDENT"),c.relurl=i.enumeratedString("URI"),c.fragment=l,c.index=m;var _=i.enumeratedString("BYTERANGE");return _&&c.setByteRange(_,s),s&&(c.fragOffset=s.fragOffset+s.duration),c}return I(f,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var l=this.elementaryStreams;return!!(l.audio||l.video||l.audiovideo)}}]),f}(h)},"./src/loader/key-loader.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>k});var w=v("./src/errors.ts"),S=v("./src/loader/fragment-loader.ts"),k=function(){function R(C){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=C}var W=R.prototype;return W.abort=function(){for(var I in this.keyUriToKeyInfo){var b=this.keyUriToKeyInfo[I].loader;b&&b.abort()}},W.detach=function(){for(var I in this.keyUriToKeyInfo){var b=this.keyUriToKeyInfo[I];(b.mediaKeySessionContext||b.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[I]}},W.destroy=function(){this.detach();for(var I in this.keyUriToKeyInfo){var b=this.keyUriToKeyInfo[I].loader;b&&b.destroy()}this.keyUriToKeyInfo={}},W.createKeyLoadError=function(I,b,L,A){return b===void 0&&(b=w.ErrorDetails.KEY_LOAD_ERROR),new S.LoadError({type:w.ErrorTypes.NETWORK_ERROR,details:b,fatal:!1,frag:I,networkDetails:L})},W.loadClear=function(I,b){var L=this;if(this.emeController&&this.config.emeEnabled)for(var A=I.sn,h=I.cc,D=function(i){var l=b[i];if(h<=l.cc&&(A==="initSegment"||A<l.sn))return L.emeController.selectKeySystemFormat(l).then(function(p){l.setKeyFormat(p)}),"break"},T=0;T<b.length;T++){var d=D(T);if(d==="break")break}},W.load=function(I){var b=this;return!I.decryptdata&&I.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(I).then(function(L){return b.loadInternal(I,L)}):this.loadInternal(I)},W.loadInternal=function(I,b){var L,A;b&&I.setKeyFormat(b);var h=I.decryptdata;if(!h){var D=b?"Expected frag.decryptdata to be defined after setting format "+b:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(I,w.ErrorDetails.KEY_LOAD_ERROR,null,D))}var T=h.uri;if(!T)return Promise.reject(this.createKeyLoadError(I,w.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+T+'"'));var d=this.keyUriToKeyInfo[T];if((L=d)!==null&&L!==void 0&&L.decryptdata.key)return h.key=d.decryptdata.key,Promise.resolve({frag:I,keyInfo:d});if((A=d)!==null&&A!==void 0&&A.keyLoadPromise){var f;switch((f=d.mediaKeySessionContext)===null||f===void 0?void 0:f.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return d.keyLoadPromise}}switch(d=this.keyUriToKeyInfo[T]={decryptdata:h,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},h.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return h.keyFormat==="identity"?this.loadKeyHTTP(d,I):this.loadKeyEME(d,I);case"AES-128":return this.loadKeyHTTP(d,I);default:return Promise.reject(this.createKeyLoadError(I,w.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+h.method+'"'))}},W.loadKeyEME=function(I,b){var L={frag:b,keyInfo:I};if(this.emeController&&this.config.emeEnabled){var A=this.emeController.loadKey(L);if(A)return(I.keyLoadPromise=A.then(function(h){return I.mediaKeySessionContext=h,L})).catch(function(h){throw I.keyLoadPromise=null,h})}return Promise.resolve(L)},W.loadKeyHTTP=function(I,b){var L=this,A=this.config,h=A.loader,D=new h(A);return b.keyLoader=I.loader=D,I.keyLoadPromise=new Promise(function(T,d){var f={keyInfo:I,frag:b,responseType:"arraybuffer",url:I.decryptdata.uri},i={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:A.fragLoadingRetryDelay,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:0},l={onSuccess:function(m,s,c,_){var u=c.frag,o=c.keyInfo,n=c.url;if(!u.decryptdata||o!==L.keyUriToKeyInfo[n])return d(L.createKeyLoadError(u,w.ErrorDetails.KEY_LOAD_ERROR,_,"after key load, decryptdata unset or changed"));o.decryptdata.key=u.decryptdata.key=new Uint8Array(m.data),u.keyLoader=null,o.loader=null,T({frag:u,keyInfo:o})},onError:function(m,s,c){L.resetLoader(s),d(L.createKeyLoadError(b,w.ErrorDetails.KEY_LOAD_ERROR,c))},onTimeout:function(m,s,c){L.resetLoader(s),d(L.createKeyLoadError(b,w.ErrorDetails.KEY_LOAD_TIMEOUT,c))},onAbort:function(m,s,c){L.resetLoader(s),d(L.createKeyLoadError(b,w.ErrorDetails.INTERNAL_ABORTED,c))}};D.load(f,i,l)})},W.resetLoader=function(I){var b=I.frag,L=I.keyInfo,A=I.url,h=L.loader;b.keyLoader===h&&(b.keyLoader=null,L.loader=null),delete this.keyUriToKeyInfo[A],h&&h.destroy()},R}()},"./src/loader/level-details.ts":(N,O,v)=>{v.r(O),v.d(O,{LevelDetails:()=>I});var w=v("./src/polyfills/number.ts");function S(b,L){for(var A=0;A<L.length;A++){var h=L[A];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(b,R(h.key),h)}}function k(b,L,A){return L&&S(b.prototype,L),A&&S(b,A),Object.defineProperty(b,"prototype",{writable:!1}),b}function R(b){var L=W(b,"string");return typeof L=="symbol"?L:String(L)}function W(b,L){if(typeof b!="object"||b===null)return b;var A=b[Symbol.toPrimitive];if(A!==void 0){var h=A.call(b,L||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(L==="string"?String:Number)(b)}var C=10,I=function(){function b(A){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=A}var L=b.prototype;return L.reloaded=function(h){if(!h){this.advanced=!0,this.updated=!0;return}var D=this.lastPartSn-h.lastPartSn,T=this.lastPartIndex-h.lastPartIndex;this.updated=this.endSN!==h.endSN||!!T||!!D,this.advanced=this.endSN>h.endSN||D>0||D===0&&T>0,this.updated||this.advanced?this.misses=Math.floor(h.misses*.6):this.misses=h.misses+1,this.availabilityDelay=h.availabilityDelay},k(b,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?(0,w.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||C}},{key:"drift",get:function(){var h=this.driftEndTime-this.driftStartTime;if(h>0){var D=this.driftEnd-this.driftStart;return D*1e3/h}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var h;return(h=this.partList)!==null&&h!==void 0&&h.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var h;return(h=this.fragments)!==null&&h!==void 0&&h.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var h;return(h=this.partList)!==null&&h!==void 0&&h.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var h;return(h=this.partList)!==null&&h!==void 0&&h.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),b}()},"./src/loader/level-key.ts":(N,O,v)=>{v.r(O),v.d(O,{LevelKey:()=>I});var w=v("./src/utils/keysystem-util.ts"),S=v("./src/utils/mediakeys-helper.ts"),k=v("./src/utils/mp4-tools.ts"),R=v("./src/utils/logger.ts"),W=v("./src/utils/numeric-encoding-utils.ts"),C={},I=function(){L.clearKeyUriToKeyIdMap=function(){C={}};function L(h,D,T,d,f){d===void 0&&(d=[1]),f===void 0&&(f=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=h,this.uri=D,this.keyFormat=T,this.keyFormatVersions=d,this.iv=f,this.encrypted=h?h!=="NONE":!1,this.isCommonEncryption=this.encrypted&&h!=="AES-128"}var A=L.prototype;return A.isSupported=function(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;switch(this.keyFormat){case"identity":return this.method==="SAMPLE-AES";case S.KeySystemFormats.FAIRPLAY:case S.KeySystemFormats.WIDEVINE:case S.KeySystemFormats.PLAYREADY:case S.KeySystemFormats.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1},A.getDecryptData=function(D){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof D!="number"&&(this.method==="AES-128"&&!this.iv&&R.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),D=0);var T=b(D),d=new L(this.method,this.uri,"identity",this.keyFormatVersions,T);return d}var f=(0,w.convertDataUriToArrayBytes)(this.uri);if(f)switch(this.keyFormat){case S.KeySystemFormats.WIDEVINE:this.pssh=f,f.length>=22&&(this.keyId=f.subarray(f.length-22,f.length-6));break;case S.KeySystemFormats.PLAYREADY:{var i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,k.mp4pssh)(i,null,f);var l=new Uint16Array(f.buffer,f.byteOffset,f.byteLength/2),p=String.fromCharCode.apply(null,Array.from(l)),m=p.substring(p.indexOf("<"),p.length),s=new DOMParser,c=s.parseFromString(m,"text/xml"),_=c.getElementsByTagName("KID")[0];if(_){var u=_.childNodes[0]?_.childNodes[0].nodeValue:_.getAttribute("VALUE");if(u){var o=(0,W.base64Decode)(u).subarray(0,16);(0,w.changeEndianness)(o),this.keyId=o}}break}default:{var n=f.subarray(0,16);if(n.length!==16){var g=new Uint8Array(16);g.set(n,16-n.length),n=g}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){var r=C[this.uri];if(!r){var E=Object.keys(C).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16);var P=new DataView(r.buffer,12,4);P.setUint32(0,E),C[this.uri]=r}this.keyId=r}return this},L}();function b(L){for(var A=new Uint8Array(16),h=12;h<16;h++)A[h]=L>>8*(15-h)&255;return A}},"./src/loader/load-stats.ts":(N,O,v)=>{v.r(O),v.d(O,{LoadStats:()=>w});var w=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>f});var w=v("./src/polyfills/number.ts"),S=v("./node_modules/url-toolkit/src/url-toolkit.js"),k=v("./src/loader/date-range.ts"),R=v("./src/loader/fragment.ts"),W=v("./src/loader/level-details.ts"),C=v("./src/loader/level-key.ts"),I=v("./src/utils/attr-list.ts"),b=v("./src/utils/logger.ts"),L=v("./src/utils/codecs.ts");function A(){return A=Object.assign?Object.assign.bind():function(u){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var g in n)Object.prototype.hasOwnProperty.call(n,g)&&(u[g]=n[g])}return u},A.apply(this,arguments)}var h=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,D=/#EXT-X-MEDIA:(.*)/g,T=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),d=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),f=function(){function u(){}return u.findGroup=function(n,g){for(var r=0;r<n.length;r++){var E=n[r];if(E.id===g)return E}},u.convertAVC1ToAVCOTI=function(n){var g=n.split(".");if(g.length>2){var r=g.shift()+".";return r+=parseInt(g.shift()).toString(16),r+=("000"+parseInt(g.shift()).toString(16)).slice(-4),r}return n},u.resolve=function(n,g){return(0,S.buildAbsoluteURL)(g,n,{alwaysNormalize:!0})},u.parseMasterPlaylist=function(n,g){var r=[],E=[],P={},y=[],U=!1;h.lastIndex=0;for(var B;(B=h.exec(n))!=null;)if(B[1]){var F,H=new I.AttrList(B[1]),G={attrs:H,bitrate:H.decimalInteger("AVERAGE-BANDWIDTH")||H.decimalInteger("BANDWIDTH"),name:H.NAME,url:u.resolve(B[2],g)},V=H.decimalResolution("RESOLUTION");V&&(G.width=V.width,G.height=V.height),l((H.CODECS||"").split(/[ ,]+/).filter(function(Y){return Y}),G),G.videoCodec&&G.videoCodec.indexOf("avc1")!==-1&&(G.videoCodec=u.convertAVC1ToAVCOTI(G.videoCodec)),(F=G.unknownCodecs)!==null&&F!==void 0&&F.length||E.push(G),r.push(G)}else if(B[3]){var z=new I.AttrList(B[3]);z["DATA-ID"]&&(U=!0,P[z["DATA-ID"]]=z)}else if(B[4]){var $=B[4],X=i($,g);X.encrypted&&X.isSupported()?y.push(X):b.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+$+'"')}var j=E.length>0&&E.length<r.length;return{levels:j?E:r,sessionData:U?P:null,sessionKeys:y.length?y:null}},u.parseMasterPlaylistMedia=function(n,g,r,E){E===void 0&&(E=[]);var P,y=[],U=0;for(D.lastIndex=0;(P=D.exec(n))!==null;){var B=new I.AttrList(P[1]);if(B.TYPE===r){var F={attrs:B,bitrate:0,id:U++,groupId:B["GROUP-ID"],instreamId:B["INSTREAM-ID"],name:B.NAME||B.LANGUAGE||"",type:r,default:B.bool("DEFAULT"),autoselect:B.bool("AUTOSELECT"),forced:B.bool("FORCED"),lang:B.LANGUAGE,url:B.URI?u.resolve(B.URI,g):""};if(E.length){var H=u.findGroup(E,F.groupId)||E[0];p(F,H,"audioCodec"),p(F,H,"textCodec")}y.push(F)}}return y},u.parseLevelPlaylist=function(n,g,r,E,P){var y=new W.LevelDetails(g),U=y.fragments,B=null,F=0,H=0,G=0,V=0,z=null,$=new R.Fragment(E,g),X,j,Y,Q=-1,J=!1;for(T.lastIndex=0,y.m3u8=n;(X=T.exec(n))!==null;){J&&(J=!1,$=new R.Fragment(E,g),$.start=G,$.sn=F,$.cc=V,$.level=r,B&&($.initSegment=B,$.rawProgramDateTime=B.rawProgramDateTime,B.rawProgramDateTime=null));var Z=X[1];if(Z){$.duration=parseFloat(Z);var ee=(" "+X[2]).slice(1);$.title=ee||null,$.tagList.push(ee?["INF",Z,ee]:["INF",Z])}else if(X[3])(0,w.isFiniteNumber)($.duration)&&($.start=G,Y&&_($,Y,y),$.sn=F,$.level=r,$.cc=V,$.urlId=P,U.push($),$.relurl=(" "+X[3]).slice(1),s($,z),z=$,G+=$.duration,F++,H=0,J=!0);else if(X[4]){var ne=(" "+X[4]).slice(1);z?$.setByteRange(ne,z):$.setByteRange(ne)}else if(X[5])$.rawProgramDateTime=(" "+X[5]).slice(1),$.tagList.push(["PROGRAM-DATE-TIME",$.rawProgramDateTime]),Q===-1&&(Q=U.length);else{if(X=X[0].match(d),!X){b.logger.warn("No matches on slow regex match for level playlist!");continue}for(j=1;j<X.length&&typeof X[j]=="undefined";j++);var te=(" "+X[j]).slice(1),q=(" "+X[j+1]).slice(1),re=X[j+2]?(" "+X[j+2]).slice(1):"";switch(te){case"PLAYLIST-TYPE":y.type=q.toUpperCase();break;case"MEDIA-SEQUENCE":F=y.startSN=parseInt(q);break;case"SKIP":{var se=new I.AttrList(q),ie=se.decimalInteger("SKIPPED-SEGMENTS");if((0,w.isFiniteNumber)(ie)){y.skippedSegments=ie;for(var ae=ie;ae--;)U.unshift(null);F+=ie}var oe=se.enumeratedString("RECENTLY-REMOVED-DATERANGES");oe&&(y.recentlyRemovedDateranges=oe.split("	"));break}case"TARGETDURATION":y.targetduration=parseFloat(q);break;case"VERSION":y.version=parseInt(q);break;case"EXTM3U":break;case"ENDLIST":y.live=!1;break;case"#":(q||re)&&$.tagList.push(re?[q,re]:[q]);break;case"DISCONTINUITY":V++,$.tagList.push(["DIS"]);break;case"GAP":$.tagList.push([te]);break;case"BITRATE":$.tagList.push([te,q]);break;case"DATERANGE":{var le=new I.AttrList(q),ue=new k.DateRange(le,y.dateRanges[le.ID]);ue.isValid||y.skippedSegments?y.dateRanges[ue.id]=ue:b.logger.warn('Ignoring invalid DATERANGE tag: "'+q+'"'),$.tagList.push(["EXT-X-DATERANGE",q]);break}case"DISCONTINUITY-SEQUENCE":V=parseInt(q);break;case"KEY":{var fe=i(q,g);if(fe.isSupported()){if(fe.method==="NONE"){Y=void 0;break}Y||(Y={}),Y[fe.keyFormat]&&(Y=A({},Y)),Y[fe.keyFormat]=fe}else b.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+q+'"');break}case"START":{var de=new I.AttrList(q),ve=de.decimalFloatingPoint("TIME-OFFSET");(0,w.isFiniteNumber)(ve)&&(y.startTimeOffset=ve);break}case"MAP":{var Le=new I.AttrList(q);if($.duration){var Ae=new R.Fragment(E,g);c(Ae,Le,r,Y),B=Ae,$.initSegment=B,B.rawProgramDateTime&&!$.rawProgramDateTime&&($.rawProgramDateTime=B.rawProgramDateTime)}else c($,Le,r,Y),B=$,J=!0;break}case"SERVER-CONTROL":{var De=new I.AttrList(q);y.canBlockReload=De.bool("CAN-BLOCK-RELOAD"),y.canSkipUntil=De.optionalFloat("CAN-SKIP-UNTIL",0),y.canSkipDateRanges=y.canSkipUntil>0&&De.bool("CAN-SKIP-DATERANGES"),y.partHoldBack=De.optionalFloat("PART-HOLD-BACK",0),y.holdBack=De.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Ye=new I.AttrList(q);y.partTarget=Ye.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Ee=y.partList;Ee||(Ee=y.partList=[]);var be=H>0?Ee[Ee.length-1]:void 0,He=H++,Xe=new R.Part(new I.AttrList(q),$,g,He,be);Ee.push(Xe),$.duration+=Xe.duration;break}case"PRELOAD-HINT":{var Qe=new I.AttrList(q);y.preloadHint=Qe;break}case"RENDITION-REPORT":{var Ne=new I.AttrList(q);y.renditionReports=y.renditionReports||[],y.renditionReports.push(Ne);break}default:b.logger.warn("line parsed but not handled: "+X);break}}}z&&!z.relurl?(U.pop(),G-=z.duration,y.partList&&(y.fragmentHint=z)):y.partList&&(s($,z),$.cc=V,y.fragmentHint=$,Y&&_($,Y,y));var we=U.length,Je=U[0],rt=U[we-1];if(G+=y.skippedSegments*y.targetduration,G>0&&we&&rt){y.averagetargetduration=G/we;var Ce=rt.sn;y.endSN=Ce!=="initSegment"?Ce:0,y.live||(rt.endList=!0),Je&&(y.startCC=Je.cc)}else y.endSN=0,y.startCC=0;return y.fragmentHint&&(G+=y.fragmentHint.duration),y.totalduration=G,y.endCC=V,Q>0&&m(U,Q),y},u}();function i(u,o){var n,g,r=new I.AttrList(u),E=(n=r.enumeratedString("METHOD"))!=null?n:"",P=r.URI,y=r.hexadecimalInteger("IV"),U=r.enumeratedString("KEYFORMATVERSIONS"),B=(g=r.enumeratedString("KEYFORMAT"))!=null?g:"identity";P&&r.IV&&!y&&b.logger.error("Invalid IV: "+r.IV);var F=P?f.resolve(P,o):"",H=(U||"1").split("/").map(Number).filter(Number.isFinite);return new C.LevelKey(E,F,B,H,y)}function l(u,o){["video","audio","text"].forEach(function(n){var g=u.filter(function(E){return(0,L.isCodecType)(E,n)});if(g.length){var r=g.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});o[n+"Codec"]=r.length>0?r[0]:g[0],u=u.filter(function(E){return g.indexOf(E)===-1})}}),o.unknownCodecs=u}function p(u,o,n){var g=o[n];g&&(u[n]=g)}function m(u,o){for(var n=u[o],g=o;g--;){var r=u[g];if(!r)return;r.programDateTime=n.programDateTime-r.duration*1e3,n=r}}function s(u,o){u.rawProgramDateTime?u.programDateTime=Date.parse(u.rawProgramDateTime):o!=null&&o.programDateTime&&(u.programDateTime=o.endProgramDateTime),(0,w.isFiniteNumber)(u.programDateTime)||(u.programDateTime=null,u.rawProgramDateTime=null)}function c(u,o,n,g){u.relurl=o.URI,o.BYTERANGE&&u.setByteRange(o.BYTERANGE),u.level=n,u.sn="initSegment",g&&(u.levelkeys=g),u.initSegment=null}function _(u,o,n){u.levelkeys=o;var g=n.encryptedFragments;(!g.length||g[g.length-1].levelkeys!==o)&&Object.keys(o).some(function(r){return o[r].isCommonEncryption})&&g.push(u)}},"./src/loader/playlist-loader.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>h});var w=v("./src/polyfills/number.ts"),S=v("./src/events.ts"),k=v("./src/errors.ts"),R=v("./src/utils/logger.ts"),W=v("./src/loader/m3u8-parser.ts"),C=v("./src/types/loader.ts"),I=v("./src/utils/attr-list.ts");function b(D){var T=D.type;switch(T){case C.PlaylistContextType.AUDIO_TRACK:return C.PlaylistLevelType.AUDIO;case C.PlaylistContextType.SUBTITLE_TRACK:return C.PlaylistLevelType.SUBTITLE;default:return C.PlaylistLevelType.MAIN}}function L(D,T){var d=D.url;return(d===void 0||d.indexOf("data:")===0)&&(d=T.url),d}var A=function(){function D(d){this.hls=void 0,this.loaders=Object.create(null),this.hls=d,this.registerListeners()}var T=D.prototype;return T.startLoad=function(f){},T.stopLoad=function(){this.destroyInternalLoaders()},T.registerListeners=function(){var f=this.hls;f.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),f.on(S.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),f.on(S.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},T.unregisterListeners=function(){var f=this.hls;f.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),f.off(S.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),f.off(S.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},T.createInternalLoader=function(f){var i=this.hls.config,l=i.pLoader,p=i.loader,m=l||p,s=new m(i);return f.loader=s,this.loaders[f.type]=s,s},T.getInternalLoader=function(f){return this.loaders[f.type]},T.resetInternalLoader=function(f){this.loaders[f]&&delete this.loaders[f]},T.destroyInternalLoaders=function(){for(var f in this.loaders){var i=this.loaders[f];i&&i.destroy(),this.resetInternalLoader(f)}},T.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},T.onManifestLoading=function(f,i){var l=i.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:C.PlaylistContextType.MANIFEST,url:l,deliveryDirectives:null})},T.onLevelLoading=function(f,i){var l=i.id,p=i.level,m=i.url,s=i.deliveryDirectives;this.load({id:l,groupId:null,level:p,responseType:"text",type:C.PlaylistContextType.LEVEL,url:m,deliveryDirectives:s})},T.onAudioTrackLoading=function(f,i){var l=i.id,p=i.groupId,m=i.url,s=i.deliveryDirectives;this.load({id:l,groupId:p,level:null,responseType:"text",type:C.PlaylistContextType.AUDIO_TRACK,url:m,deliveryDirectives:s})},T.onSubtitleTrackLoading=function(f,i){var l=i.id,p=i.groupId,m=i.url,s=i.deliveryDirectives;this.load({id:l,groupId:p,level:null,responseType:"text",type:C.PlaylistContextType.SUBTITLE_TRACK,url:m,deliveryDirectives:s})},T.load=function(f){var i,l=this.hls.config,p=this.getInternalLoader(f);if(p){var m=p.context;if(m&&m.url===f.url){R.logger.trace("[playlist-loader]: playlist request ongoing");return}R.logger.log("[playlist-loader]: aborting previous loader for type: "+f.type),p.abort()}var s,c,_,u;switch(f.type){case C.PlaylistContextType.MANIFEST:s=l.manifestLoadingMaxRetry,c=l.manifestLoadingTimeOut,_=l.manifestLoadingRetryDelay,u=l.manifestLoadingMaxRetryTimeout;break;case C.PlaylistContextType.LEVEL:case C.PlaylistContextType.AUDIO_TRACK:case C.PlaylistContextType.SUBTITLE_TRACK:s=0,c=l.levelLoadingTimeOut;break;default:s=l.levelLoadingMaxRetry,c=l.levelLoadingTimeOut,_=l.levelLoadingRetryDelay,u=l.levelLoadingMaxRetryTimeout;break}if(p=this.createInternalLoader(f),(i=f.deliveryDirectives)!==null&&i!==void 0&&i.part){var o;if(f.type===C.PlaylistContextType.LEVEL&&f.level!==null?o=this.hls.levels[f.level].details:f.type===C.PlaylistContextType.AUDIO_TRACK&&f.id!==null?o=this.hls.audioTracks[f.id].details:f.type===C.PlaylistContextType.SUBTITLE_TRACK&&f.id!==null&&(o=this.hls.subtitleTracks[f.id].details),o){var n=o.partTarget,g=o.targetduration;n&&g&&(c=Math.min(Math.max(n*3,g*.8)*1e3,c))}}var r={timeout:c,maxRetry:s,retryDelay:_,maxRetryDelay:u,highWaterMark:0},E={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};p.load(f,r,E)},T.loadsuccess=function(f,i,l,p){p===void 0&&(p=null),this.resetInternalLoader(l.type);var m=f.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(f,l,"no EXTM3U delimiter",p);return}i.parsing.start=performance.now(),m.indexOf("#EXTINF:")>0||m.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(f,i,l,p):this.handleMasterPlaylist(f,i,l,p)},T.loaderror=function(f,i,l){l===void 0&&(l=null),this.handleNetworkError(i,l,!1,f)},T.loadtimeout=function(f,i,l){l===void 0&&(l=null),this.handleNetworkError(i,l,!0)},T.handleMasterPlaylist=function(f,i,l,p){var m=this.hls,s=f.data,c=L(f,l),_=W.default.parseMasterPlaylist(s,c),u=_.levels,o=_.sessionData,n=_.sessionKeys;if(!u.length){this.handleManifestParsingError(f,l,"no level found in manifest",p);return}var g=u.map(function(B){return{id:B.attrs.AUDIO,audioCodec:B.audioCodec}}),r=u.map(function(B){return{id:B.attrs.SUBTITLES,textCodec:B.textCodec}}),E=W.default.parseMasterPlaylistMedia(s,c,"AUDIO",g),P=W.default.parseMasterPlaylistMedia(s,c,"SUBTITLES",r),y=W.default.parseMasterPlaylistMedia(s,c,"CLOSED-CAPTIONS");if(E.length){var U=E.some(function(B){return!B.url});!U&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(R.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new I.AttrList({}),bitrate:0,url:""}))}m.trigger(S.Events.MANIFEST_LOADED,{levels:u,audioTracks:E,subtitles:P,captions:y,url:c,stats:i,networkDetails:p,sessionData:o,sessionKeys:n})},T.handleTrackOrLevelPlaylist=function(f,i,l,p){var m=this.hls,s=l.id,c=l.level,_=l.type,u=L(f,l),o=(0,w.isFiniteNumber)(s)?s:0,n=(0,w.isFiniteNumber)(c)?c:o,g=b(l),r=W.default.parseLevelPlaylist(f.data,u,n,g,o);if(!r.fragments.length){m.trigger(S.Events.ERROR,{type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:u,reason:"no fragments found in level",level:typeof l.level=="number"?l.level:void 0});return}if(_===C.PlaylistContextType.MANIFEST){var E={attrs:new I.AttrList({}),bitrate:0,details:r,name:"",url:u};m.trigger(S.Events.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:u,stats:i,networkDetails:p,sessionData:null,sessionKeys:null})}i.parsing.end=performance.now(),l.levelDetails=r,this.handlePlaylistLoaded(f,i,l,p)},T.handleManifestParsingError=function(f,i,l,p){this.hls.trigger(S.Events.ERROR,{type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:i.type===C.PlaylistContextType.MANIFEST,url:f.url,reason:l,response:f,context:i,networkDetails:p})},T.handleNetworkError=function(f,i,l,p){l===void 0&&(l=!1),R.logger.warn("[playlist-loader]: A network "+(l?"timeout":"error")+" occurred while loading "+f.type+" level: "+f.level+" id: "+f.id+' group-id: "'+f.groupId+'"');var m=k.ErrorDetails.UNKNOWN,s=!1,c=this.getInternalLoader(f);switch(f.type){case C.PlaylistContextType.MANIFEST:m=l?k.ErrorDetails.MANIFEST_LOAD_TIMEOUT:k.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case C.PlaylistContextType.LEVEL:m=l?k.ErrorDetails.LEVEL_LOAD_TIMEOUT:k.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case C.PlaylistContextType.AUDIO_TRACK:m=l?k.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:k.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;case C.PlaylistContextType.SUBTITLE_TRACK:m=l?k.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:k.ErrorDetails.SUBTITLE_LOAD_ERROR,s=!1;break}c&&this.resetInternalLoader(f.type);var _={type:k.ErrorTypes.NETWORK_ERROR,details:m,fatal:s,url:f.url,loader:c,context:f,networkDetails:i};p&&(_.response=p),this.hls.trigger(S.Events.ERROR,_)},T.handlePlaylistLoaded=function(f,i,l,p){var m=l.type,s=l.level,c=l.id,_=l.groupId,u=l.loader,o=l.levelDetails,n=l.deliveryDirectives;if(!(o!=null&&o.targetduration)){this.handleManifestParsingError(f,l,"invalid target duration",p);return}if(!!u)switch(o.live&&(u.getCacheAge&&(o.ageHeader=u.getCacheAge()||0),(!u.getCacheAge||isNaN(o.ageHeader))&&(o.ageHeader=0)),m){case C.PlaylistContextType.MANIFEST:case C.PlaylistContextType.LEVEL:this.hls.trigger(S.Events.LEVEL_LOADED,{details:o,level:s||0,id:c||0,stats:i,networkDetails:p,deliveryDirectives:n});break;case C.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(S.Events.AUDIO_TRACK_LOADED,{details:o,id:c||0,groupId:_||"",stats:i,networkDetails:p,deliveryDirectives:n});break;case C.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(S.Events.SUBTITLE_TRACK_LOADED,{details:o,id:c||0,groupId:_||"",stats:i,networkDetails:p,deliveryDirectives:n});break}},D}();const h=A},"./src/polyfills/number.ts":(N,O,v)=>{v.r(O),v.d(O,{MAX_SAFE_INTEGER:()=>S,isFiniteNumber:()=>w});var w=Number.isFinite||function(k){return typeof k=="number"&&isFinite(k)},S=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>S});var w=function(){function k(){}return k.getSilentFrame=function(W,C){switch(W){case"mp4a.40.2":if(C===1)return new Uint8Array([0,200,0,128,35,128]);if(C===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(C===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(C===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(C===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(C===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(C===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(C===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(C===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},k}();const S=w},"./src/remux/mp4-generator.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>k});var w=Math.pow(2,32)-1,S=function(){function R(){}return R.init=function(){R.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var C;for(C in R.types)R.types.hasOwnProperty(C)&&(R.types[C]=[C.charCodeAt(0),C.charCodeAt(1),C.charCodeAt(2),C.charCodeAt(3)]);var I=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),b=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);R.HDLR_TYPES={video:I,audio:b};var L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),A=new Uint8Array([0,0,0,0,0,0,0,0]);R.STTS=R.STSC=R.STCO=A,R.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),R.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),R.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),R.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var h=new Uint8Array([105,115,111,109]),D=new Uint8Array([97,118,99,49]),T=new Uint8Array([0,0,0,1]);R.FTYP=R.box(R.types.ftyp,h,T,h,D),R.DINF=R.box(R.types.dinf,R.box(R.types.dref,L))},R.box=function(C){for(var I=8,b=arguments.length,L=new Array(b>1?b-1:0),A=1;A<b;A++)L[A-1]=arguments[A];for(var h=L.length,D=h;h--;)I+=L[h].byteLength;var T=new Uint8Array(I);for(T[0]=I>>24&255,T[1]=I>>16&255,T[2]=I>>8&255,T[3]=I&255,T.set(C,4),h=0,I=8;h<D;h++)T.set(L[h],I),I+=L[h].byteLength;return T},R.hdlr=function(C){return R.box(R.types.hdlr,R.HDLR_TYPES[C])},R.mdat=function(C){return R.box(R.types.mdat,C)},R.mdhd=function(C,I){I*=C;var b=Math.floor(I/(w+1)),L=Math.floor(I%(w+1));return R.box(R.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,C>>24&255,C>>16&255,C>>8&255,C&255,b>>24,b>>16&255,b>>8&255,b&255,L>>24,L>>16&255,L>>8&255,L&255,85,196,0,0]))},R.mdia=function(C){return R.box(R.types.mdia,R.mdhd(C.timescale,C.duration),R.hdlr(C.type),R.minf(C))},R.mfhd=function(C){return R.box(R.types.mfhd,new Uint8Array([0,0,0,0,C>>24,C>>16&255,C>>8&255,C&255]))},R.minf=function(C){return C.type==="audio"?R.box(R.types.minf,R.box(R.types.smhd,R.SMHD),R.DINF,R.stbl(C)):R.box(R.types.minf,R.box(R.types.vmhd,R.VMHD),R.DINF,R.stbl(C))},R.moof=function(C,I,b){return R.box(R.types.moof,R.mfhd(C),R.traf(b,I))},R.moov=function(C){for(var I=C.length,b=[];I--;)b[I]=R.trak(C[I]);return R.box.apply(null,[R.types.moov,R.mvhd(C[0].timescale,C[0].duration)].concat(b).concat(R.mvex(C)))},R.mvex=function(C){for(var I=C.length,b=[];I--;)b[I]=R.trex(C[I]);return R.box.apply(null,[R.types.mvex].concat(b))},R.mvhd=function(C,I){I*=C;var b=Math.floor(I/(w+1)),L=Math.floor(I%(w+1)),A=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,C>>24&255,C>>16&255,C>>8&255,C&255,b>>24,b>>16&255,b>>8&255,b&255,L>>24,L>>16&255,L>>8&255,L&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return R.box(R.types.mvhd,A)},R.sdtp=function(C){var I=C.samples||[],b=new Uint8Array(4+I.length),L,A;for(L=0;L<I.length;L++)A=I[L].flags,b[L+4]=A.dependsOn<<4|A.isDependedOn<<2|A.hasRedundancy;return R.box(R.types.sdtp,b)},R.stbl=function(C){return R.box(R.types.stbl,R.stsd(C),R.box(R.types.stts,R.STTS),R.box(R.types.stsc,R.STSC),R.box(R.types.stsz,R.STSZ),R.box(R.types.stco,R.STCO))},R.avc1=function(C){var I=[],b=[],L,A,h;for(L=0;L<C.sps.length;L++)A=C.sps[L],h=A.byteLength,I.push(h>>>8&255),I.push(h&255),I=I.concat(Array.prototype.slice.call(A));for(L=0;L<C.pps.length;L++)A=C.pps[L],h=A.byteLength,b.push(h>>>8&255),b.push(h&255),b=b.concat(Array.prototype.slice.call(A));var D=R.box(R.types.avcC,new Uint8Array([1,I[3],I[4],I[5],255,224|C.sps.length].concat(I).concat([C.pps.length]).concat(b))),T=C.width,d=C.height,f=C.pixelRatio[0],i=C.pixelRatio[1];return R.box(R.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,T>>8&255,T&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),D,R.box(R.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),R.box(R.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,i>>24,i>>16&255,i>>8&255,i&255])))},R.esds=function(C){var I=C.config.length;return new Uint8Array([0,0,0,0,3,23+I,0,1,0,4,15+I,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([I]).concat(C.config).concat([6,1,2]))},R.mp4a=function(C){var I=C.samplerate;return R.box(R.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,C.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]),R.box(R.types.esds,R.esds(C)))},R.mp3=function(C){var I=C.samplerate;return R.box(R.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,C.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]))},R.stsd=function(C){return C.type==="audio"?C.segmentCodec==="mp3"&&C.codec==="mp3"?R.box(R.types.stsd,R.STSD,R.mp3(C)):R.box(R.types.stsd,R.STSD,R.mp4a(C)):R.box(R.types.stsd,R.STSD,R.avc1(C))},R.tkhd=function(C){var I=C.id,b=C.duration*C.timescale,L=C.width,A=C.height,h=Math.floor(b/(w+1)),D=Math.floor(b%(w+1));return R.box(R.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,I>>24&255,I>>16&255,I>>8&255,I&255,0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255,D>>24,D>>16&255,D>>8&255,D&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,L>>8&255,L&255,0,0,A>>8&255,A&255,0,0]))},R.traf=function(C,I){var b=R.sdtp(C),L=C.id,A=Math.floor(I/(w+1)),h=Math.floor(I%(w+1));return R.box(R.types.traf,R.box(R.types.tfhd,new Uint8Array([0,0,0,0,L>>24,L>>16&255,L>>8&255,L&255])),R.box(R.types.tfdt,new Uint8Array([1,0,0,0,A>>24,A>>16&255,A>>8&255,A&255,h>>24,h>>16&255,h>>8&255,h&255])),R.trun(C,b.length+16+20+8+16+8+8),b)},R.trak=function(C){return C.duration=C.duration||4294967295,R.box(R.types.trak,R.tkhd(C),R.mdia(C))},R.trex=function(C){var I=C.id;return R.box(R.types.trex,new Uint8Array([0,0,0,0,I>>24,I>>16&255,I>>8&255,I&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},R.trun=function(C,I){var b=C.samples||[],L=b.length,A=12+16*L,h=new Uint8Array(A),D,T,d,f,i,l;for(I+=8+A,h.set([C.type==="video"?1:0,0,15,1,L>>>24&255,L>>>16&255,L>>>8&255,L&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255],0),D=0;D<L;D++)T=b[D],d=T.duration,f=T.size,i=T.flags,l=T.cts,h.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.paddingValue<<1|i.isNonSync,i.degradPrio&240<<8,i.degradPrio&15,l>>>24&255,l>>>16&255,l>>>8&255,l&255],12+16*D);return R.box(R.types.trun,h)},R.initSegment=function(C){R.types||R.init();var I=R.moov(C),b=new Uint8Array(R.FTYP.byteLength+I.byteLength);return b.set(R.FTYP),b.set(I,R.FTYP.byteLength),b},R}();S.types=void 0,S.HDLR_TYPES=void 0,S.STTS=void 0,S.STSC=void 0,S.STCO=void 0,S.STSZ=void 0,S.VMHD=void 0,S.SMHD=void 0,S.STSD=void 0,S.FTYP=void 0,S.DINF=void 0;const k=S},"./src/remux/mp4-remuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>f,flushTextTrackMetadataCueSamples:()=>p,flushTextTrackUserdataCueSamples:()=>m,normalizePts:()=>i});var w=v("./src/polyfills/number.ts"),S=v("./src/remux/aac-helper.ts"),k=v("./src/remux/mp4-generator.ts"),R=v("./src/events.ts"),W=v("./src/errors.ts"),C=v("./src/utils/logger.ts"),I=v("./src/types/loader.ts"),b=v("./src/utils/timescale-conversion.ts");function L(){return L=Object.assign?Object.assign.bind():function(_){for(var u=1;u<arguments.length;u++){var o=arguments[u];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(_[n]=o[n])}return _},L.apply(this,arguments)}var A=10*1e3,h=1024,D=1152,T=null,d=null,f=function(){function _(o,n,g,r){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=o,this.config=n,this.typeSupported=g,this.ISGenerated=!1,T===null){var E=navigator.userAgent||"",P=E.match(/Chrome\/(\d+)/i);T=P?parseInt(P[1]):0}if(d===null){var y=navigator.userAgent.match(/Safari\/(\d+)/i);d=y?parseInt(y[1]):0}}var u=_.prototype;return u.destroy=function(){},u.resetTimeStamp=function(n){C.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=n},u.resetNextTimestamp=function(){C.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},u.resetInitSegment=function(){C.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},u.getVideoStartPts=function(n){var g=!1,r=n.reduce(function(E,P){var y=P.pts-E;return y<-4294967296?(g=!0,i(E,P.pts)):y>0?E:P.pts},n[0].pts);return g&&C.logger.debug("PTS rollover detected"),r},u.remux=function(n,g,r,E,P,y,U,B){var F,H,G,V,z,$,X=P,j=P,Y=n.pid>-1,Q=g.pid>-1,J=g.samples.length,Z=n.samples.length>0,ee=U&&J>0||J>1,ne=(!Y||Z)&&(!Q||ee)||this.ISGenerated||U;if(ne){this.ISGenerated||(G=this.generateIS(n,g,P));var te=this.isVideoContiguous,q=-1,re;if(ee&&(q=l(g.samples),!te&&this.config.forceKeyFrameOnDiscontinuity))if($=!0,q>0){C.logger.warn("[mp4-remuxer]: Dropped "+q+" out of "+J+" video samples due to a missing keyframe");var se=this.getVideoStartPts(g.samples);g.samples=g.samples.slice(q),g.dropped+=q,j+=(g.samples[0].pts-se)/g.inputTimeScale,re=j}else q===-1&&(C.logger.warn("[mp4-remuxer]: No keyframe found out of "+J+" video samples"),$=!1);if(this.ISGenerated){if(Z&&ee){var ie=this.getVideoStartPts(g.samples),ae=i(n.samples[0].pts,ie)-ie,oe=ae/g.inputTimeScale;X+=Math.max(0,oe),j+=Math.max(0,-oe)}if(Z){if(n.samplerate||(C.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),G=this.generateIS(n,g,P)),H=this.remuxAudio(n,X,this.isAudioContiguous,y,Q||ee||B===I.PlaylistLevelType.AUDIO?j:void 0),ee){var le=H?H.endPTS-H.startPTS:0;g.inputTimeScale||(C.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),G=this.generateIS(n,g,P)),F=this.remuxVideo(g,j,te,le)}}else ee&&(F=this.remuxVideo(g,j,te,0));F&&(F.firstKeyFrame=q,F.independent=q!==-1,F.firstKeyFramePTS=re)}}return this.ISGenerated&&(r.samples.length&&(z=p(r,P,this._initPTS,this._initDTS)),E.samples.length&&(V=m(E,P,this._initPTS))),{audio:H,video:F,initSegment:G,independent:$,text:V,id3:z}},u.generateIS=function(n,g,r){var E=n.samples,P=g.samples,y=this.typeSupported,U={},B=!(0,w.isFiniteNumber)(this._initPTS),F="audio/mp4",H,G,V;if(B&&(H=G=1/0),n.config&&E.length){switch(n.timescale=n.samplerate,n.segmentCodec){case"mp3":y.mpeg?(F="audio/mpeg",n.codec=""):y.mp3&&(n.codec="mp3");break}U.audio={id:"audio",container:F,codec:n.codec,initSegment:n.segmentCodec==="mp3"&&y.mpeg?new Uint8Array(0):k.default.initSegment([n]),metadata:{channelCount:n.channelCount}},B&&(V=n.inputTimeScale,H=G=E[0].pts-Math.round(V*r))}if(g.sps&&g.pps&&P.length&&(g.timescale=g.inputTimeScale,U.video={id:"main",container:"video/mp4",codec:g.codec,initSegment:k.default.initSegment([g]),metadata:{width:g.width,height:g.height}},B)){V=g.inputTimeScale;var z=this.getVideoStartPts(P),$=Math.round(V*r);G=Math.min(G,i(P[0].dts,z)-$),H=Math.min(H,z-$)}if(Object.keys(U).length)return this.ISGenerated=!0,B&&(this._initPTS=H,this._initDTS=G),{tracks:U,initPTS:H,timescale:V}},u.remuxVideo=function(n,g,r,E){var P=n.inputTimeScale,y=n.samples,U=[],B=y.length,F=this._initPTS,H=this.nextAvcDts,G=8,V=this.videoSampleDuration,z,$,X=Number.POSITIVE_INFINITY,j=Number.NEGATIVE_INFINITY,Y=!1;if(!r||H===null){var Q=g*P,J=y[0].pts-i(y[0].dts,y[0].pts);H=Q-J}for(var Z=0;Z<B;Z++){var ee=y[Z];ee.pts=i(ee.pts-F,H),ee.dts=i(ee.dts-F,H),ee.dts<y[Z>0?Z-1:Z].dts&&(Y=!0)}Y&&y.sort(function(Mn,zi){var Qo=Mn.dts-zi.dts,Jo=Mn.pts-zi.pts;return Qo||Jo}),z=y[0].dts,$=y[y.length-1].dts;var ne=$-z,te=ne?Math.round(ne/(B-1)):V||n.inputTimeScale/30;if(r){var q=z-H,re=q>te,se=q<-1;if((re||se)&&(re?C.logger.warn("AVC: "+(0,b.toMsFromMpegTsClock)(q,!0)+" ms ("+q+"dts) hole between fragments detected, filling it"):C.logger.warn("AVC: "+(0,b.toMsFromMpegTsClock)(-q,!0)+" ms ("+q+"dts) overlapping between fragments detected"),!se||H>y[0].pts)){z=H;var ie=y[0].pts-q;y[0].dts=z,y[0].pts=ie,C.logger.log("Video: First PTS/DTS adjusted: "+(0,b.toMsFromMpegTsClock)(ie,!0)+"/"+(0,b.toMsFromMpegTsClock)(z,!0)+", delta: "+(0,b.toMsFromMpegTsClock)(q,!0)+" ms")}}z=Math.max(0,z);for(var ae=0,oe=0,le=0;le<B;le++){for(var ue=y[le],fe=ue.units,de=fe.length,ve=0,Le=0;Le<de;Le++)ve+=fe[Le].data.length;oe+=ve,ae+=de,ue.length=ve,ue.dts=Math.max(ue.dts,z),X=Math.min(ue.pts,X),j=Math.max(ue.pts,j)}$=y[B-1].dts;var Ae=oe+4*ae+8,De;try{De=new Uint8Array(Ae)}catch{this.observer.emit(R.Events.ERROR,R.Events.ERROR,{type:W.ErrorTypes.MUX_ERROR,details:W.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ae,reason:"fail allocating video mdat "+Ae});return}var Ye=new DataView(De.buffer);Ye.setUint32(0,Ae),De.set(k.default.types.mdat,4);for(var Ee=!1,be=Number.POSITIVE_INFINITY,He=Number.POSITIVE_INFINITY,Xe=Number.NEGATIVE_INFINITY,Qe=Number.NEGATIVE_INFINITY,Ne=0;Ne<B;Ne++){for(var we=y[Ne],Je=we.units,rt=0,Ce=0,ct=Je.length;Ce<ct;Ce++){var nt=Je[Ce],Gr=nt.data,Ut=nt.data.byteLength;Ye.setUint32(G,Ut),G+=4,De.set(Gr,G),G+=Ut,rt+=4+Ut}var Zt=void 0;if(Ne<B-1)V=y[Ne+1].dts-we.dts,Zt=y[Ne+1].pts-we.pts;else{var Gi=this.config,jr=Ne>0?we.dts-y[Ne-1].dts:te;if(Zt=Ne>0?we.pts-y[Ne-1].pts:te,Gi.stretchShortVideoTrack&&this.nextAudioPts!==null){var Go=Math.floor(Gi.maxBufferHole*P),Cn=(E?X+E*P:this.nextAudioPts)-we.pts;Cn>Go?(V=Cn-jr,V<0?V=jr:Ee=!0,C.logger.log("[mp4-remuxer]: It is approximately "+Cn/90+" ms to the next segment; using duration "+V/90+" ms for the last video frame.")):V=jr}else V=jr}var jo=Math.round(we.pts-we.dts);be=Math.min(be,V),Xe=Math.max(Xe,V),He=Math.min(He,Zt),Qe=Math.max(Qe,Zt),U.push(new s(we.key,V,rt,jo))}if(U.length){if(T){if(T<70){var ji=U[0].flags;ji.dependsOn=2,ji.isNonSync=0}}else if(d&&Qe-He<Xe-be&&te/Xe<.025&&U[0].cts===0){C.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var On=z,it=0,Vi=U.length;it<Vi;it++){var Yi=On+U[it].duration,Vo=On+U[it].cts;if(it<Vi-1){var Yo=Yi+U[it+1].cts;U[it].duration=Yo-Vo}else U[it].duration=it?U[it-1].duration:te;U[it].cts=0,On=Yi}}}console.assert(V!==null,"mp4SampleDuration must be computed"),V=Ee||!V?te:V,this.nextAvcDts=H=$+V,this.videoSampleDuration=V,this.isVideoContiguous=!0;var zo=k.default.moof(n.sequenceNumber++,z,L({},n,{samples:U})),$o="video",Xo={data1:zo,data2:De,startPTS:X/P,endPTS:(j+V)/P,startDTS:z/P,endDTS:H/P,type:$o,hasAudio:!1,hasVideo:!0,nb:U.length,dropped:n.dropped};return n.samples=[],n.dropped=0,console.assert(De.length,"MDAT length must not be zero"),Xo},u.remuxAudio=function(n,g,r,E,P){var y=n.inputTimeScale,U=n.samplerate?n.samplerate:y,B=y/U,F=n.segmentCodec==="aac"?h:D,H=F*B,G=this._initPTS,V=n.segmentCodec==="mp3"&&this.typeSupported.mpeg,z=[],$=P!==void 0,X=n.samples,j=V?0:8,Y=this.nextAudioPts||-1,Q=g*y;if(this.isAudioContiguous=r=r||X.length&&Y>0&&(E&&Math.abs(Q-Y)<9e3||Math.abs(i(X[0].pts-G,Q)-Y)<20*H),X.forEach(function(nt){nt.pts=i(nt.pts-G,Q)}),!r||Y<0){if(X=X.filter(function(nt){return nt.pts>=0}),!X.length)return;P===0?Y=0:E&&!$?Y=Math.max(0,Q):Y=X[0].pts}if(n.segmentCodec==="aac")for(var J=this.config.maxAudioFramesDrift,Z=0,ee=Y;Z<X.length;Z++){var ne=X[Z],te=ne.pts,q=te-ee,re=Math.abs(1e3*q/y);if(q<=-J*H&&$)Z===0&&(C.logger.warn("Audio frame @ "+(te/y).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*q/y)+" ms."),this.nextAudioPts=Y=ee=te);else if(q>=J*H&&re<A&&$){var se=Math.round(q/H);ee=te-se*H,ee<0&&(se--,ee+=H),Z===0&&(this.nextAudioPts=Y=ee),C.logger.warn("[mp4-remuxer]: Injecting "+se+" audio frame @ "+(ee/y).toFixed(3)+"s due to "+Math.round(1e3*q/y)+" ms gap.");for(var ie=0;ie<se;ie++){var ae=Math.max(ee,0),oe=S.default.getSilentFrame(n.manifestCodec||n.codec,n.channelCount);oe||(C.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=ne.unit.subarray()),X.splice(Z,0,{unit:oe,pts:ae}),ee+=H,Z++}}ne.pts=ee,ee+=H}for(var le=null,ue=null,fe,de=0,ve=X.length;ve--;)de+=X[ve].unit.byteLength;for(var Le=0,Ae=X.length;Le<Ae;Le++){var De=X[Le],Ye=De.unit,Ee=De.pts;if(ue!==null){var be=z[Le-1];be.duration=Math.round((Ee-ue)/B)}else if(r&&n.segmentCodec==="aac"&&(Ee=Y),le=Ee,de>0){de+=j;try{fe=new Uint8Array(de)}catch{this.observer.emit(R.Events.ERROR,R.Events.ERROR,{type:W.ErrorTypes.MUX_ERROR,details:W.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:de,reason:"fail allocating audio mdat "+de});return}if(!V){var He=new DataView(fe.buffer);He.setUint32(0,de),fe.set(k.default.types.mdat,4)}}else return;fe.set(Ye,j);var Xe=Ye.byteLength;j+=Xe,z.push(new s(!0,F,Xe,0)),ue=Ee}var Qe=z.length;if(!!Qe){var Ne=z[z.length-1];this.nextAudioPts=Y=ue+B*Ne.duration;var we=V?new Uint8Array(0):k.default.moof(n.sequenceNumber++,le/B,L({},n,{samples:z}));n.samples=[];var Je=le/y,rt=Y/y,Ce="audio",ct={data1:we,data2:fe,startPTS:Je,endPTS:rt,startDTS:Je,endDTS:rt,type:Ce,hasAudio:!0,hasVideo:!1,nb:Qe};return this.isAudioContiguous=!0,console.assert(fe.length,"MDAT length must not be zero"),ct}},u.remuxEmptyAudio=function(n,g,r,E){var P=n.inputTimeScale,y=n.samplerate?n.samplerate:P,U=P/y,B=this.nextAudioPts,F=(B!==null?B:E.startDTS*P)+this._initDTS,H=E.endDTS*P+this._initDTS,G=U*h,V=Math.ceil((H-F)/G),z=S.default.getSilentFrame(n.manifestCodec||n.codec,n.channelCount);if(C.logger.warn("[mp4-remuxer]: remux empty Audio"),!z){C.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var $=[],X=0;X<V;X++){var j=F+X*G;$.push({unit:z,pts:j,dts:j})}return n.samples=$,this.remuxAudio(n,g,r,!1)},_}();function i(_,u){var o;if(u===null)return _;for(u<_?o=-8589934592:o=8589934592;Math.abs(_-u)>4294967296;)_+=o;return _}function l(_){for(var u=0;u<_.length;u++)if(_[u].key)return u;return-1}function p(_,u,o,n){var g=_.samples.length;if(!!g){for(var r=_.inputTimeScale,E=0;E<g;E++){var P=_.samples[E];P.pts=i(P.pts-o,u*r)/r,P.dts=i(P.dts-n,u*r)/r}var y=_.samples;return _.samples=[],{samples:y}}}function m(_,u,o){var n=_.samples.length;if(!!n){for(var g=_.inputTimeScale,r=0;r<n;r++){var E=_.samples[r];E.pts=i(E.pts-o,u*g)/g}_.samples.sort(function(y,U){return y.pts-U.pts});var P=_.samples;return _.samples=[],{samples:P}}}var s=function(u,o,n,g){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=o,this.size=n,this.cts=g,this.flags=new c(u)},c=function(u){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=u?2:1,this.isNonSync=u?0:1}},"./src/remux/passthrough-remuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>b});var w=v("./src/polyfills/number.ts"),S=v("./src/remux/mp4-remuxer.ts"),k=v("./src/utils/mp4-tools.ts"),R=v("./src/loader/fragment.ts"),W=v("./src/utils/logger.ts"),C=function(){function L(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var A=L.prototype;return A.destroy=function(){},A.resetTimeStamp=function(D){this.initPTS=D,this.lastEndTime=null},A.resetNextTimestamp=function(){this.lastEndTime=null},A.resetInitSegment=function(D,T,d,f){this.audioCodec=T,this.videoCodec=d,this.generateInitSegment((0,k.patchEncyptionData)(D,f)),this.emitInitSegment=!0},A.generateInitSegment=function(D){var T=this.audioCodec,d=this.videoCodec;if(!D||!D.byteLength){this.initTracks=void 0,this.initData=void 0;return}var f=this.initData=(0,k.parseInitSegment)(D);T||(T=I(f.audio,R.ElementaryStreamTypes.AUDIO)),d||(d=I(f.video,R.ElementaryStreamTypes.VIDEO));var i={};f.audio&&f.video?i.audiovideo={container:"video/mp4",codec:T+","+d,initSegment:D,id:"main"}:f.audio?i.audio={container:"audio/mp4",codec:T,initSegment:D,id:"audio"}:f.video?i.video={container:"video/mp4",codec:d,initSegment:D,id:"main"}:W.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i},A.remux=function(D,T,d,f,i){var l,p=this.initPTS,m=this.lastEndTime,s={audio:void 0,video:void 0,text:f,id3:d,initSegment:void 0};(0,w.isFiniteNumber)(m)||(m=this.lastEndTime=i||0);var c=T.samples;if(!c||!c.length)return s;var _={initPTS:void 0,timescale:1},u=this.initData;if((!u||!u.length)&&(this.generateInitSegment(c),u=this.initData),!u||!u.length)return W.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),s;this.emitInitSegment&&(_.tracks=this.initTracks,this.emitInitSegment=!1);var o=(0,k.getStartDTS)(u,c);(0,w.isFiniteNumber)(p)||(this.initPTS=_.initPTS=p=o-i);var n=(0,k.getDuration)(c,u),g=D?o-p:m,r=g+n;(0,k.offsetStartDTS)(u,c,p),n>0?this.lastEndTime=r:(W.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!u.audio,P=!!u.video,y="";E&&(y+="audio"),P&&(y+="video");var U={data1:c,startPTS:g,startDTS:g,endPTS:r,endDTS:r,type:y,hasAudio:E,hasVideo:P,nb:1,dropped:0};s.audio=U.type==="audio"?U:void 0,s.video=U.type!=="audio"?U:void 0,s.initSegment=_;var B=(l=this.initPTS)!=null?l:0;return s.id3=(0,S.flushTextTrackMetadataCueSamples)(d,i,B,B),f.samples.length&&(s.text=(0,S.flushTextTrackUserdataCueSamples)(f,i,B)),s},L}();function I(L,A){var h=L==null?void 0:L.codec;return h&&h.length>4?h:h==="hvc1"||h==="hev1"?"hvc1.1.c.L120.90":h==="av01"?"av01.0.04M.08":h==="avc1"||A===R.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const b=C},"./src/task-loop.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>w});var w=function(){function S(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var k=S.prototype;return k.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},k.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},k.onHandlerDestroyed=function(){},k.hasInterval=function(){return!!this._tickInterval},k.hasNextTick=function(){return!!this._tickTimer},k.setInterval=function(W){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,W),!0)},k.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},k.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},k.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},k.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},k.doTick=function(){},S}()},"./src/types/cmcd.ts":(N,O,v)=>{v.r(O),v.d(O,{CMCDObjectType:()=>S,CMCDStreamType:()=>R,CMCDStreamingFormat:()=>k,CMCDVersion:()=>w});var w=1,S;(function(W){W.MANIFEST="m",W.AUDIO="a",W.VIDEO="v",W.MUXED="av",W.INIT="i",W.CAPTION="c",W.TIMED_TEXT="tt",W.KEY="k",W.OTHER="o"})(S||(S={}));var k;(function(W){W.DASH="d",W.HLS="h",W.SMOOTH="s",W.OTHER="o"})(k||(k={}));var R;(function(W){W.VOD="v",W.LIVE="l"})(R||(R={}))},"./src/types/demuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{MetadataSchema:()=>w});var w;(function(S){S.audioId3="org.id3",S.dateRange="com.apple.quicktime.HLS",S.emsg="https://aomedia.org/emsg/ID3"})(w||(w={}))},"./src/types/level.ts":(N,O,v)=>{v.r(O),v.d(O,{HdcpLevels:()=>W,HlsSkip:()=>C,HlsUrlParameters:()=>b,Level:()=>L,getSkipValue:()=>I});function w(A,h){for(var D=0;D<h.length;D++){var T=h[D];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(A,k(T.key),T)}}function S(A,h,D){return h&&w(A.prototype,h),D&&w(A,D),Object.defineProperty(A,"prototype",{writable:!1}),A}function k(A){var h=R(A,"string");return typeof h=="symbol"?h:String(h)}function R(A,h){if(typeof A!="object"||A===null)return A;var D=A[Symbol.toPrimitive];if(D!==void 0){var T=D.call(A,h||"default");if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(h==="string"?String:Number)(A)}var W=["NONE","TYPE-0","TYPE-1","TYPE-2",null],C;(function(A){A.No="",A.Yes="YES",A.v2="v2"})(C||(C={}));function I(A,h){var D=A.canSkipUntil,T=A.canSkipDateRanges,d=A.endSN,f=h!==void 0?h-d:0;return D&&f<D?T?C.v2:C.Yes:C.No}var b=function(){function A(D,T,d){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=D,this.part=T,this.skip=d}var h=A.prototype;return h.addDirectives=function(T){var d=new self.URL(T);return this.msn!==void 0&&d.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&d.searchParams.set("_HLS_part",this.part.toString()),this.skip&&d.searchParams.set("_HLS_skip",this.skip),d.href},A}(),L=function(){function A(h){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[h.url],this.attrs=h.attrs,this.bitrate=h.bitrate,h.details&&(this.details=h.details),this.id=h.id||0,this.name=h.name,this.width=h.width||0,this.height=h.height||0,this.audioCodec=h.audioCodec,this.videoCodec=h.videoCodec,this.unknownCodecs=h.unknownCodecs,this.codecSet=[h.videoCodec,h.audioCodec].filter(function(D){return D}).join(",").replace(/\.[^.,]+/g,"")}return S(A,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(D){var T=D%this.url.length;this._urlId!==T&&(this.details=void 0,this._urlId=T)}}]),A}()},"./src/types/loader.ts":(N,O,v)=>{v.r(O),v.d(O,{PlaylistContextType:()=>w,PlaylistLevelType:()=>S});var w;(function(k){k.MANIFEST="manifest",k.LEVEL="level",k.AUDIO_TRACK="audioTrack",k.SUBTITLE_TRACK="subtitleTrack"})(w||(w={}));var S;(function(k){k.MAIN="main",k.AUDIO="audio",k.SUBTITLE="subtitle"})(S||(S={}))},"./src/types/transmuxer.ts":(N,O,v)=>{v.r(O),v.d(O,{ChunkMetadata:()=>w});var w=function(R,W,C,I,b,L){I===void 0&&(I=0),b===void 0&&(b=-1),L===void 0&&(L=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=S(),this.buffering={audio:S(),video:S(),audiovideo:S()},this.level=R,this.sn=W,this.id=C,this.size=I,this.part=b,this.partial=L};function S(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":(N,O,v)=>{v.r(O),v.d(O,{AttrList:()=>k});var w=/^(\d+)x(\d+)$/,S=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,k=function(){function R(C){typeof C=="string"&&(C=R.parseAttrList(C));for(var I in C)C.hasOwnProperty(I)&&(this[I]=C[I])}var W=R.prototype;return W.decimalInteger=function(I){var b=parseInt(this[I],10);return b>Number.MAX_SAFE_INTEGER?1/0:b},W.hexadecimalInteger=function(I){if(this[I]){var b=(this[I]||"0x").slice(2);b=(b.length&1?"0":"")+b;for(var L=new Uint8Array(b.length/2),A=0;A<b.length/2;A++)L[A]=parseInt(b.slice(A*2,A*2+2),16);return L}else return null},W.hexadecimalIntegerAsNumber=function(I){var b=parseInt(this[I],16);return b>Number.MAX_SAFE_INTEGER?1/0:b},W.decimalFloatingPoint=function(I){return parseFloat(this[I])},W.optionalFloat=function(I,b){var L=this[I];return L?parseFloat(L):b},W.enumeratedString=function(I){return this[I]},W.bool=function(I){return this[I]==="YES"},W.decimalResolution=function(I){var b=w.exec(this[I]);if(b!==null)return{width:parseInt(b[1],10),height:parseInt(b[2],10)}},R.parseAttrList=function(I){var b,L={},A='"';for(S.lastIndex=0;(b=S.exec(I))!==null;){var h=b[2];h.indexOf(A)===0&&h.lastIndexOf(A)===h.length-1&&(h=h.slice(1,-1)),L[b[1]]=h}return L},R}()},"./src/utils/binary-search.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>S});var w={search:function(R,W){for(var C=0,I=R.length-1,b=null,L=null;C<=I;){b=(C+I)/2|0,L=R[b];var A=W(L);if(A>0)C=b+1;else if(A<0)I=b-1;else return L}return null}};const S=w},"./src/utils/buffer-helper.ts":(N,O,v)=>{v.r(O),v.d(O,{BufferHelper:()=>k});var w=v("./src/utils/logger.ts"),S={length:0,start:function(){return 0},end:function(){return 0}},k=function(){function R(){}return R.isBuffered=function(C,I){try{if(C){for(var b=R.getBuffered(C),L=0;L<b.length;L++)if(I>=b.start(L)&&I<=b.end(L))return!0}}catch{}return!1},R.bufferInfo=function(C,I,b){try{if(C){var L=R.getBuffered(C),A=[],h;for(h=0;h<L.length;h++)A.push({start:L.start(h),end:L.end(h)});return this.bufferedInfo(A,I,b)}}catch{}return{len:0,start:I,end:I,nextStart:void 0}},R.bufferedInfo=function(C,I,b){I=Math.max(0,I),C.sort(function(s,c){var _=s.start-c.start;return _||c.end-s.end});var L=[];if(b)for(var A=0;A<C.length;A++){var h=L.length;if(h){var D=L[h-1].end;C[A].start-D<b?C[A].end>D&&(L[h-1].end=C[A].end):L.push(C[A])}else L.push(C[A])}else L=C;for(var T=0,d,f=I,i=I,l=0;l<L.length;l++){var p=L[l].start,m=L[l].end;if(I+b>=p&&I<m)f=p,i=m,T=i-I;else if(I+b<p){d=p;break}}return{len:T,start:f||0,end:i||0,nextStart:d}},R.getBuffered=function(C){try{return C.buffered}catch(I){return w.logger.log("failed to get media.buffered",I),S}},R}()},"./src/utils/cea-608-parser.ts":(N,O,v)=>{v.r(O),v.d(O,{CaptionScreen:()=>l,Row:()=>i,default:()=>u});var w=v("./src/utils/logger.ts"),S={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},k=function(n){var g=n;return S.hasOwnProperty(n)&&(g=S[n]),String.fromCharCode(g)},R=15,W=100,C={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},I={17:2,18:4,21:6,22:8,23:10,19:13,20:15},b={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},L={25:2,26:4,29:6,30:8,31:10,27:13,28:15},A=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h;(function(o){o[o.ERROR=0]="ERROR",o[o.TEXT=1]="TEXT",o[o.WARNING=2]="WARNING",o[o.INFO=2]="INFO",o[o.DEBUG=3]="DEBUG",o[o.DATA=3]="DATA"})(h||(h={}));var D=function(){function o(){this.time=null,this.verboseLevel=h.ERROR}var n=o.prototype;return n.log=function(r,E){if(this.verboseLevel>=r){var P=typeof E=="function"?E():E;w.logger.log(this.time+" ["+r+"] "+P)}},o}(),T=function(n){for(var g=[],r=0;r<n.length;r++)g.push(n[r].toString(16));return g},d=function(){function o(g,r,E,P,y){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=g||"white",this.underline=r||!1,this.italics=E||!1,this.background=P||"black",this.flash=y||!1}var n=o.prototype;return n.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},n.setStyles=function(r){for(var E=["foreground","underline","italics","background","flash"],P=0;P<E.length;P++){var y=E[P];r.hasOwnProperty(y)&&(this[y]=r[y])}},n.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},n.equals=function(r){return this.foreground===r.foreground&&this.underline===r.underline&&this.italics===r.italics&&this.background===r.background&&this.flash===r.flash},n.copy=function(r){this.foreground=r.foreground,this.underline=r.underline,this.italics=r.italics,this.background=r.background,this.flash=r.flash},n.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},o}(),f=function(){function o(g,r,E,P,y,U){this.uchar=void 0,this.penState=void 0,this.uchar=g||" ",this.penState=new d(r,E,P,y,U)}var n=o.prototype;return n.reset=function(){this.uchar=" ",this.penState.reset()},n.setChar=function(r,E){this.uchar=r,this.penState.copy(E)},n.setPenState=function(r){this.penState.copy(r)},n.equals=function(r){return this.uchar===r.uchar&&this.penState.equals(r.penState)},n.copy=function(r){this.uchar=r.uchar,this.penState.copy(r.penState)},n.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},o}(),i=function(){function o(g){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var r=0;r<W;r++)this.chars.push(new f);this.logger=g,this.pos=0,this.currPenState=new d}var n=o.prototype;return n.equals=function(r){for(var E=!0,P=0;P<W;P++)if(!this.chars[P].equals(r.chars[P])){E=!1;break}return E},n.copy=function(r){for(var E=0;E<W;E++)this.chars[E].copy(r.chars[E])},n.isEmpty=function(){for(var r=!0,E=0;E<W;E++)if(!this.chars[E].isEmpty()){r=!1;break}return r},n.setCursor=function(r){this.pos!==r&&(this.pos=r),this.pos<0?(this.logger.log(h.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>W&&(this.logger.log(h.DEBUG,"Too large cursor position "+this.pos),this.pos=W)},n.moveCursor=function(r){var E=this.pos+r;if(r>1)for(var P=this.pos+1;P<E+1;P++)this.chars[P].setPenState(this.currPenState);this.setCursor(E)},n.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},n.insertChar=function(r){var E=this;r>=144&&this.backSpace();var P=k(r);if(this.pos>=W){this.logger.log(h.ERROR,function(){return"Cannot insert "+r.toString(16)+" ("+P+") at position "+E.pos+". Skipping it!"});return}this.chars[this.pos].setChar(P,this.currPenState),this.moveCursor(1)},n.clearFromPos=function(r){var E;for(E=r;E<W;E++)this.chars[E].reset()},n.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},n.clearToEndOfRow=function(){this.clearFromPos(this.pos)},n.getTextString=function(){for(var r=[],E=!0,P=0;P<W;P++){var y=this.chars[P].uchar;y!==" "&&(E=!1),r.push(y)}return E?"":r.join("")},n.setPenStyles=function(r){this.currPenState.setStyles(r);var E=this.chars[this.pos];E.setPenState(this.currPenState)},o}(),l=function(){function o(g){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var r=0;r<R;r++)this.rows.push(new i(g));this.logger=g,this.currRow=R-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var n=o.prototype;return n.reset=function(){for(var r=0;r<R;r++)this.rows[r].clear();this.currRow=R-1},n.equals=function(r){for(var E=!0,P=0;P<R;P++)if(!this.rows[P].equals(r.rows[P])){E=!1;break}return E},n.copy=function(r){for(var E=0;E<R;E++)this.rows[E].copy(r.rows[E])},n.isEmpty=function(){for(var r=!0,E=0;E<R;E++)if(!this.rows[E].isEmpty()){r=!1;break}return r},n.backSpace=function(){var r=this.rows[this.currRow];r.backSpace()},n.clearToEndOfRow=function(){var r=this.rows[this.currRow];r.clearToEndOfRow()},n.insertChar=function(r){var E=this.rows[this.currRow];E.insertChar(r)},n.setPen=function(r){var E=this.rows[this.currRow];E.setPenStyles(r)},n.moveCursor=function(r){var E=this.rows[this.currRow];E.moveCursor(r)},n.setCursor=function(r){this.logger.log(h.INFO,"setCursor: "+r);var E=this.rows[this.currRow];E.setCursor(r)},n.setPAC=function(r){this.logger.log(h.INFO,function(){return"pacData = "+JSON.stringify(r)});var E=r.row-1;if(this.nrRollUpRows&&E<this.nrRollUpRows-1&&(E=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==E){for(var P=0;P<R;P++)this.rows[P].clear();var y=this.currRow+1-this.nrRollUpRows,U=this.lastOutputScreen;if(U){var B=U.rows[y].cueStartTime,F=this.logger.time;if(B&&F!==null&&B<F)for(var H=0;H<this.nrRollUpRows;H++)this.rows[E-this.nrRollUpRows+H+1].copy(U.rows[y+H])}}this.currRow=E;var G=this.rows[this.currRow];if(r.indent!==null){var V=r.indent,z=Math.max(V-1,0);G.setCursor(r.indent),r.color=G.chars[z].penState.foreground}var $={foreground:r.color,underline:r.underline,italics:r.italics,background:"black",flash:!1};this.setPen($)},n.setBkgData=function(r){this.logger.log(h.INFO,function(){return"bkgData = "+JSON.stringify(r)}),this.backSpace(),this.setPen(r),this.insertChar(32)},n.setRollUpRows=function(r){this.nrRollUpRows=r},n.rollUp=function(){var r=this;if(this.nrRollUpRows===null){this.logger.log(h.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(h.TEXT,function(){return r.getDisplayText()});var E=this.currRow+1-this.nrRollUpRows,P=this.rows.splice(E,1)[0];P.clear(),this.rows.splice(this.currRow,0,P),this.logger.log(h.INFO,"Rolling up")},n.getDisplayText=function(r){r=r||!1;for(var E=[],P="",y=-1,U=0;U<R;U++){var B=this.rows[U].getTextString();B&&(y=U+1,r?E.push("Row "+y+": '"+B+"'"):E.push(B.trim()))}return E.length>0&&(r?P="["+E.join(" | ")+"]":P=E.join(`
`)),P},n.getTextAndFormat=function(){return this.rows},o}(),p=function(){function o(g,r,E){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=g,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new l(E),this.nonDisplayedMemory=new l(E),this.lastOutputScreen=new l(E),this.currRollUpRow=this.displayedMemory.rows[R-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=E}var n=o.prototype;return n.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[R-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},n.getHandler=function(){return this.outputFilter},n.setHandler=function(r){this.outputFilter=r},n.setPAC=function(r){this.writeScreen.setPAC(r)},n.setBkgData=function(r){this.writeScreen.setBkgData(r)},n.setMode=function(r){r!==this.mode&&(this.mode=r,this.logger.log(h.INFO,function(){return"MODE="+r}),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=r)},n.insertChars=function(r){for(var E=this,P=0;P<r.length;P++)this.writeScreen.insertChar(r[P]);var y=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(h.INFO,function(){return y+": "+E.writeScreen.getDisplayText(!0)}),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(h.TEXT,function(){return"DISPLAYED: "+E.displayedMemory.getDisplayText(!0)}),this.outputDataUpdate())},n.ccRCL=function(){this.logger.log(h.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},n.ccBS=function(){this.logger.log(h.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},n.ccAOF=function(){},n.ccAON=function(){},n.ccDER=function(){this.logger.log(h.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},n.ccRU=function(r){this.logger.log(h.INFO,"RU("+r+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(r)},n.ccFON=function(){this.logger.log(h.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},n.ccRDC=function(){this.logger.log(h.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},n.ccTR=function(){this.logger.log(h.INFO,"TR"),this.setMode("MODE_TEXT")},n.ccRTD=function(){this.logger.log(h.INFO,"RTD"),this.setMode("MODE_TEXT")},n.ccEDM=function(){this.logger.log(h.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},n.ccCR=function(){this.logger.log(h.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},n.ccENM=function(){this.logger.log(h.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},n.ccEOC=function(){var r=this;if(this.logger.log(h.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var E=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=E,this.writeScreen=this.nonDisplayedMemory,this.logger.log(h.TEXT,function(){return"DISP: "+r.displayedMemory.getDisplayText()})}this.outputDataUpdate(!0)},n.ccTO=function(r){this.logger.log(h.INFO,"TO("+r+") - Tab Offset"),this.writeScreen.moveCursor(r)},n.ccMIDROW=function(r){var E={flash:!1};if(E.underline=r%2===1,E.italics=r>=46,E.italics)E.foreground="white";else{var P=Math.floor(r/2)-16,y=["white","green","blue","cyan","red","yellow","magenta"];E.foreground=y[P]}this.logger.log(h.INFO,"MIDROW: "+JSON.stringify(E)),this.writeScreen.setPen(E)},n.outputDataUpdate=function(r){r===void 0&&(r=!1);var E=this.logger.time;E!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=E:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,E,this.lastOutputScreen),r&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:E),this.lastOutputScreen.copy(this.displayedMemory))},n.cueSplitAtTime=function(r){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,r,this.displayedMemory),this.cueStartTime=r))},o}(),m=function(){function o(g,r,E){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var P=new D;this.channels=[null,new p(g,r,P),new p(g+1,E,P)],this.cmdHistory=_(),this.logger=P}var n=o.prototype;return n.getHandler=function(r){return this.channels[r].getHandler()},n.setHandler=function(r,E){this.channels[r].setHandler(E)},n.addData=function(r,E){var P,y,U,B=!1;this.logger.time=r;for(var F=0;F<E.length;F+=2)if(y=E[F]&127,U=E[F+1]&127,!(y===0&&U===0)){if(this.logger.log(h.DATA,"["+T([E[F],E[F+1]])+"] -> ("+T([y,U])+")"),P=this.parseCmd(y,U),P||(P=this.parseMidrow(y,U)),P||(P=this.parsePAC(y,U)),P||(P=this.parseBackgroundAttributes(y,U)),!P&&(B=this.parseChars(y,U),B)){var H=this.currentChannel;if(H&&H>0){var G=this.channels[H];G.insertChars(B)}else this.logger.log(h.WARNING,"No channel found yet. TEXT-MODE?")}!P&&!B&&this.logger.log(h.WARNING,"Couldn't parse cleaned data "+T([y,U])+" orig: "+T([E[F],E[F+1]]))}},n.parseCmd=function(r,E){var P=this.cmdHistory,y=(r===20||r===28||r===21||r===29)&&E>=32&&E<=47,U=(r===23||r===31)&&E>=33&&E<=35;if(!(y||U))return!1;if(c(r,E,P))return s(null,null,P),this.logger.log(h.DEBUG,"Repeated command ("+T([r,E])+") is dropped"),!0;var B=r===20||r===21||r===23?1:2,F=this.channels[B];return r===20||r===21||r===28||r===29?E===32?F.ccRCL():E===33?F.ccBS():E===34?F.ccAOF():E===35?F.ccAON():E===36?F.ccDER():E===37?F.ccRU(2):E===38?F.ccRU(3):E===39?F.ccRU(4):E===40?F.ccFON():E===41?F.ccRDC():E===42?F.ccTR():E===43?F.ccRTD():E===44?F.ccEDM():E===45?F.ccCR():E===46?F.ccENM():E===47&&F.ccEOC():F.ccTO(E-32),s(r,E,P),this.currentChannel=B,!0},n.parseMidrow=function(r,E){var P=0;if((r===17||r===25)&&E>=32&&E<=47){if(r===17?P=1:P=2,P!==this.currentChannel)return this.logger.log(h.ERROR,"Mismatch channel in midrow parsing"),!1;var y=this.channels[P];return y?(y.ccMIDROW(E),this.logger.log(h.DEBUG,"MIDROW ("+T([r,E])+")"),!0):!1}return!1},n.parsePAC=function(r,E){var P,y=this.cmdHistory,U=(r>=17&&r<=23||r>=25&&r<=31)&&E>=64&&E<=127,B=(r===16||r===24)&&E>=64&&E<=95;if(!(U||B))return!1;if(c(r,E,y))return s(null,null,y),!0;var F=r<=23?1:2;E>=64&&E<=95?P=F===1?C[r]:b[r]:P=F===1?I[r]:L[r];var H=this.channels[F];return H?(H.setPAC(this.interpretPAC(P,E)),s(r,E,y),this.currentChannel=F,!0):!1},n.interpretPAC=function(r,E){var P,y={color:null,italics:!1,indent:null,underline:!1,row:r};return E>95?P=E-96:P=E-64,y.underline=(P&1)===1,P<=13?y.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(P/2)]:P<=15?(y.italics=!0,y.color="white"):y.indent=Math.floor((P-16)/2)*4,y},n.parseChars=function(r,E){var P,y=null,U=null;if(r>=25?(P=2,U=r-8):(P=1,U=r),U>=17&&U<=19){var B;U===17?B=E+80:U===18?B=E+112:B=E+144,this.logger.log(h.INFO,"Special char '"+k(B)+"' in channel "+P),y=[B]}else r>=32&&r<=127&&(y=E===0?[r]:[r,E]);if(y){var F=T(y);this.logger.log(h.DEBUG,"Char codes =  "+F.join(",")),s(r,E,this.cmdHistory)}return y},n.parseBackgroundAttributes=function(r,E){var P=(r===16||r===24)&&E>=32&&E<=47,y=(r===23||r===31)&&E>=45&&E<=47;if(!(P||y))return!1;var U,B={};r===16||r===24?(U=Math.floor((E-32)/2),B.background=A[U],E%2===1&&(B.background=B.background+"_semi")):E===45?B.background="transparent":(B.foreground="black",E===47&&(B.underline=!0));var F=r<=23?1:2,H=this.channels[F];return H.setBkgData(B),s(r,E,this.cmdHistory),!0},n.reset=function(){for(var r=0;r<Object.keys(this.channels).length;r++){var E=this.channels[r];E&&E.reset()}this.cmdHistory=_()},n.cueSplitAtTime=function(r){for(var E=0;E<this.channels.length;E++){var P=this.channels[E];P&&P.cueSplitAtTime(r)}},o}();function s(o,n,g){g.a=o,g.b=n}function c(o,n,g){return g.a===o&&g.b===n}function _(){return{a:null,b:null}}const u=m},"./src/utils/codecs.ts":(N,O,v)=>{v.r(O),v.d(O,{isCodecSupportedInMp4:()=>k,isCodecType:()=>S});var w={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function S(R,W){var C=w[W];return!!C&&C[R.slice(0,4)]===!0}function k(R,W){return MediaSource.isTypeSupported((W||"video")+'/mp4;codecs="'+R+'"')}},"./src/utils/cues.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>C});var w=v("./src/utils/vttparser.ts"),S=v("./src/utils/webvtt-parser.ts"),k=v("./src/utils/texttrack-utils.ts"),R=/\s/,W={newCue:function(b,L,A,h){for(var D=[],T,d,f,i,l,p=self.VTTCue||self.TextTrackCue,m=0;m<h.rows.length;m++)if(T=h.rows[m],f=!0,i=0,l="",!T.isEmpty()){for(var s=0;s<T.chars.length;s++)R.test(T.chars[s].uchar)&&f?i++:(l+=T.chars[s].uchar,f=!1);T.cueStartTime=L,L===A&&(A+=1e-4),i>=16?i--:i++;var c=(0,w.fixLineBreaks)(l.trim()),_=(0,S.generateCueId)(L,A,c);(!b||!b.cues||!b.cues.getCueById(_))&&(d=new p(L,A,c),d.id=_,d.line=m+1,d.align="left",d.position=10+Math.min(80,Math.floor(i*8/32)*10),D.push(d))}return b&&D.length&&(D.sort(function(u,o){return u.line==="auto"||o.line==="auto"?0:u.line>8&&o.line>8?o.line-u.line:u.line-o.line}),D.forEach(function(u){return(0,k.addCueToTrack)(b,u)})),D}};const C=W},"./src/utils/discontinuities.ts":(N,O,v)=>{v.r(O),v.d(O,{adjustSlidingStart:()=>b,alignMediaPlaylistByPDT:()=>D,alignPDT:()=>h,alignStream:()=>L,findDiscontinuousReferenceFrag:()=>C,findFirstFragWithCC:()=>R,shouldAlignOnDiscontinuities:()=>W});var w=v("./src/polyfills/number.ts"),S=v("./src/utils/logger.ts"),k=v("./src/controller/level-helper.ts");function R(T,d){for(var f=null,i=0,l=T.length;i<l;i++){var p=T[i];if(p&&p.cc===d){f=p;break}}return f}function W(T,d,f){return!!(d.details&&(f.endCC>f.startCC||T&&T.cc<f.startCC))}function C(T,d,f){var i=T.fragments,l=d.fragments;if(!l.length||!i.length){S.logger.log("No fragments to align");return}var p=R(i,l[0].cc);if(!p||p&&!p.startPTS){S.logger.log("No frag in previous level to align on");return}return p}function I(T,d){if(T){var f=T.start+d;T.start=T.startPTS=f,T.endPTS=f+T.duration}}function b(T,d){for(var f=d.fragments,i=0,l=f.length;i<l;i++)I(f[i],T);d.fragmentHint&&I(d.fragmentHint,T),d.alignedSliding=!0}function L(T,d,f){!d||(A(T,f,d),!f.alignedSliding&&d.details&&h(f,d.details),!f.alignedSliding&&d.details&&!f.skippedSegments&&(0,k.adjustSliding)(d.details,f))}function A(T,d,f){if(W(T,f,d)){var i=C(f.details,d);i&&(0,w.isFiniteNumber)(i.start)&&(S.logger.log("Adjusting PTS using last level due to CC increase within current level "+d.url),b(i.start,d))}}function h(T,d){if(!(!d.fragments.length||!T.hasProgramDateTime||!d.hasProgramDateTime)){var f=d.fragments[0].programDateTime,i=T.fragments[0].programDateTime,l=(i-f)/1e3+d.fragments[0].start;l&&(0,w.isFiniteNumber)(l)&&(S.logger.log("Adjusting PTS using programDateTime delta "+(i-f)+"ms, sliding:"+l.toFixed(3)+" "+T.url+" "),b(l,T))}}function D(T,d){if(!(!T.hasProgramDateTime||!d.hasProgramDateTime)){var f=T.fragments,i=d.fragments;if(!(!f.length||!i.length)){var l=Math.round(i.length/2)-1,p=i[l],m=R(f,p.cc)||f[Math.round(f.length/2)-1],s=p.programDateTime,c=m.programDateTime;if(!(s===null||c===null)){var _=(c-s)/1e3-(m.start-p.start);b(_,T)}}}}},"./src/utils/ewma-bandwidth-estimator.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>k});var w=v("./src/utils/ewma.ts"),S=function(){function R(C,I,b){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=b,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new w.default(C),this.fast_=new w.default(I)}var W=R.prototype;return W.update=function(I,b){var L=this.slow_,A=this.fast_;this.slow_.halfLife!==I&&(this.slow_=new w.default(I,L.getEstimate(),L.getTotalWeight())),this.fast_.halfLife!==b&&(this.fast_=new w.default(b,A.getEstimate(),A.getTotalWeight()))},W.sample=function(I,b){I=Math.max(I,this.minDelayMs_);var L=8*b,A=I/1e3,h=L/A;this.fast_.sample(A,h),this.slow_.sample(A,h)},W.canEstimate=function(){var I=this.fast_;return I&&I.getTotalWeight()>=this.minWeight_},W.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},W.destroy=function(){},R}();const k=S},"./src/utils/ewma.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>S});var w=function(){function k(W,C,I){C===void 0&&(C=0),I===void 0&&(I=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=W,this.alpha_=W?Math.exp(Math.log(.5)/W):0,this.estimate_=C,this.totalWeight_=I}var R=k.prototype;return R.sample=function(C,I){var b=Math.pow(this.alpha_,C);this.estimate_=I*(1-b)+b*this.estimate_,this.totalWeight_+=C},R.getTotalWeight=function(){return this.totalWeight_},R.getEstimate=function(){if(this.alpha_){var C=1-Math.pow(this.alpha_,this.totalWeight_);if(C)return this.estimate_/C}return this.estimate_},k}();const S=w},"./src/utils/fetch-loader.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>l,fetchSupported:()=>D});var w=v("./src/polyfills/number.ts"),S=v("./src/loader/load-stats.ts"),k=v("./src/demux/chunk-cache.ts");function R(p,m){p.prototype=Object.create(m.prototype),p.prototype.constructor=p,L(p,m)}function W(p){var m=typeof Map=="function"?new Map:void 0;return W=function(c){if(c===null||!b(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof m!="undefined"){if(m.has(c))return m.get(c);m.set(c,_)}function _(){return C(c,arguments,A(this).constructor)}return _.prototype=Object.create(c.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),L(_,c)},W(p)}function C(p,m,s){return I()?C=Reflect.construct.bind():C=function(_,u,o){var n=[null];n.push.apply(n,u);var g=Function.bind.apply(_,n),r=new g;return o&&L(r,o.prototype),r},C.apply(null,arguments)}function I(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(p){return Function.toString.call(p).indexOf("[native code]")!==-1}function L(p,m){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,_){return c.__proto__=_,c},L(p,m)}function A(p){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},A(p)}function h(){return h=Object.assign?Object.assign.bind():function(p){for(var m=1;m<arguments.length;m++){var s=arguments[m];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(p[c]=s[c])}return p},h.apply(this,arguments)}function D(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var T=function(){function p(s){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=s.fetchSetup||f,this.controller=new self.AbortController,this.stats=new S.LoadStats}var m=p.prototype;return m.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},m.abortInternal=function(){var c=this.response;(!c||!c.ok)&&(this.stats.aborted=!0,this.controller.abort())},m.abort=function(){var c;this.abortInternal(),(c=this.callbacks)!==null&&c!==void 0&&c.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},m.load=function(c,_,u){var o=this,n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();var g=d(c,this.controller.signal),r=u.onProgress,E=c.responseType==="arraybuffer",P=E?"byteLength":"length";this.context=c,this.config=_,this.callbacks=u,this.request=this.fetchSetup(c,g),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){o.abortInternal(),u.onTimeout(n,c,o.response)},_.timeout),self.fetch(this.request).then(function(y){if(o.response=o.loader=y,!y.ok){var U=y.status,B=y.statusText;throw new i(B||"fetch, bad network response",U,y)}return n.loading.first=Math.max(self.performance.now(),n.loading.start),n.total=parseInt(y.headers.get("Content-Length")||"0"),r&&(0,w.isFiniteNumber)(_.highWaterMark)?o.loadProgressively(y,n,c,_.highWaterMark,r):E?y.arrayBuffer():y.text()}).then(function(y){var U=o.response;self.clearTimeout(o.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);var B=y[P];B&&(n.loaded=n.total=B);var F={url:U.url,data:y};r&&!(0,w.isFiniteNumber)(_.highWaterMark)&&r(n,c,y,U),u.onSuccess(F,n,c,U)}).catch(function(y){if(self.clearTimeout(o.requestTimeout),!n.aborted){var U=y&&y.code||0,B=y?y.message:null;u.onError({code:U,text:B},c,y?y.details:null)}})},m.getCacheAge=function(){var c=null;if(this.response){var _=this.response.headers.get("age");c=_?parseFloat(_):null}return c},m.loadProgressively=function(c,_,u,o,n){o===void 0&&(o=0);var g=new k.default,r=c.body.getReader(),E=function P(){return r.read().then(function(y){if(y.done)return g.dataLength&&n(_,u,g.flush(),c),Promise.resolve(new ArrayBuffer(0));var U=y.value,B=U.length;return _.loaded+=B,B<o||g.dataLength?(g.push(U),g.dataLength>=o&&n(_,u,g.flush(),c)):n(_,u,U,c),P()}).catch(function(){return Promise.reject()})};return E()},p}();function d(p,m){var s={method:"GET",mode:"cors",credentials:"same-origin",signal:m,headers:new self.Headers(h({},p.headers))};return p.rangeEnd&&s.headers.set("Range","bytes="+p.rangeStart+"-"+String(p.rangeEnd-1)),s}function f(p,m){return new self.Request(p.url,m)}var i=function(p){R(m,p);function m(s,c,_){var u;return u=p.call(this,s)||this,u.code=void 0,u.details=void 0,u.code=c,u.details=_,u}return m}(W(Error));const l=T},"./src/utils/hex.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>S});var w={hexDump:function(R){for(var W="",C=0;C<R.length;C++){var I=R[C].toString(16);I.length<2&&(I="0"+I),W+=I}return W}};const S=w},"./src/utils/imsc1-ttml-parser.ts":(N,O,v)=>{v.r(O),v.d(O,{IMSC1_CODEC:()=>b,parseIMSC1:()=>D});var w=v("./src/utils/mp4-tools.ts"),S=v("./src/utils/vttparser.ts"),k=v("./src/utils/vttcue.ts"),R=v("./src/demux/id3.ts"),W=v("./src/utils/timescale-conversion.ts"),C=v("./src/utils/webvtt-parser.ts");function I(){return I=Object.assign?Object.assign.bind():function(u){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var g in n)Object.prototype.hasOwnProperty.call(n,g)&&(u[g]=n[g])}return u},I.apply(this,arguments)}var b="stpp.ttml.im1t",L=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,A=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,h={left:"start",center:"center",right:"end",start:"start",end:"end"};function D(u,o,n,g,r){var E=(0,w.findBox)(new Uint8Array(u),["mdat"]);if(E.length===0){r(new Error("Could not parse IMSC1 mdat"));return}var P=E.map(function(U){return(0,R.utf8ArrayToStr)(U)}),y=(0,W.toTimescaleFromScale)(o,1,n);try{P.forEach(function(U){return g(T(U,y))})}catch(U){r(U)}}function T(u,o){var n=new DOMParser,g=n.parseFromString(u,"text/xml"),r=g.getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var E={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(E).reduce(function(H,G){return H[G]=r.getAttribute("ttp:"+G)||E[G],H},{}),y=r.getAttribute("xml:space")!=="preserve",U=f(d(r,"styling","style")),B=f(d(r,"layout","region")),F=d(r,"body","[begin]");return[].map.call(F,function(H){var G=i(H,y);if(!G||!H.hasAttribute("begin"))return null;var V=s(H.getAttribute("begin"),P),z=s(H.getAttribute("dur"),P),$=s(H.getAttribute("end"),P);if(V===null)throw m(H);if($===null){if(z===null)throw m(H);$=V+z}var X=new k.default(V-o,$-o,G);X.id=(0,C.generateCueId)(X.startTime,X.endTime,X.text);var j=B[H.getAttribute("region")],Y=U[H.getAttribute("style")],Q=l(j,Y,U),J=Q.textAlign;if(J){var Z=h[J];Z&&(X.lineAlign=Z),X.align=J}return I(X,Q),X}).filter(function(H){return H!==null})}function d(u,o,n){var g=u.getElementsByTagName(o)[0];return g?[].slice.call(g.querySelectorAll(n)):[]}function f(u){return u.reduce(function(o,n){var g=n.getAttribute("xml:id");return g&&(o[g]=n),o},{})}function i(u,o){return[].slice.call(u.childNodes).reduce(function(n,g,r){var E;return g.nodeName==="br"&&r?n+`
`:(E=g.childNodes)!==null&&E!==void 0&&E.length?i(g,o):o?n+g.textContent.trim().replace(/\s+/g," "):n+g.textContent},"")}function l(u,o,n){var g="http://www.w3.org/ns/ttml#styling",r=null,E=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],P=u!=null&&u.hasAttribute("style")?u.getAttribute("style"):null;return P&&n.hasOwnProperty(P)&&(r=n[P]),E.reduce(function(y,U){var B=p(o,g,U)||p(u,g,U)||p(r,g,U);return B&&(y[U]=B),y},{})}function p(u,o,n){return u&&u.hasAttributeNS(o,n)?u.getAttributeNS(o,n):null}function m(u){return new Error("Could not parse ttml timestamp "+u)}function s(u,o){if(!u)return null;var n=(0,S.parseTimeStamp)(u);return n===null&&(L.test(u)?n=c(u,o):A.test(u)&&(n=_(u,o))),n}function c(u,o){var n=L.exec(u),g=(n[4]|0)+(n[5]|0)/o.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+g/o.frameRate}function _(u,o){var n=A.exec(u),g=Number(n[1]),r=n[2];switch(r){case"h":return g*3600;case"m":return g*60;case"ms":return g*1e3;case"f":return g/o.frameRate;case"t":return g/o.tickRate}return g}},"./src/utils/keysystem-util.ts":(N,O,v)=>{v.r(O),v.d(O,{changeEndianness:()=>k,convertDataUriToArrayBytes:()=>R,strToUtf8array:()=>W});var w=v("./src/utils/numeric-encoding-utils.ts");function S(C){var I=W(C).subarray(0,16),b=new Uint8Array(16);return b.set(I,16-I.length),b}function k(C){var I=function(L,A,h){var D=L[A];L[A]=L[h],L[h]=D};I(C,0,3),I(C,1,2),I(C,4,5),I(C,6,7)}function R(C){var I=C.split(":"),b=null;if(I[0]==="data"&&I.length===2){var L=I[1].split(";"),A=L[L.length-1].split(",");if(A.length===2){var h=A[0]==="base64",D=A[1];h?(L.splice(-1,1),b=(0,w.base64Decode)(D)):b=S(D)}}return b}function W(C){return Uint8Array.from(unescape(encodeURIComponent(C)),function(I){return I.charCodeAt(0)})}},"./src/utils/logger.ts":(N,O,v)=>{v.r(O),v.d(O,{enableLogs:()=>C,logger:()=>I});var w=function(){},S={trace:w,debug:w,log:w,warn:w,info:w,error:w},k=S;function R(b){var L=self.console[b];return L?L.bind(self.console,"["+b+"] >"):w}function W(b){for(var L=arguments.length,A=new Array(L>1?L-1:0),h=1;h<L;h++)A[h-1]=arguments[h];A.forEach(function(D){k[D]=b[D]?b[D].bind(b):R(D)})}function C(b,L){if(self.console&&b===!0||typeof b=="object"){W(b,"debug","log","info","warn","error");try{k.log('Debug logs enabled for "'+L+'"')}catch{k=S}}else k=S}var I=k},"./src/utils/mediakeys-helper.ts":(N,O,v)=>{v.r(O),v.d(O,{KeySystemFormats:()=>S,KeySystemIds:()=>R,KeySystems:()=>w,getKeySystemsForConfig:()=>I,getSupportedMediaKeySystemConfigurations:()=>L,keySystemDomainToKeySystemFormat:()=>C,keySystemFormatToKeySystemDomain:()=>k,keySystemIdToKeySystemDomain:()=>W,requestMediaKeySystemAccess:()=>b});var w;(function(h){h.CLEARKEY="org.w3.clearkey",h.FAIRPLAY="com.apple.fps",h.PLAYREADY="com.microsoft.playready",h.WIDEVINE="com.widevine.alpha"})(w||(w={}));var S;(function(h){h.CLEARKEY="org.w3.clearkey",h.FAIRPLAY="com.apple.streamingkeydelivery",h.PLAYREADY="com.microsoft.playready",h.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"})(S||(S={}));function k(h){switch(h){case S.FAIRPLAY:return w.FAIRPLAY;case S.PLAYREADY:return w.PLAYREADY;case S.WIDEVINE:return w.WIDEVINE;case S.CLEARKEY:return w.CLEARKEY}}var R;(function(h){h.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"})(R||(R={}));function W(h){if(h===R.WIDEVINE)return w.WIDEVINE}function C(h){switch(h){case w.FAIRPLAY:return S.FAIRPLAY;case w.PLAYREADY:return S.PLAYREADY;case w.WIDEVINE:return S.WIDEVINE;case w.CLEARKEY:return S.CLEARKEY}}function I(h){var D=h.drmSystems,T=h.widevineLicenseUrl,d=D?[w.FAIRPLAY,w.WIDEVINE,w.PLAYREADY,w.CLEARKEY].filter(function(f){return!!D[f]}):[];return!d[w.WIDEVINE]&&T&&d.push(w.WIDEVINE),d}var b=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function L(h,D,T,d){var f;switch(h){case w.FAIRPLAY:f=["cenc","sinf"];break;case w.WIDEVINE:case w.PLAYREADY:f=["cenc"];break;case w.CLEARKEY:f=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+h)}return A(f,D,T,d)}function A(h,D,T,d){var f={initDataTypes:h,persistentState:d.persistentState||"not-allowed",distinctiveIdentifier:d.distinctiveIdentifier||"not-allowed",sessionTypes:d.sessionTypes||[d.sessionType||"temporary"],audioCapabilities:D.map(function(i){return{contentType:'audio/mp4; codecs="'+i+'"',robustness:d.audioRobustness||"",encryptionScheme:d.audioEncryptionScheme||null}}),videoCapabilities:T.map(function(i){return{contentType:'video/mp4; codecs="'+i+'"',robustness:d.videoRobustness||"",encryptionScheme:d.videoEncryptionScheme||null}})};return[f]}},"./src/utils/mediasource-helper.ts":(N,O,v)=>{v.r(O),v.d(O,{getMediaSource:()=>w});function w(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":(N,O,v)=>{v.r(O),v.d(O,{RemuxerTrackIdConfig:()=>b,appendUint8Array:()=>o,bin2str:()=>L,computeRawDurationFromSamples:()=>c,discardEPB:()=>P,findBox:()=>d,getDuration:()=>s,getStartDTS:()=>m,mp4Box:()=>U,mp4pssh:()=>B,offsetStartDTS:()=>_,parseEmsg:()=>y,parseInitSegment:()=>i,parsePssh:()=>F,parseSEIMessageFromNALu:()=>E,parseSamples:()=>n,parseSegmentIndex:()=>f,parseSinf:()=>p,patchEncyptionData:()=>l,readSint32:()=>D,readUint16:()=>A,readUint32:()=>h,segmentValidRange:()=>u,writeUint32:()=>T});var w=v("./src/loader/fragment.ts"),S=v("./src/utils/typed-array.ts"),k=v("./src/demux/id3.ts"),R=v("./src/utils/logger.ts"),W=v("./src/utils/hex.ts"),C=Math.pow(2,32)-1,I=[].push,b={video:1,audio:2,id3:3,text:4};function L(H){return String.fromCharCode.apply(null,H)}function A(H,G){var V=H[G]<<8|H[G+1];return V<0?65536+V:V}function h(H,G){var V=D(H,G);return V<0?4294967296+V:V}function D(H,G){return H[G]<<24|H[G+1]<<16|H[G+2]<<8|H[G+3]}function T(H,G,V){H[G]=V>>24,H[G+1]=V>>16&255,H[G+2]=V>>8&255,H[G+3]=V&255}function d(H,G){var V=[];if(!G.length)return V;for(var z=H.byteLength,$=0;$<z;){var X=h(H,$),j=L(H.subarray($+4,$+8)),Y=X>1?$+X:z;if(j===G[0])if(G.length===1)V.push(H.subarray($+8,Y));else{var Q=d(H.subarray($+8,Y),G.slice(1));Q.length&&I.apply(V,Q)}$=Y}return V}function f(H){var G=[],V=H[0],z=8,$=h(H,z);z+=4;var X=0,j=0;V===0?z+=8:z+=16,z+=2;var Y=H.length+j,Q=A(H,z);z+=2;for(var J=0;J<Q;J++){var Z=z,ee=h(H,Z);Z+=4;var ne=ee&2147483647,te=(ee&2147483648)>>>31;if(te===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var q=h(H,Z);Z+=4,G.push({referenceSize:ne,subsegmentDuration:q,info:{duration:q/$,start:Y,end:Y+ne-1}}),Y+=ne,Z+=4,z=Z}return{earliestPresentationTime:X,timescale:$,version:V,referencesCount:Q,references:G}}function i(H){for(var G=[],V=d(H,["moov","trak"]),z=0;z<V.length;z++){var $=V[z],X=d($,["tkhd"])[0];if(X){var j=X[0],Y=j===0?12:20,Q=h(X,Y),J=d($,["mdia","mdhd"])[0];if(J){j=J[0],Y=j===0?12:20;var Z=h(J,Y),ee=d($,["mdia","hdlr"])[0];if(ee){var ne=L(ee.subarray(8,12)),te={soun:w.ElementaryStreamTypes.AUDIO,vide:w.ElementaryStreamTypes.VIDEO}[ne];if(te){var q=d($,["mdia","minf","stbl","stsd"])[0],re=void 0;q&&(re=L(q.subarray(12,16))),G[Q]={timescale:Z,type:te},G[te]={timescale:Z,id:Q,codec:re}}}}}}var se=d(H,["moov","mvex","trex"]);return se.forEach(function(ie){var ae=h(ie,4),oe=G[ae];oe&&(oe.default={duration:h(ie,12),flags:h(ie,20)})}),G}function l(H,G){if(!H||!G)return H;var V=G.keyId;if(V&&G.isCommonEncryption){var z=d(H,["moov","trak"]);z.forEach(function($){var X=d($,["mdia","minf","stbl","stsd"])[0],j=X.subarray(8),Y=d(j,["enca"]),Q=Y.length>0;Q||(Y=d(j,["encv"])),Y.forEach(function(J){var Z=Q?J.subarray(28):J.subarray(78),ee=d(Z,["sinf"]);ee.forEach(function(ne){var te=p(ne);if(te){var q=te.subarray(8,24);q.some(function(re){return re!==0})||(R.logger.log("[eme] Patching keyId in 'enc"+(Q?"a":"v")+">sinf>>tenc' box: "+W.default.hexDump(q)+" -> "+W.default.hexDump(V)),te.set(V,8))}})})})}return H}function p(H){var G=d(H,["schm"])[0];if(G){var V=L(G.subarray(4,8));if(V==="cbcs"||V==="cenc")return d(H,["schi","tenc"])[0]}return R.logger.error("[eme] missing 'schm' box"),null}function m(H,G){return d(G,["moof","traf"]).reduce(function(V,z){var $=d(z,["tfdt"])[0],X=$[0],j=d(z,["tfhd"]).reduce(function(Y,Q){var J=h(Q,4),Z=H[J];if(Z){var ee=h($,4);X===1&&(ee*=Math.pow(2,32),ee+=h($,8));var ne=Z.timescale||9e4,te=ee/ne;if(isFinite(te)&&(Y===null||te<Y))return te}return Y},null);return j!==null&&isFinite(j)&&(V===null||j<V)?j:V},null)||0}function s(H,G){for(var V=0,z=0,$=0,X=d(H,["moof","traf"]),j=0;j<X.length;j++){var Y=X[j],Q=d(Y,["tfhd"])[0],J=h(Q,4),Z=G[J];if(!!Z){var ee=Z.default,ne=h(Q,0)|(ee==null?void 0:ee.flags),te=ee==null?void 0:ee.duration;ne&8&&(ne&2?te=h(Q,12):te=h(Q,8));for(var q=Z.timescale||9e4,re=d(Y,["trun"]),se=0;se<re.length;se++){if(V=c(re[se]),!V&&te){var ie=h(re[se],4);V=te*ie}Z.type===w.ElementaryStreamTypes.VIDEO?z+=V/q:Z.type===w.ElementaryStreamTypes.AUDIO&&($+=V/q)}}}if(z===0&&$===0){for(var ae=0,oe=d(H,["sidx"]),le=0;le<oe.length;le++){var ue=f(oe[le]);ue!=null&&ue.references&&(ae+=ue.references.reduce(function(fe,de){return fe+de.info.duration||0},0))}return ae}return z||$}function c(H){var G=h(H,0),V=8;G&1&&(V+=4),G&4&&(V+=4);for(var z=0,$=h(H,4),X=0;X<$;X++){if(G&256){var j=h(H,V);z+=j,V+=4}G&512&&(V+=4),G&1024&&(V+=4),G&2048&&(V+=4)}return z}function _(H,G,V){d(G,["moof","traf"]).forEach(function(z){d(z,["tfhd"]).forEach(function($){var X=h($,4),j=H[X];if(!!j){var Y=j.timescale||9e4;d(z,["tfdt"]).forEach(function(Q){var J=Q[0],Z=h(Q,4);if(J===0)Z-=V*Y,Z=Math.max(Z,0),T(Q,4,Z);else{Z*=Math.pow(2,32),Z+=h(Q,8),Z-=V*Y,Z=Math.max(Z,0);var ee=Math.floor(Z/(C+1)),ne=Math.floor(Z%(C+1));T(Q,4,ee),T(Q,8,ne)}})}})})}function u(H){var G={valid:null,remainder:null},V=d(H,["moof"]);if(V){if(V.length<2)return G.remainder=H,G}else return G;var z=V[V.length-1];return G.valid=(0,S.sliceUint8)(H,0,z.byteOffset-8),G.remainder=(0,S.sliceUint8)(H,z.byteOffset-8),G}function o(H,G){var V=new Uint8Array(H.length+G.length);return V.set(H),V.set(G,H.length),V}function n(H,G){var V=[],z=G.samples,$=G.timescale,X=G.id,j=!1,Y=d(z,["moof"]);return Y.map(function(Q){var J=Q.byteOffset-8,Z=d(Q,["traf"]);Z.map(function(ee){var ne=d(ee,["tfdt"]).map(function(te){var q=te[0],re=h(te,4);return q===1&&(re*=Math.pow(2,32),re+=h(te,8)),re/$})[0];return ne!==void 0&&(H=ne),d(ee,["tfhd"]).map(function(te){var q=h(te,4),re=h(te,0)&16777215,se=(re&1)!==0,ie=(re&2)!==0,ae=(re&8)!==0,oe=0,le=(re&16)!==0,ue=0,fe=(re&32)!==0,de=8;q===X&&(se&&(de+=8),ie&&(de+=4),ae&&(oe=h(te,de),de+=4),le&&(ue=h(te,de),de+=4),fe&&(de+=4),G.type==="video"&&(j=g(G.codec)),d(ee,["trun"]).map(function(ve){var Le=ve[0],Ae=h(ve,0)&16777215,De=(Ae&1)!==0,Ye=0,Ee=(Ae&4)!==0,be=(Ae&256)!==0,He=0,Xe=(Ae&512)!==0,Qe=0,Ne=(Ae&1024)!==0,we=(Ae&2048)!==0,Je=0,rt=h(ve,4),Ce=8;De&&(Ye=h(ve,Ce),Ce+=4),Ee&&(Ce+=4);for(var ct=Ye+J,nt=0;nt<rt;nt++){if(be?(He=h(ve,Ce),Ce+=4):He=oe,Xe?(Qe=h(ve,Ce),Ce+=4):Qe=ue,Ne&&(Ce+=4),we&&(Le===0?Je=h(ve,Ce):Je=D(ve,Ce),Ce+=4),G.type===w.ElementaryStreamTypes.VIDEO)for(var Gr=0;Gr<Qe;){var Ut=h(z,ct);if(ct+=4,r(j,z[ct])){var Zt=z.subarray(ct,ct+Ut);E(Zt,j?2:1,H+Je/$,V)}ct+=Ut,Gr+=Ut+4}H+=He/$}}))})})}),V}function g(H){if(!H)return!1;var G=H.indexOf("."),V=G<0?H:H.substring(0,G);return V==="hvc1"||V==="hev1"||V==="dvh1"||V==="dvhe"}function r(H,G){if(H){var V=G>>1&63;return V===39||V===40}else{var z=G&31;return z===6}}function E(H,G,V,z){var $=P(H),X=0;X+=G;for(var j=0,Y=0,Q=!1,J=0;X<$.length;){j=0;do{if(X>=$.length)break;J=$[X++],j+=J}while(J===255);Y=0;do{if(X>=$.length)break;J=$[X++],Y+=J}while(J===255);var Z=$.length-X;if(!Q&&j===4&&X<$.length){Q=!0;var ee=$[X++];if(ee===181){var ne=A($,X);if(X+=2,ne===49){var te=h($,X);if(X+=4,te===1195456820){var q=$[X++];if(q===3){var re=$[X++],se=31&re,ie=64&re,ae=ie?2+se*3:0,oe=new Uint8Array(ae);if(ie){oe[0]=re;for(var le=1;le<ae;le++)oe[le]=$[X++]}z.push({type:q,payloadType:j,pts:V,bytes:oe})}}}}}else if(j===5&&Y<Z){if(Q=!0,Y>16){for(var ue=[],fe=0;fe<16;fe++){var de=$[X++].toString(16);ue.push(de.length==1?"0"+de:de),(fe===3||fe===5||fe===7||fe===9)&&ue.push("-")}for(var ve=Y-16,Le=new Uint8Array(ve),Ae=0;Ae<ve;Ae++)Le[Ae]=$[X++];z.push({payloadType:j,pts:V,uuid:ue.join(""),userData:(0,k.utf8ArrayToStr)(Le),userDataBytes:Le})}}else if(Y<Z)X+=Y;else if(Y>Z)break}}function P(H){for(var G=H.byteLength,V=[],z=1;z<G-2;)H[z]===0&&H[z+1]===0&&H[z+2]===3?(V.push(z+2),z+=2):z++;if(V.length===0)return H;var $=G-V.length,X=new Uint8Array($),j=0;for(z=0;z<$;j++,z++)j===V[0]&&(j++,V.shift()),X[z]=H[j];return X}function y(H){var G=H[0],V="",z="",$=0,X=0,j=0,Y=0,Q=0,J=0;if(G===0){for(;L(H.subarray(J,J+1))!=="\0";)V+=L(H.subarray(J,J+1)),J+=1;for(V+=L(H.subarray(J,J+1)),J+=1;L(H.subarray(J,J+1))!=="\0";)z+=L(H.subarray(J,J+1)),J+=1;z+=L(H.subarray(J,J+1)),J+=1,$=h(H,12),X=h(H,16),Y=h(H,20),Q=h(H,24),J=28}else if(G===1){J+=4,$=h(H,J),J+=4;var Z=h(H,J);J+=4;var ee=h(H,J);for(J+=4,j=Math.pow(2,32)*Z+ee,Number.isSafeInteger(j)||(j=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),Y=h(H,J),J+=4,Q=h(H,J),J+=4;L(H.subarray(J,J+1))!=="\0";)V+=L(H.subarray(J,J+1)),J+=1;for(V+=L(H.subarray(J,J+1)),J+=1;L(H.subarray(J,J+1))!=="\0";)z+=L(H.subarray(J,J+1)),J+=1;z+=L(H.subarray(J,J+1)),J+=1}var ne=H.subarray(J,H.byteLength);return{schemeIdUri:V,value:z,timeScale:$,presentationTime:j,presentationTimeDelta:X,eventDuration:Y,id:Q,payload:ne}}function U(H){for(var G=arguments.length,V=new Array(G>1?G-1:0),z=1;z<G;z++)V[z-1]=arguments[z];for(var $=V.length,X=8,j=$;j--;)X+=V[j].byteLength;var Y=new Uint8Array(X);for(Y[0]=X>>24&255,Y[1]=X>>16&255,Y[2]=X>>8&255,Y[3]=X&255,Y.set(H,4),j=0,X=8;j<$;j++)Y.set(V[j],X),X+=V[j].byteLength;return Y}function B(H,G,V){if(H.byteLength!==16)throw new RangeError("Invalid system id");var z,$;if(G){z=1,$=new Uint8Array(G.length*16);for(var X=0;X<G.length;X++){var j=G[X];if(j.byteLength!==16)throw new RangeError("Invalid key");$.set(j,X*16)}}else z=0,$=new Uint8Array;var Y;z>0?(Y=new Uint8Array(4),G.length>0&&new DataView(Y.buffer).setUint32(0,G.length,!1)):Y=new Uint8Array;var Q=new Uint8Array(4);return V&&V.byteLength>0&&new DataView(Q.buffer).setUint32(0,V.byteLength,!1),U([112,115,115,104],new Uint8Array([z,0,0,0]),H,Y,$,Q,V||new Uint8Array)}function F(H){if(!(H instanceof ArrayBuffer)||H.byteLength<32)return null;var G={version:0,systemId:"",kids:null,data:null},V=new DataView(H),z=V.getUint32(0);if(H.byteLength!==z&&z>44)return null;var $=V.getUint32(4);if($!==1886614376||(G.version=V.getUint32(8)>>>24,G.version>1))return null;G.systemId=W.default.hexDump(new Uint8Array(H,12,16));var X=V.getUint32(28);if(G.version===0){if(z-32<X)return null;G.data=new Uint8Array(H,32,X)}else if(G.version===1){G.kids=[];for(var j=0;j<X;j++)G.kids.push(new Uint8Array(H,32+j*16,16))}return G}},"./src/utils/numeric-encoding-utils.ts":(N,O,v)=>{v.r(O),v.d(O,{base64Decode:()=>C,base64DecodeToStr:()=>k,base64Encode:()=>R,base64ToBase64Url:()=>w,base64UrlEncode:()=>W,strToBase64Encode:()=>S});function w(I){return I.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function S(I){return btoa(I)}function k(I){return atob(I)}function R(I){return btoa(String.fromCharCode.apply(String,I))}function W(I){return w(R(I))}function C(I){return Uint8Array.from(atob(I),function(b){return b.charCodeAt(0)})}},"./src/utils/output-filter.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>w});var w=function(){function S(R,W){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=R,this.trackName=W}var k=S.prototype;return k.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},k.newCue=function(W,C,I){(this.startTime===null||this.startTime>W)&&(this.startTime=W),this.endTime=C,this.screen=I,this.timelineController.createCaptionsTrack(this.trackName)},k.reset=function(){this.cueRanges=[],this.startTime=null},S}()},"./src/utils/texttrack-utils.ts":(N,O,v)=>{v.r(O),v.d(O,{addCueToTrack:()=>k,clearCurrentCues:()=>R,getCuesInRange:()=>I,removeCuesInRange:()=>W,sendAddTrackEvent:()=>S});var w=v("./src/utils/logger.ts");function S(b,L){var A;try{A=new Event("addtrack")}catch{A=document.createEvent("Event"),A.initEvent("addtrack",!1,!1)}A.track=b,L.dispatchEvent(A)}function k(b,L){var A=b.mode;if(A==="disabled"&&(b.mode="hidden"),b.cues&&!b.cues.getCueById(L.id))try{if(b.addCue(L),!b.cues.getCueById(L.id))throw new Error("addCue is failed for: "+L)}catch(D){w.logger.debug("[texttrack-utils]: "+D);var h=new self.TextTrackCue(L.startTime,L.endTime,L.text);h.id=L.id,b.addCue(h)}A==="disabled"&&(b.mode=A)}function R(b){var L=b.mode;if(L==="disabled"&&(b.mode="hidden"),b.cues)for(var A=b.cues.length;A--;)b.removeCue(b.cues[A]);L==="disabled"&&(b.mode=L)}function W(b,L,A,h){var D=b.mode;if(D==="disabled"&&(b.mode="hidden"),b.cues&&b.cues.length>0)for(var T=I(b.cues,L,A),d=0;d<T.length;d++)(!h||h(T[d]))&&b.removeCue(T[d]);D==="disabled"&&(b.mode=D)}function C(b,L){if(L<b[0].startTime)return 0;var A=b.length-1;if(L>b[A].endTime)return-1;for(var h=0,D=A;h<=D;){var T=Math.floor((D+h)/2);if(L<b[T].startTime)D=T-1;else if(L>b[T].startTime&&h<A)h=T+1;else return T}return b[h].startTime-L<L-b[D].startTime?h:D}function I(b,L,A){var h=[],D=C(b,L);if(D>-1)for(var T=D,d=b.length;T<d;T++){var f=b[T];if(f.startTime>=L&&f.endTime<=A)h.push(f);else if(f.startTime>A)return h}return h}},"./src/utils/time-ranges.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>S});var w={toString:function(R){for(var W="",C=R.length,I=0;I<C;I++)W+="["+R.start(I).toFixed(3)+"-"+R.end(I).toFixed(3)+"]";return W}};const S=w},"./src/utils/timescale-conversion.ts":(N,O,v)=>{v.r(O),v.d(O,{toMpegTsClockFromTimescale:()=>W,toMsFromMpegTsClock:()=>R,toTimescaleFromBase:()=>S,toTimescaleFromScale:()=>k});var w=9e4;function S(C,I,b,L){b===void 0&&(b=1),L===void 0&&(L=!1);var A=C*I*b;return L?Math.round(A):A}function k(C,I,b,L){return b===void 0&&(b=1),L===void 0&&(L=!1),S(C,I,1/b,L)}function R(C,I){return I===void 0&&(I=!1),S(C,1e3,1/w,I)}function W(C,I){return I===void 0&&(I=1),S(C,w,1/I)}},"./src/utils/typed-array.ts":(N,O,v)=>{v.r(O),v.d(O,{sliceUint8:()=>w});function w(S,k,R){return Uint8Array.prototype.slice?S.slice(k,R):new Uint8Array(Array.prototype.slice.call(S,k,R))}},"./src/utils/vttcue.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>w});const w=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var S=["","lr","rl"],k=["start","middle","end","left","right"];function R(L,A){if(typeof A!="string"||!Array.isArray(L))return!1;var h=A.toLowerCase();return~L.indexOf(h)?h:!1}function W(L){return R(S,L)}function C(L){return R(k,L)}function I(L){for(var A=arguments.length,h=new Array(A>1?A-1:0),D=1;D<A;D++)h[D-1]=arguments[D];for(var T=1;T<arguments.length;T++){var d=arguments[T];for(var f in d)L[f]=d[f]}return L}function b(L,A,h){var D=this,T={enumerable:!0};D.hasBeenReset=!1;var d="",f=!1,i=L,l=A,p=h,m=null,s="",c=!0,_="auto",u="start",o=50,n="middle",g=50,r="middle";Object.defineProperty(D,"id",I({},T,{get:function(){return d},set:function(P){d=""+P}})),Object.defineProperty(D,"pauseOnExit",I({},T,{get:function(){return f},set:function(P){f=!!P}})),Object.defineProperty(D,"startTime",I({},T,{get:function(){return i},set:function(P){if(typeof P!="number")throw new TypeError("Start time must be set to a number.");i=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"endTime",I({},T,{get:function(){return l},set:function(P){if(typeof P!="number")throw new TypeError("End time must be set to a number.");l=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"text",I({},T,{get:function(){return p},set:function(P){p=""+P,this.hasBeenReset=!0}})),Object.defineProperty(D,"region",I({},T,{get:function(){return m},set:function(P){m=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"vertical",I({},T,{get:function(){return s},set:function(P){var y=W(P);if(y===!1)throw new SyntaxError("An invalid or illegal string was specified.");s=y,this.hasBeenReset=!0}})),Object.defineProperty(D,"snapToLines",I({},T,{get:function(){return c},set:function(P){c=!!P,this.hasBeenReset=!0}})),Object.defineProperty(D,"line",I({},T,{get:function(){return _},set:function(P){if(typeof P!="number"&&P!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");_=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"lineAlign",I({},T,{get:function(){return u},set:function(P){var y=C(P);if(!y)throw new SyntaxError("An invalid or illegal string was specified.");u=y,this.hasBeenReset=!0}})),Object.defineProperty(D,"position",I({},T,{get:function(){return o},set:function(P){if(P<0||P>100)throw new Error("Position must be between 0 and 100.");o=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"positionAlign",I({},T,{get:function(){return n},set:function(P){var y=C(P);if(!y)throw new SyntaxError("An invalid or illegal string was specified.");n=y,this.hasBeenReset=!0}})),Object.defineProperty(D,"size",I({},T,{get:function(){return g},set:function(P){if(P<0||P>100)throw new Error("Size must be between 0 and 100.");g=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"align",I({},T,{get:function(){return r},set:function(P){var y=C(P);if(!y)throw new SyntaxError("An invalid or illegal string was specified.");r=y,this.hasBeenReset=!0}})),D.displayState=void 0}return b.prototype.getCueAsHTML=function(){var L=self.WebVTT;return L.convertCueToDOMTree(self,this.text)},b}()},"./src/utils/vttparser.ts":(N,O,v)=>{v.r(O),v.d(O,{VTTParser:()=>A,fixLineBreaks:()=>L,parseTimeStamp:()=>k});var w=v("./src/utils/vttcue.ts"),S=function(){function h(){}var D=h.prototype;return D.decode=function(d,f){if(!d)return"";if(typeof d!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(d))},h}();function k(h){function D(d,f,i,l){return(d|0)*3600+(f|0)*60+(i|0)+parseFloat(l||0)}var T=h.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return T?parseFloat(T[2])>59?D(T[2],T[3],0,T[4]):D(T[1],T[2],T[3],T[4]):null}var R=function(){function h(){this.values=Object.create(null)}var D=h.prototype;return D.set=function(d,f){!this.get(d)&&f!==""&&(this.values[d]=f)},D.get=function(d,f,i){return i?this.has(d)?this.values[d]:f[i]:this.has(d)?this.values[d]:f},D.has=function(d){return d in this.values},D.alt=function(d,f,i){for(var l=0;l<i.length;++l)if(f===i[l]){this.set(d,f);break}},D.integer=function(d,f){/^-?\d+$/.test(f)&&this.set(d,parseInt(f,10))},D.percent=function(d,f){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(f)){var i=parseFloat(f);if(i>=0&&i<=100)return this.set(d,i),!0}return!1},h}();function W(h,D,T,d){var f=d?h.split(d):[h];for(var i in f)if(typeof f[i]=="string"){var l=f[i].split(T);if(l.length===2){var p=l[0],m=l[1];D(p,m)}}}var C=new w.default(0,0,""),I=C.align==="middle"?"middle":"center";function b(h,D,T){var d=h;function f(){var p=k(h);if(p===null)throw new Error("Malformed timestamp: "+d);return h=h.replace(/^[^\sa-zA-Z-]+/,""),p}function i(p,m){var s=new R;W(p,function(u,o){var n;switch(u){case"region":for(var g=T.length-1;g>=0;g--)if(T[g].id===o){s.set(u,T[g].region);break}break;case"vertical":s.alt(u,o,["rl","lr"]);break;case"line":n=o.split(","),s.integer(u,n[0]),s.percent(u,n[0])&&s.set("snapToLines",!1),s.alt(u,n[0],["auto"]),n.length===2&&s.alt("lineAlign",n[1],["start",I,"end"]);break;case"position":n=o.split(","),s.percent(u,n[0]),n.length===2&&s.alt("positionAlign",n[1],["start",I,"end","line-left","line-right","auto"]);break;case"size":s.percent(u,o);break;case"align":s.alt(u,o,["start",I,"end","left","right"]);break}},/:/,/\s/),m.region=s.get("region",null),m.vertical=s.get("vertical","");var c=s.get("line","auto");c==="auto"&&C.line===-1&&(c=-1),m.line=c,m.lineAlign=s.get("lineAlign","start"),m.snapToLines=s.get("snapToLines",!0),m.size=s.get("size",100),m.align=s.get("align",I);var _=s.get("position","auto");_==="auto"&&C.position===50&&(_=m.align==="start"||m.align==="left"?0:m.align==="end"||m.align==="right"?100:50),m.position=_}function l(){h=h.replace(/^\s+/,"")}if(l(),D.startTime=f(),l(),h.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+d);h=h.slice(3),l(),D.endTime=f(),l(),i(h,D)}function L(h){return h.replace(/<br(?: \/)?>/gi,`
`)}var A=function(){function h(){this.state="INITIAL",this.buffer="",this.decoder=new S,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var D=h.prototype;return D.parse=function(d){var f=this;d&&(f.buffer+=f.decoder.decode(d,{stream:!0}));function i(){var _=f.buffer,u=0;for(_=L(_);u<_.length&&_[u]!=="\r"&&_[u]!==`
`;)++u;var o=_.slice(0,u);return _[u]==="\r"&&++u,_[u]===`
`&&++u,f.buffer=_.slice(u),o}function l(_){W(_,function(u,o){},/:/)}try{var p="";if(f.state==="INITIAL"){if(!/\r\n|\n/.test(f.buffer))return this;p=i();var m=p.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!m||!m[0])throw new Error("Malformed WebVTT signature.");f.state="HEADER"}for(var s=!1;f.buffer;){if(!/\r\n|\n/.test(f.buffer))return this;switch(s?s=!1:p=i(),f.state){case"HEADER":/:/.test(p)?l(p):p||(f.state="ID");continue;case"NOTE":p||(f.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(p)){f.state="NOTE";break}if(!p)continue;if(f.cue=new w.default(0,0,""),f.state="CUE",p.indexOf("-->")===-1){f.cue.id=p;continue}case"CUE":if(!f.cue){f.state="BADCUE";continue}try{b(p,f.cue,f.regionList)}catch{f.cue=null,f.state="BADCUE";continue}f.state="CUETEXT";continue;case"CUETEXT":{var c=p.indexOf("-->")!==-1;if(!p||c&&(s=!0)){f.oncue&&f.cue&&f.oncue(f.cue),f.cue=null,f.state="ID";continue}if(f.cue===null)continue;f.cue.text&&(f.cue.text+=`
`),f.cue.text+=p}continue;case"BADCUE":p||(f.state="ID")}}}catch{f.state==="CUETEXT"&&f.cue&&f.oncue&&f.oncue(f.cue),f.cue=null,f.state=f.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},D.flush=function(){var d=this;try{if((d.cue||d.state==="HEADER")&&(d.buffer+=`

`,d.parse()),d.state==="INITIAL"||d.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(f){d.onparsingerror&&d.onparsingerror(f)}return d.onflush&&d.onflush(),this},h}()},"./src/utils/webvtt-parser.ts":(N,O,v)=>{v.r(O),v.d(O,{generateCueId:()=>A,parseWebVTT:()=>D});var w=v("./src/polyfills/number.ts"),S=v("./src/utils/vttparser.ts"),k=v("./src/demux/id3.ts"),R=v("./src/utils/timescale-conversion.ts"),W=v("./src/remux/mp4-remuxer.ts"),C=/\r\n|\n\r|\n|\r/g,I=function(d,f,i){return i===void 0&&(i=0),d.slice(i,i+f.length)===f},b=function(d){var f=parseInt(d.slice(-3)),i=parseInt(d.slice(-6,-4)),l=parseInt(d.slice(-9,-7)),p=d.length>9?parseInt(d.substring(0,d.indexOf(":"))):0;if(!(0,w.isFiniteNumber)(f)||!(0,w.isFiniteNumber)(i)||!(0,w.isFiniteNumber)(l)||!(0,w.isFiniteNumber)(p))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+d);return f+=1e3*i,f+=60*1e3*l,f+=60*60*1e3*p,f},L=function(d){for(var f=5381,i=d.length;i;)f=f*33^d.charCodeAt(--i);return(f>>>0).toString()};function A(T,d,f){return L(T.toString())+L(d.toString())+L(f)}var h=function(d,f,i){var l=d[f],p=d[l.prevCC];if(!p||!p.new&&l.new){d.ccOffset=d.presentationOffset=l.start,l.new=!1;return}for(;(m=p)!==null&&m!==void 0&&m.new;){var m;d.ccOffset+=l.start-p.start,l.new=!1,l=p,p=d[l.prevCC]}d.presentationOffset=i};function D(T,d,f,i,l,p,m,s){var c=new S.VTTParser,_=(0,k.utf8ArrayToStr)(new Uint8Array(T)).trim().replace(C,`
`).split(`
`),u=[],o=(0,R.toMpegTsClockFromTimescale)(d,f),n="00:00.000",g=0,r=0,E,P=!0;c.oncue=function(y){var U=i[l],B=i.ccOffset,F=(g-o)/9e4;U!=null&&U.new&&(r!==void 0?B=i.ccOffset=U.start:h(i,l,F)),F&&(B=F-i.presentationOffset);var H=y.endTime-y.startTime,G=(0,W.normalizePts)((y.startTime+B-r)*9e4,p*9e4)/9e4;y.startTime=Math.max(G,0),y.endTime=Math.max(G+H,0);var V=y.text.trim();y.text=decodeURIComponent(encodeURIComponent(V)),y.id||(y.id=A(y.startTime,y.endTime,V)),y.endTime>0&&u.push(y)},c.onparsingerror=function(y){E=y},c.onflush=function(){if(E){s(E);return}m(u)},_.forEach(function(y){if(P)if(I(y,"X-TIMESTAMP-MAP=")){P=!1,y.slice(16).split(",").forEach(function(U){I(U,"LOCAL:")?n=U.slice(6):I(U,"MPEGTS:")&&(g=parseInt(U.slice(7)))});try{r=b(n)/1e3}catch(U){E=U}return}else y===""&&(P=!1);c.parse(y+`
`)}),c.flush()}},"./src/utils/xhr-loader.ts":(N,O,v)=>{v.r(O),v.d(O,{default:()=>W});var w=v("./src/utils/logger.ts"),S=v("./src/loader/load-stats.ts"),k=/^age:\s*[\d.]+\s*$/m,R=function(){function C(b){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=b?b.xhrSetup:null,this.stats=new S.LoadStats,this.retryDelay=0}var I=C.prototype;return I.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},I.abortInternal=function(){var L=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),L&&(L.onreadystatechange=null,L.onprogress=null,L.readyState!==4&&(this.stats.aborted=!0,L.abort()))},I.abort=function(){var L;this.abortInternal(),(L=this.callbacks)!==null&&L!==void 0&&L.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},I.load=function(L,A,h){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=L,this.config=A,this.callbacks=h,this.retryDelay=A.retryDelay,this.loadInternal()},I.loadInternal=function(){var L=this.config,A=this.context;if(!!L){var h=this.loader=new self.XMLHttpRequest,D=this.stats;D.loading.first=0,D.loaded=0;var T=this.xhrSetup;try{if(T)try{T(h,A.url)}catch{h.open("GET",A.url,!0),T(h,A.url)}h.readyState||h.open("GET",A.url,!0);var d=this.context.headers;if(d)for(var f in d)h.setRequestHeader(f,d[f])}catch(i){this.callbacks.onError({code:h.status,text:i.message},A,h);return}A.rangeEnd&&h.setRequestHeader("Range","bytes="+A.rangeStart+"-"+(A.rangeEnd-1)),h.onreadystatechange=this.readystatechange.bind(this),h.onprogress=this.loadprogress.bind(this),h.responseType=A.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),L.timeout),h.send()}},I.readystatechange=function(){var L=this.context,A=this.loader,h=this.stats;if(!(!L||!A)){var D=A.readyState,T=this.config;if(!h.aborted&&D>=2)if(self.clearTimeout(this.requestTimeout),h.loading.first===0&&(h.loading.first=Math.max(self.performance.now(),h.loading.start)),D===4){A.onreadystatechange=null,A.onprogress=null;var d=A.status,f=A.responseType==="arraybuffer";if(d>=200&&d<300&&(f&&A.response||A.responseText!==null)){h.loading.end=Math.max(self.performance.now(),h.loading.first);var i,l;if(f?(i=A.response,l=i.byteLength):(i=A.responseText,l=i.length),h.loaded=h.total=l,!this.callbacks)return;var p=this.callbacks.onProgress;if(p&&p(h,L,i,A),!this.callbacks)return;var m={url:A.responseURL,data:i};this.callbacks.onSuccess(m,h,L,A)}else h.retry>=T.maxRetry||d>=400&&d<499?(w.logger.error(d+" while loading "+L.url),this.callbacks.onError({code:d,text:A.statusText},L,A)):(w.logger.warn(d+" while loading "+L.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,T.maxRetryDelay),h.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),T.timeout)}},I.loadtimeout=function(){w.logger.warn("timeout while loading "+this.context.url);var L=this.callbacks;L&&(this.abortInternal(),L.onTimeout(this.stats,this.context,this.loader))},I.loadprogress=function(L){var A=this.stats;A.loaded=L.loaded,L.lengthComputable&&(A.total=L.total)},I.getCacheAge=function(){var L=null;if(this.loader&&k.test(this.loader.getAllResponseHeaders())){var A=this.loader.getResponseHeader("age");L=A?parseFloat(A):null}return L},C}();const W=R},"./node_modules/eventemitter3/index.js":N=>{var O=Object.prototype.hasOwnProperty,v="~";function w(){}Object.create&&(w.prototype=Object.create(null),new w().__proto__||(v=!1));function S(C,I,b){this.fn=C,this.context=I,this.once=b||!1}function k(C,I,b,L,A){if(typeof b!="function")throw new TypeError("The listener must be a function");var h=new S(b,L||C,A),D=v?v+I:I;return C._events[D]?C._events[D].fn?C._events[D]=[C._events[D],h]:C._events[D].push(h):(C._events[D]=h,C._eventsCount++),C}function R(C,I){--C._eventsCount===0?C._events=new w:delete C._events[I]}function W(){this._events=new w,this._eventsCount=0}W.prototype.eventNames=function(){var I=[],b,L;if(this._eventsCount===0)return I;for(L in b=this._events)O.call(b,L)&&I.push(v?L.slice(1):L);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(b)):I},W.prototype.listeners=function(I){var b=v?v+I:I,L=this._events[b];if(!L)return[];if(L.fn)return[L.fn];for(var A=0,h=L.length,D=new Array(h);A<h;A++)D[A]=L[A].fn;return D},W.prototype.listenerCount=function(I){var b=v?v+I:I,L=this._events[b];return L?L.fn?1:L.length:0},W.prototype.emit=function(I,b,L,A,h,D){var T=v?v+I:I;if(!this._events[T])return!1;var d=this._events[T],f=arguments.length,i,l;if(d.fn){switch(d.once&&this.removeListener(I,d.fn,void 0,!0),f){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,b),!0;case 3:return d.fn.call(d.context,b,L),!0;case 4:return d.fn.call(d.context,b,L,A),!0;case 5:return d.fn.call(d.context,b,L,A,h),!0;case 6:return d.fn.call(d.context,b,L,A,h,D),!0}for(l=1,i=new Array(f-1);l<f;l++)i[l-1]=arguments[l];d.fn.apply(d.context,i)}else{var p=d.length,m;for(l=0;l<p;l++)switch(d[l].once&&this.removeListener(I,d[l].fn,void 0,!0),f){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,b);break;case 3:d[l].fn.call(d[l].context,b,L);break;case 4:d[l].fn.call(d[l].context,b,L,A);break;default:if(!i)for(m=1,i=new Array(f-1);m<f;m++)i[m-1]=arguments[m];d[l].fn.apply(d[l].context,i)}}return!0},W.prototype.on=function(I,b,L){return k(this,I,b,L,!1)},W.prototype.once=function(I,b,L){return k(this,I,b,L,!0)},W.prototype.removeListener=function(I,b,L,A){var h=v?v+I:I;if(!this._events[h])return this;if(!b)return R(this,h),this;var D=this._events[h];if(D.fn)D.fn===b&&(!A||D.once)&&(!L||D.context===L)&&R(this,h);else{for(var T=0,d=[],f=D.length;T<f;T++)(D[T].fn!==b||A&&!D[T].once||L&&D[T].context!==L)&&d.push(D[T]);d.length?this._events[h]=d.length===1?d[0]:d:R(this,h)}return this},W.prototype.removeAllListeners=function(I){var b;return I?(b=v?v+I:I,this._events[b]&&R(this,b)):(this._events=new w,this._eventsCount=0),this},W.prototype.off=W.prototype.removeListener,W.prototype.addListener=W.prototype.on,W.prefixed=v,W.EventEmitter=W,N.exports=W},"./node_modules/url-toolkit/src/url-toolkit.js":function(N){(function(O){var v=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,w=/^(?=([^\/?#]*))\1([^]*)$/,S=/(?:\/|^)\.(?=\/)/g,k=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,R={buildAbsoluteURL:function(W,C,I){if(I=I||{},W=W.trim(),C=C.trim(),!C){if(!I.alwaysNormalize)return W;var b=R.parseURL(W);if(!b)throw new Error("Error trying to parse base URL.");return b.path=R.normalizePath(b.path),R.buildURLFromParts(b)}var L=R.parseURL(C);if(!L)throw new Error("Error trying to parse relative URL.");if(L.scheme)return I.alwaysNormalize?(L.path=R.normalizePath(L.path),R.buildURLFromParts(L)):C;var A=R.parseURL(W);if(!A)throw new Error("Error trying to parse base URL.");if(!A.netLoc&&A.path&&A.path[0]!=="/"){var h=w.exec(A.path);A.netLoc=h[1],A.path=h[2]}A.netLoc&&!A.path&&(A.path="/");var D={scheme:A.scheme,netLoc:L.netLoc,path:null,params:L.params,query:L.query,fragment:L.fragment};if(!L.netLoc&&(D.netLoc=A.netLoc,L.path[0]!=="/"))if(!L.path)D.path=A.path,L.params||(D.params=A.params,L.query||(D.query=A.query));else{var T=A.path,d=T.substring(0,T.lastIndexOf("/")+1)+L.path;D.path=R.normalizePath(d)}return D.path===null&&(D.path=I.alwaysNormalize?R.normalizePath(L.path):L.path),R.buildURLFromParts(D)},parseURL:function(W){var C=v.exec(W);return C?{scheme:C[1]||"",netLoc:C[2]||"",path:C[3]||"",params:C[4]||"",query:C[5]||"",fragment:C[6]||""}:null},normalizePath:function(W){for(W=W.split("").reverse().join("").replace(S,"");W.length!==(W=W.replace(k,"")).length;);return W.split("").reverse().join("")},buildURLFromParts:function(W){return W.scheme+W.netLoc+W.path+W.params+W.query+W.fragment}};N.exports=R})()}},x={};function M(N){var O=x[N];if(O!==void 0)return O.exports;var v=x[N]={exports:{}};return a[N].call(v.exports,v,v.exports,M),v.exports}M.m=a,M.n=N=>{var O=N&&N.__esModule?()=>N.default:()=>N;return M.d(O,{a:O}),O},M.d=(N,O)=>{for(var v in O)M.o(O,v)&&!M.o(N,v)&&Object.defineProperty(N,v,{enumerable:!0,get:O[v]})},M.o=(N,O)=>Object.prototype.hasOwnProperty.call(N,O),M.r=N=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(N,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(N,"__esModule",{value:!0})};var K=M("./src/hls.ts");return K=K.default,K})())})(Wo);var Xn=Ih(Wo.exports),Ho="/img/cat.jpg";const bh={mounted(){let e=new Xn,t="https://live.rouquin.me:8888/hls/live_883158378_G7hEwywoc201aCskN8ZKD2KDHHQ3Yd.m3u8",a=document.getElementById("video");e.on(Xn.Events.MEDIA_ATTACHED,function(){console.log("video and hls.js are now bound together !")}),e.on(Xn.Events.MANIFEST_PARSED,function(x,M){console.log("manifest loaded, found "+M.levels.length+" quality level"),a.play()}),e.loadSource(t),e.attachMedia(a)}},Ch={id:"video",autoplay:"true",controls:"controls",poster:Ho};function Oh(e,t,a,x,M,K){return vt(),Ot("video",Ch)}var Mh=yr(bh,[["render",Oh],["__file","MyLive.vue"]]);const wh={props:["url","playerid"],data(){return{playbackTime:0,audioDuration:100,audioLoaded:!1,isPlaying:!1,intervalId:null,time:"00:00:00"}},methods:{initSlider(){var e=this.$refs.player;e&&(this.audioDuration=Math.round(e.duration))},convertTime(e){const t=M=>`0${Math.floor(M)}`.slice(-2);var a=e/3600,x=e%3600/60;return[a,x,e%60].map(t).join(":")},totalTime(){var e=this.$refs.player;if(e){var t=e.duration;return this.convertTime(t)}else return"00:00"},elapsedTime(){var e=this.$refs.player;if(e){var t=e.currentTime;return this.convertTime(t)}else return"00:00"},playbackListener(e){var t=this.$refs.player;this.playbackTime=t.currentTime,t.addEventListener("ended",this.endListener),t.addEventListener("pause",this.pauseListener)},pauseListener(){this.isPlaying=!1,this.listenerActive=!1,this.cleanupListeners()},endListener(){this.isPlaying=!1,this.listenerActive=!1,this.cleanupListeners()},cleanupListeners(){var e=this.$refs.player;e.removeEventListener("freqtimeupdate",this.playbackListener),e.removeEventListener("ended",this.endListener),e.removeEventListener("pause",this.pauseListener)},toggleAudio(){var e=this.$refs.player;e.paused?(e.play(),this.isPlaying=!0):(e.pause(),this.isPlaying=!1)}},mounted:function(){this.$nextTick(function(){var e=this.$refs.player;e.addEventListener("loadedmetadata",function(t){this.initSlider()}.bind(this)),e.addEventListener("canplay",function(t){this.audioLoaded=!0}.bind(this)),this.$watch("isPlaying",function(){if(this.isPlaying){var t=this.$refs.player;this.initSlider(),this.listenerActive||(this.listenerActive=!0,this.intervalId!==null&&(clearInterval(this.intervalId),this.time="00:00:00"),this.listenerActive?this.intervalId=setInterval(()=>{this.time=this.convertTime(t.currentTime.toFixed())},500):this.audio.stop())}}),this.$watch("playbackTime",function(){this.$refs.player;var t=Math.abs(this.playbackTime-this.$refs.player.currentTime);t>.01&&(this.$refs.player.currentTime=this.playbackTime)})})}},Fh={id:"audio-player-root"},kh=["id"],Uh=["src"],Bh={class:"w-3/4 max-w-5xl bg-gray-200 border border-gray-300 px-2 pt-2 mt-4 shadow-md",style:{margin:"auto"}},Nh={id:"player-row",class:"inline-flex flex-wrap w-full"},Kh={id:"button-div",class:"flex-initial pr-3"},Wh=Fe("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1),Hh=[Wh],Gh=Fe("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1),jh=[Gh],Vh={id:"progress-bar",class:"flex-grow bg-white border border-blue-200"},Yh={class:"overlay-container relative w-full h-full"},zh=["max"],$h={class:"w-full absolute top-0 bottom-0 right-0 left-0 px-2 pointer-events-none",style:{color:"#94bcec"}},Xh={class:"flex w-full justify-between absolute top-0 bottom-0 right-0 left-0 px-2 pointer-events-none"},Qh={class:"text-sm",style:{color:"#94bcec"}},Jh=["innerHTML"];function Zh(e,t,a,x,M,K){return vt(),Ot("div",Fh,[Fe("div",null,[Fe("audio",{style:{display:"none"},ref:"player",id:a.playerid},[Fe("source",{src:a.url,type:"audio/ogg"},null,8,Uh)],8,kh)]),Fe("div",Bh,[Fe("div",Nh,[Fe("div",Kh,[Tr((vt(),Ot("svg",{onClick:t[0]||(t[0]=N=>K.toggleAudio()),class:gr(["play-button text-gray-400",{"text-orange-600":M.audioLoaded,"hover:text-orange-400":M.audioLoaded,"cursor-pointer":M.audioLoaded}]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},Hh,2)),[[qr,!M.isPlaying]]),Tr((vt(),Ot("svg",{onClick:t[1]||(t[1]=N=>K.toggleAudio()),class:"play-button text-orange-400 hover:text-orange-400 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},jh,512)),[[qr,M.isPlaying]])]),Fe("div",Vh,[Fe("div",Yh,[Tr(Fe("input",{"onUpdate:modelValue":t[2]||(t[2]=N=>M.playbackTime=N),type:"range",min:"0",max:M.audioDuration,class:"slider w-full h-full",id:"position",name:"position"},null,8,zh),[[If,M.playbackTime]]),Tr(Fe("div",$h," Loading please wait... ",512),[[qr,!M.audioLoaded]]),Tr(Fe("div",Xh,[Fe("span",Qh,sa(M.time),1),Pn(" | "),Fe("span",{class:"text-sm",style:{color:"#94bcec"},innerHTML:K.totalTime()},null,8,Jh)],512),[[qr,M.audioLoaded]])])])])])])}var qh=yr(wh,[["render",Zh],["__file","MyAudio.vue"]]);const ev={name:"LiveArchive",props:{source:{type:String,required:!0}}},tv=["src"];function rv(e,t,a,x,M,K){return vt(),Ot("video",{id:"video",autoplay:"true",controls:"controls",poster:Ho,src:a.source},null,8,tv)}var nv=yr(ev,[["render",rv],["__file","LiveArchive.vue"]]),iv=kt({enhance({app:e,router:t,siteData:a}){e.component("MyLive",Mh),e.component("MyAudio",qh),e.component("LiveArchive",nv)},setup(){},rootComponents:[Ph]});const Qn=[sd,ld,dd,Ld,Rd,Md,_h,iv],sv=[["v-8daa1a0e","/",{title:"Live Offline"},["/index.html","/index.md"]],["v-3706649a","/404.html",{title:""},["/404"]]];var av=()=>sv.reduce((e,[t,a,x,M])=>(e.push({name:t,path:a,component:bs,meta:x},...M.map(K=>({path:K,redirect:a}))),e),[{name:"404",path:"/:catchAll(.*)",component:bs}]),ov=gc,lv=()=>{const e=Zc({history:ov(Nf(It.value.base)),routes:av(),scrollBehavior:(t,a,x)=>x||(t.hash?{el:t.hash}:{top:0})});return e.beforeResolve(async(t,a)=>{var x;(t.path!==a.path||a===pt)&&([yt.value]=await Promise.all([Ht.resolvePageData(t.name),(x=uo[t.name])==null?void 0:x.__asyncLoader()]))}),e},uv=e=>{e.component("ClientOnly",Xf),e.component("Content",Qf)},fv=(e,t)=>{const a=Se(()=>Ht.resolveRouteLocale(It.value.locales,t.currentRoute.value.path)),x=Se(()=>Ht.resolveSiteLocaleData(It.value,a.value)),M=Se(()=>Ht.resolvePageFrontmatter(yt.value)),K=Se(()=>Ht.resolvePageHeadTitle(yt.value,x.value)),N=Se(()=>Ht.resolvePageHead(K.value,M.value,x.value)),O=Se(()=>Ht.resolvePageLang(yt.value));return e.provide(Fi,a),e.provide(mo,x),e.provide(ho,M),e.provide(jf,K),e.provide(vo,N),e.provide(go,O),Object.defineProperties(e.config.globalProperties,{$frontmatter:{get:()=>M.value},$head:{get:()=>N.value},$headTitle:{get:()=>K.value},$lang:{get:()=>O.value},$page:{get:()=>yt.value},$routeLocale:{get:()=>a.value},$site:{get:()=>It.value},$siteLocale:{get:()=>x.value},$withBase:{get:()=>Jf}}),{pageData:yt,pageFrontmatter:M,pageHead:N,pageHeadTitle:K,pageLang:O,routeLocale:a,siteData:It,siteLocaleData:x}},cv=()=>{const e=Ni(),t=Gf(),a=Vf(),x=Ue([]),M=()=>{t.value.forEach(N=>{const O=dv(N);O&&x.value.push(O)})},K=()=>{document.documentElement.lang=a.value,x.value.forEach(N=>{N.parentNode===document.head&&document.head.removeChild(N)}),x.value.splice(0,x.value.length),t.value.forEach(N=>{const O=hv(N);O!==null&&(document.head.appendChild(O),x.value.push(O))})};Xt($f,K),Ft(()=>{M(),K(),Tt(()=>e.path,()=>K())})},dv=([e,t,a=""])=>{const x=Object.entries(t).map(([O,v])=>Te(v)?`[${O}="${v}"]`:v===!0?`[${O}]`:"").join(""),M=`head > ${e}${x}`;return Array.from(document.querySelectorAll(M)).find(O=>O.innerText===a)||null},hv=([e,t,a])=>{if(!Te(e))return null;const x=document.createElement(e);return oo(t)&&Object.entries(t).forEach(([M,K])=>{Te(K)?x.setAttribute(M,K):K===!0&&x.setAttribute(M,"")}),Te(a)&&x.appendChild(document.createTextNode(a)),x},vv=Mf,gv=async()=>{var a;const e=vv({name:"VuepressApp",setup(){var x;cv();for(const M of Qn)(x=M.setup)==null||x.call(M);return()=>[Pe(Ro),...Qn.flatMap(({rootComponents:M=[]})=>M.map(K=>Pe(K)))]}}),t=lv();uv(e),fv(e,t);for(const x of Qn)await((a=x.enhance)==null?void 0:a.call(x,{app:e,router:t,siteData:It}));return e.use(t),{app:e,router:t}};gv().then(({app:e,router:t})=>{t.isReady().then(()=>{e.mount("#app")})});export{yv as $,zf as A,Sv as B,Lv as C,Pe as D,Jf as E,je as F,Xf as G,gr as H,Ue as I,Tt as J,Tr as K,qr as L,Kf as M,Nf as N,Bi as O,Te as P,hh as Q,Ft as R,En as S,wi as T,Wr as U,Av as V,oo as W,xv as X,Ri as Y,Ii as Z,yr as _,Ie as a,bi as a0,gh as a1,Fe as b,Ot as c,gv as createVueApp,Pn as d,Yu as e,tt as f,Ko as g,ut as h,Hf as i,Se as j,ce as k,pv as l,Ev as m,Ni as n,vt as o,mv as p,to as q,Su as r,zu as s,sa as t,Yf as u,ja as v,iu as w,Bf as x,Tv as y,_v as z};
